# é›¶çŸ¥è¯†è¯æ˜ (ZK Proof) åŒºå—é“¾å®æˆ˜æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£æ—¨åœ¨è®©ä½ **å¿«é€Ÿç†è§£å¹¶åº”ç”¨**é›¶çŸ¥è¯†è¯æ˜æŠ€æœ¯ã€‚æˆ‘ä»¬è·³è¿‡ç¹ççš„æ•°å­¦æ¨å¯¼ï¼Œèšç„¦äºï¼š

1. æ ¸å¿ƒæ¦‚å¿µçš„ç›´è§‰ç†è§£
2. ä¸»æµ ZK ç³»ç»Ÿçš„å·¥ç¨‹é€‰å‹
3. åŒºå—é“¾ä¸­çš„å®é™…åº”ç”¨
4. å¯è¿è¡Œçš„ä»£ç ç¤ºä¾‹

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šZK æ ¸å¿ƒæ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯é›¶çŸ¥è¯†è¯æ˜ï¼Ÿ

**ä¸€å¥è¯å®šä¹‰**ï¼šè¯æ˜è€…ï¼ˆProverï¼‰å‘éªŒè¯è€…ï¼ˆVerifierï¼‰è¯æ˜æŸä¸ªé™ˆè¿°ä¸ºçœŸï¼Œä½†ä¸æ³„éœ²ä»»ä½•é¢å¤–ä¿¡æ¯ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é›¶çŸ¥è¯†è¯æ˜çš„ä¸‰ä¸ªæ ¸å¿ƒå±æ€§                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. å®Œå¤‡æ€§ (Completeness)                                            â”‚
â”‚     å¦‚æœé™ˆè¿°ä¸ºçœŸï¼Œè¯šå®çš„è¯æ˜è€…æ€»èƒ½è¯´æœéªŒè¯è€…                               â”‚
â”‚                                                                     â”‚
â”‚  2. å¯é æ€§ (Soundness)                                               â”‚
â”‚     å¦‚æœé™ˆè¿°ä¸ºå‡ï¼Œæ¶æ„è¯æ˜è€…å‡ ä¹ä¸å¯èƒ½æ¬ºéª—éªŒè¯è€…                           â”‚
â”‚                                                                     â”‚
â”‚  3. é›¶çŸ¥è¯†æ€§ (Zero-Knowledge)                                        â”‚
â”‚     éªŒè¯è€…é™¤äº†çŸ¥é“"é™ˆè¿°ä¸ºçœŸ"å¤–ï¼Œå­¦ä¸åˆ°ä»»ä½•å…¶ä»–ä¿¡æ¯                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ç»å…¸æ¯”å–»ï¼šé˜¿é‡Œå·´å·´æ´ç©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é˜¿é‡Œå·´å·´æ´ç©´é—®é¢˜                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚                        å…¥å£                                          â”‚
â”‚                         â”‚                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                      â”‚
â”‚                    â”‚         â”‚                                      â”‚
â”‚               A è·¯å¾„         B è·¯å¾„                                  â”‚
â”‚                    â”‚         â”‚                                      â”‚
â”‚                    â”‚         â”‚                                      â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                      â”‚
â”‚                         â”‚                                           â”‚
â”‚                    é­”æ³•é—¨ ğŸšª                                         â”‚
â”‚                  (éœ€è¦å¯†ç )                                          â”‚
â”‚                                                                     â”‚
â”‚  è¯æ˜è¿‡ç¨‹ï¼š                                                          â”‚
â”‚  1. Peggyï¼ˆè¯æ˜è€…ï¼‰éšæœºé€‰æ‹© A æˆ– B è¿›å…¥æ´ç©´                             â”‚
â”‚  2. Victorï¼ˆéªŒè¯è€…ï¼‰åœ¨å…¥å£å–Šå‡ºè¦æ±‚ Peggy ä» A æˆ– B å‡ºæ¥                  â”‚
â”‚  3. å¦‚æœ Peggy çŸ¥é“å¯†ç ï¼Œå¥¹æ€»èƒ½ä»æŒ‡å®šè·¯å¾„å‡ºæ¥                            â”‚
â”‚  4. å¦‚æœä¸çŸ¥é“å¯†ç ï¼Œå¥¹åªæœ‰ 50% æ¦‚ç‡æˆåŠŸ                                  â”‚
â”‚  5. é‡å¤ n æ¬¡ï¼Œä½œå¼ŠæˆåŠŸæ¦‚ç‡ = (1/2)^n                                  â”‚
â”‚                                                                     â”‚
â”‚  é›¶çŸ¥è¯†ï¼šVictor åªçŸ¥é“ Peggy èƒ½æ‰“å¼€é—¨ï¼Œä½†ä¸çŸ¥é“å¯†ç æ˜¯ä»€ä¹ˆ                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 åŒºå—é“¾ä¸­çš„ ZK åº”ç”¨åœºæ™¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK åœ¨åŒºå—é“¾ä¸­çš„æ ¸å¿ƒåº”ç”¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. æ‰©å®¹ (Scaling) - zkRollup                                â”‚    â”‚
â”‚  â”‚     â€¢ é“¾ä¸‹æ‰§è¡Œäº¤æ˜“ï¼Œé“¾ä¸ŠéªŒè¯è¯æ˜                                 â”‚    â”‚
â”‚  â”‚     â€¢ ä»£è¡¨é¡¹ç›®ï¼šzkSync, StarkNet, Scroll, Polygon zkEVM       â”‚    â”‚
â”‚  â”‚     â€¢ æ ¸å¿ƒä»·å€¼ï¼šç»§æ‰¿ L1 å®‰å…¨æ€§ï¼Œå¤§å¹…æé«˜ TPS                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  2. éšç§ (Privacy)                                           â”‚    â”‚
â”‚  â”‚     â€¢ éšè—äº¤æ˜“é‡‘é¢ã€å‘é€æ–¹ã€æ¥æ”¶æ–¹                               â”‚    â”‚
â”‚  â”‚     â€¢ ä»£è¡¨é¡¹ç›®ï¼šZcash, Tornado Cash, Aztec                    â”‚    â”‚
â”‚  â”‚     â€¢ æ ¸å¿ƒä»·å€¼ï¼šäº¤æ˜“å¯éªŒè¯ä½†ä¸å¯è¿½è¸ª                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  3. è·¨é“¾æ¡¥ (Bridges)                                         â”‚    â”‚
â”‚  â”‚     â€¢ è¯æ˜æºé“¾ä¸Šçš„çŠ¶æ€/äº¤æ˜“                                    â”‚    â”‚
â”‚  â”‚     â€¢ ä»£è¡¨é¡¹ç›®ï¼šSuccinct, Polyhedra, zkBridge                â”‚    â”‚
â”‚  â”‚     â€¢ æ ¸å¿ƒä»·å€¼ï¼šæ— éœ€ä¿¡ä»»å‡è®¾çš„è·¨é“¾éªŒè¯                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  4. èº«ä»½éªŒè¯ (Identity)                                      â”‚    â”‚
â”‚  â”‚     â€¢ è¯æ˜"æˆ‘æ»¡è¶³æ¡ä»¶"è€Œä¸é€éœ²å…·ä½“ä¿¡æ¯                           â”‚    â”‚
â”‚  â”‚     â€¢ ä¾‹å¦‚ï¼šè¯æ˜å¹´é¾„>18ï¼Œä¸é€éœ²å…·ä½“ç”Ÿæ—¥                          â”‚    â”‚
â”‚  â”‚     â€¢ ä»£è¡¨é¡¹ç›®ï¼šWorldcoin, Polygon ID, Semaphore              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 ZK è¯æ˜ç³»ç»Ÿåˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZK è¯æ˜ç³»ç»Ÿå®¶æ—                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚                         ZK Proofs                                   â”‚
â”‚                             â”‚                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚              â”‚              â”‚                        â”‚
â”‚          äº¤äº’å¼          éäº¤äº’å¼        å…¶ä»–                          â”‚
â”‚       (Interactive)   (Non-Interactive)                             â”‚
â”‚                             â”‚                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚              â”‚              â”‚                        â”‚
â”‚           SNARKs        STARKs         Bulletproofs                 â”‚
â”‚              â”‚              â”‚              â”‚                        â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚         èŒƒå›´è¯æ˜                       â”‚
â”‚     â”‚        â”‚        â”‚     â”‚         (Monero)                      â”‚
â”‚  Groth16  PLONK    Halo2    â”‚                                       â”‚
â”‚     â”‚        â”‚        â”‚     â”‚                                       â”‚
â”‚  zkSync1  Scroll   Zcash   StarkNet                                 â”‚
â”‚  Zcash    Polygon  Aztec   StarkEx                                  â”‚
â”‚           zkEVM                                                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.5 SNARKs vs STARKsï¼šå·¥ç¨‹é€‰å‹

| ç‰¹æ€§         | SNARKs                                         | STARKs                                     |
|------------|------------------------------------------------|--------------------------------------------|
| **å…¨ç§°**     | Succinct Non-interactive ARgument of Knowledge | Scalable Transparent ARgument of Knowledge |
| **å¯ä¿¡è®¾ç½®**   | éœ€è¦ (Groth16) æˆ–ä¸éœ€è¦ (PLONK+KZG)                  | ä¸éœ€è¦ (Transparent)                          |
| **è¯æ˜å¤§å°**   | ~200-300 bytes                                 | ~40-200 KB                                 |
| **éªŒè¯æ—¶é—´**   | ~10ms (æ’å®š)                                     | ~50-100ms (å¯¹æ•°å¢é•¿)                           |
| **è¯æ˜æ—¶é—´**   | è¾ƒæ…¢                                             | è¾ƒå¿«                                         |
| **åé‡å­å®‰å…¨**  | âŒ (åŸºäºæ¤­åœ†æ›²çº¿)                                     | âœ… (åŸºäºå“ˆå¸Œå‡½æ•°)                                 |
| **é“¾ä¸ŠéªŒè¯æˆæœ¬** | ~200k gas                                      | ~1M+ gas                                   |
| **ä»£è¡¨é¡¹ç›®**   | zkSync, Scroll, Polygon zkEVM                  | StarkNet, StarkEx                          |

**å·¥ç¨‹é€‰å‹å»ºè®®**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å¦‚ä½•é€‰æ‹©ï¼Ÿ                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ä¼˜å…ˆè€ƒè™‘é“¾ä¸ŠéªŒè¯æˆæœ¬ï¼Ÿ                                                 â”‚
â”‚  â””â”€â”€ æ˜¯ â†’ SNARKs (Groth16/PLONK)                                    â”‚
â”‚                                                                     â”‚
â”‚  éœ€è¦åé‡å­å®‰å…¨ï¼Ÿ                                                     â”‚
â”‚  â””â”€â”€ æ˜¯ â†’ STARKs                                                    â”‚
â”‚                                                                     â”‚
â”‚  ä¸æƒ³è¦å¯ä¿¡è®¾ç½®ï¼Ÿ                                                     â”‚
â”‚  â””â”€â”€ æ˜¯ â†’ STARKs æˆ– PLONK (universal setup)                         â”‚
â”‚                                                                     â”‚
â”‚  è¯æ˜è§„æ¨¡è¶…å¤§ï¼Ÿ                                                       â”‚
â”‚  â””â”€â”€ æ˜¯ â†’ STARKs (è¯æ˜æ—¶é—´æ›´ä¼˜)                                      â”‚
â”‚                                                                     â”‚
â”‚  å¯¹å»¶è¿Ÿæ•æ„Ÿï¼Ÿ                                                         â”‚
â”‚  â””â”€â”€ æ˜¯ â†’ SNARKs (éªŒè¯æ›´å¿«)                                          â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.6 ZK ç”µè·¯ï¼šæ ¸å¿ƒæŠ½è±¡

**ç†è§£ ZK çš„å…³é”®**ï¼šå°†è®¡ç®—è½¬æ¢ä¸º"ç”µè·¯"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»è®¡ç®—åˆ°ç”µè·¯çš„è½¬æ¢                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  åŸå§‹é—®é¢˜ï¼šè¯æ˜æˆ‘çŸ¥é“ xï¼Œä½¿å¾— hash(x) = y                               â”‚
â”‚                                                                     â”‚
â”‚  æ­¥éª¤ 1: å°†è®¡ç®—è¡¨ç¤ºä¸ºç®—æœ¯ç”µè·¯                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚     x (ç§æœ‰è¾“å…¥)      y (å…¬å¼€è¾“å…¥)                             â”‚    â”‚
â”‚  â”‚         â”‚                 â”‚                                 â”‚    â”‚
â”‚  â”‚         â–¼                 â”‚                                 â”‚    â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                                 â”‚    â”‚
â”‚  â”‚    â”‚  Hash   â”‚            â”‚                                 â”‚    â”‚
â”‚  â”‚    â”‚ Circuit â”‚            â”‚                                 â”‚    â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚                                 â”‚    â”‚
â”‚  â”‚         â”‚                 â”‚                                 â”‚    â”‚
â”‚  â”‚         â–¼                 â–¼                                 â”‚    â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚    â”‚
â”‚  â”‚    â”‚     Constraint:         â”‚                              â”‚    â”‚
â”‚  â”‚    â”‚   hash(x) === y         â”‚                              â”‚    â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  æ­¥éª¤ 2: ç”µè·¯ç¼–è¯‘ä¸ºçº¦æŸç³»ç»Ÿ (R1CS / AIR / Plonkish)                     â”‚
â”‚                                                                     â”‚
â”‚  æ­¥éª¤ 3: ç”Ÿæˆè¯æ˜ (Prover) / éªŒè¯è¯æ˜ (Verifier)                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.7 çº¦æŸç³»ç»Ÿç®€ä»‹

#### R1CS (Rank-1 Constraint System)

SNARKs æœ€å¸¸ç”¨çš„çº¦æŸç³»ç»Ÿï¼š

```
æ¯ä¸ªçº¦æŸçš„å½¢å¼ï¼š(A Â· x) * (B Â· x) = (C Â· x)

å…¶ä¸­ï¼š
- x æ˜¯æ‰€æœ‰å˜é‡çš„å‘é‡ï¼ˆåŒ…æ‹¬è¾“å…¥ã€è¾“å‡ºã€ä¸­é—´å˜é‡ï¼‰
- A, B, C æ˜¯ç³»æ•°çŸ©é˜µçš„è¡Œå‘é‡

ç¤ºä¾‹ï¼šè¯æ˜ x * y = z

å˜é‡å‘é‡: [1, x, y, z]  (1 æ˜¯å¸¸æ•°é¡¹)

çº¦æŸ: x * y = z
è½¬æ¢ä¸º R1CS:
A = [0, 1, 0, 0]  â†’ A Â· x = x
B = [0, 0, 1, 0]  â†’ B Â· x = y
C = [0, 0, 0, 1]  â†’ C Â· x = z

éªŒè¯: (A Â· x) * (B Â· x) = x * y = z = (C Â· x) âœ“
```

#### Plonkish çº¦æŸ

PLONK ç³»åˆ—ä½¿ç”¨çš„æ›´çµæ´»çš„çº¦æŸç³»ç»Ÿï¼š

```
é€šç”¨é—¨çº¦æŸï¼š
q_L Â· a + q_R Â· b + q_O Â· c + q_M Â· (a * b) + q_C = 0

å…¶ä¸­ï¼š
- a, b, c æ˜¯é—¨çš„è¾“å…¥/è¾“å‡º
- q_L, q_R, q_O, q_M, q_C æ˜¯é€‰æ‹©å™¨ï¼ˆå†³å®šé—¨ç±»å‹ï¼‰

ç¤ºä¾‹ï¼š
åŠ æ³•é—¨ (a + b = c):  q_L=1, q_R=1, q_O=-1, q_M=0, q_C=0
ä¹˜æ³•é—¨ (a * b = c):  q_L=0, q_R=0, q_O=-1, q_M=1, q_C=0
å¸¸æ•°é—¨ (c = 5):      q_L=0, q_R=0, q_O=1, q_M=0, q_C=-5
```

### 1.8 ZK è¯æ˜ç”Ÿæˆæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK è¯æ˜å®Œæ•´æµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    1. ç”µè·¯å¼€å‘é˜¶æ®µ                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚
â”‚  â”‚  â”‚ ä¸šåŠ¡é€»è¾‘ â”‚â”€â”€â”€â–¶â”‚ DSL ä»£ç  â”‚â”€â”€â”€â–¶â”‚ ç¼–è¯‘å™¨   â”‚                  â”‚    â”‚
â”‚  â”‚  â”‚         â”‚    â”‚(Circom/ â”‚    â”‚         â”‚                  â”‚    â”‚
â”‚  â”‚  â”‚         â”‚    â”‚ Halo2)  â”‚    â”‚         â”‚                  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚  â”‚                                      â”‚                      â”‚    â”‚
â”‚  â”‚                                      â–¼                      â”‚    â”‚
â”‚  â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚    â”‚
â”‚  â”‚                              â”‚ çº¦æŸç³»ç»Ÿ     â”‚                â”‚    â”‚
â”‚  â”‚                              â”‚ (R1CS/AIR)  â”‚                â”‚    â”‚
â”‚  â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                      â”‚                              â”‚
â”‚                                      â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    2. è®¾ç½®é˜¶æ®µ (Setup)                       â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  å¯ä¿¡è®¾ç½® (Groth16)    æˆ–    é€šç”¨è®¾ç½® (PLONK)    æˆ–    æ— è®¾ç½®   â”‚    â”‚
â”‚  â”‚       â”‚                         â”‚                    â”‚      â”‚    â”‚
â”‚  â”‚       â–¼                         â–¼                    â”‚      â”‚    â”‚
â”‚  â”‚   ç‰¹å®šç”µè·¯çš„               å¯å¤ç”¨çš„ SRS                 â”‚      â”‚    â”‚
â”‚  â”‚   è¯æ˜å¯†é’¥/éªŒè¯å¯†é’¥        (Structured Reference        â”‚      â”‚    â”‚
â”‚  â”‚   (pk, vk)                 String)                   â”‚      â”‚    â”‚
â”‚  â”‚                                                      â”‚      â”‚    â”‚
â”‚  â”‚  âš ï¸ æ¯’æ€§åºŸæ–™é—®é¢˜           âœ… ä¸€æ¬¡è®¾ç½®å¤šæ¬¡ä½¿ç”¨        âœ… STARKs â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                      â”‚                              â”‚
â”‚                                      â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    3. è¯æ˜ç”Ÿæˆ (Prove)                        â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è¾“å…¥ï¼š                                                       â”‚    â”‚
â”‚  â”‚  â€¢ ç”µè·¯ + è¯æ˜å¯†é’¥                                            â”‚    â”‚
â”‚  â”‚  â€¢ å…¬å¼€è¾“å…¥ (public inputs)                                   â”‚    â”‚
â”‚  â”‚  â€¢ ç§æœ‰è¾“å…¥ (private inputs / witness)                        â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è¾“å‡ºï¼š                                                       â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜ (proof)                                               â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è®¡ç®—å¤æ‚åº¦ï¼šO(n log n) ~ O(nÂ²)ï¼Œé€šå¸¸éœ€è¦ç§’åˆ°åˆ†é’Ÿçº§åˆ«             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                      â”‚                              â”‚
â”‚                                      â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    4. éªŒè¯ (Verify)                          â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è¾“å…¥ï¼š                                                       â”‚    â”‚
â”‚  â”‚  â€¢ éªŒè¯å¯†é’¥ (vk)                                              â”‚    â”‚
â”‚  â”‚  â€¢ å…¬å¼€è¾“å…¥                                                   â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜                                                       â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è¾“å‡ºï¼š                                                       â”‚    â”‚
â”‚  â”‚  â€¢ true / false                                              â”‚    â”‚
â”‚  â”‚                                                              â”‚    â”‚
â”‚  â”‚  è®¡ç®—å¤æ‚åº¦ï¼šO(1) æˆ– O(log n)ï¼Œæ¯«ç§’çº§åˆ«                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.9 å…³é”®æœ¯è¯­é€ŸæŸ¥è¡¨

| æœ¯è¯­                        | å«ä¹‰                                 | ç±»æ¯”        |
|---------------------------|------------------------------------|-----------|
| **Witness**               | ç§æœ‰è¾“å…¥ï¼ˆè¯æ˜è€…çŸ¥é“ä½†ä¸å…¬å¼€ï¼‰                    | ä½ çŸ¥é“çš„å¯†ç     |
| **Public Input**          | å…¬å¼€è¾“å…¥ï¼ˆéªŒè¯è€…ä¹Ÿèƒ½çœ‹åˆ°ï¼‰                      | å…¬å¼€çš„ç”¨æˆ·å    |
| **Circuit**               | è®¡ç®—é€»è¾‘çš„ç”µè·¯è¡¨ç¤º                          | ç¨‹åºä»£ç       |
| **Constraint**            | çº¦æŸï¼ˆå¿…é¡»æ»¡è¶³çš„ç­‰å¼ï¼‰                        | assert è¯­å¥ |
| **Proving Key (pk)**      | ç”Ÿæˆè¯æ˜éœ€è¦çš„å¯†é’¥                          | ç§é’¥        |
| **Verification Key (vk)** | éªŒè¯è¯æ˜éœ€è¦çš„å¯†é’¥                          | å…¬é’¥        |
| **SRS**                   | Structured Reference Stringï¼Œé€šç”¨è®¾ç½®å‚æ•° | å…±äº«çš„é…ç½®     |
| **Trusted Setup**         | å¯ä¿¡è®¾ç½®ä»ªå¼                             | å¯†é’¥ç”Ÿæˆä»ªå¼    |
| **Soundness**             | å‡è¯æ˜è¢«æ¥å—çš„æ¦‚ç‡æä½                        | é˜²ä¼ªèƒ½åŠ›      |
| **Completeness**          | çœŸè¯æ˜æ€»èƒ½è¢«æ¥å—                           | å¯ç”¨æ€§       |
| **Succinctness**          | è¯æ˜å¾ˆå°ï¼ŒéªŒè¯å¾ˆå¿«                          | å‹ç¼©ç‡       |

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°å­¦åŸºç¡€ï¼ˆæœ€å°å¿…è¦çŸ¥è¯†ï¼‰

> æœ¬èŠ‚åªè®²**å¿…é¡»ç†è§£**çš„æ•°å­¦æ¦‚å¿µï¼Œè·³è¿‡æ‰€æœ‰å¯ä»¥"é»‘ç›’ä½¿ç”¨"çš„éƒ¨åˆ†ã€‚

### 2.1 æœ‰é™åŸŸ (Finite Field)

**ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ** ZK è¯æ˜ä¸­æ‰€æœ‰è¿ç®—éƒ½åœ¨æœ‰é™åŸŸä¸Šè¿›è¡Œï¼Œè€Œä¸æ˜¯æ™®é€šæ•´æ•°ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æœ‰é™åŸŸ F_p å¿«é€Ÿç†è§£                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å®šä¹‰ï¼šæ‰€æœ‰è¿ç®—ç»“æœéƒ½ mod p çš„æ•´æ•°é›†åˆ {0, 1, 2, ..., p-1}               â”‚
â”‚                                                                     â”‚
â”‚  ç¤ºä¾‹ï¼šF_7 = {0, 1, 2, 3, 4, 5, 6}                                   â”‚
â”‚                                                                     â”‚
â”‚  åŠ æ³•ï¼š5 + 4 = 9 mod 7 = 2                                           â”‚
â”‚  ä¹˜æ³•ï¼š5 * 4 = 20 mod 7 = 6                                          â”‚
â”‚  å‡æ³•ï¼š2 - 5 = -3 mod 7 = 4                                          â”‚
â”‚  é™¤æ³•ï¼š2 / 5 = 2 * 5^(-1) = 2 * 3 = 6  (å› ä¸º 5 * 3 = 15 mod 7 = 1)   â”‚
â”‚                                                                     â”‚
â”‚  å…³é”®æ€§è´¨ï¼š                                                          â”‚
â”‚  â€¢ åŠ å‡ä¹˜é™¤éƒ½å°é—­ï¼ˆç»“æœä»åœ¨åŸŸå†…ï¼‰                                        â”‚
â”‚  â€¢ æ²¡æœ‰æº¢å‡ºé—®é¢˜                                                       â”‚
â”‚  â€¢ p å¿…é¡»æ˜¯ç´ æ•°                                                      â”‚
â”‚                                                                     â”‚
â”‚  å¸¸ç”¨ç´ æ•°ï¼ˆåŒºå—é“¾ä¸­ï¼‰ï¼š                                                â”‚
â”‚  â€¢ BN254:  21888242871839275222246405745257275088548364400416034... â”‚
â”‚  â€¢ BLS12-381: 5231867187480318...                                   â”‚
â”‚  â€¢ Goldilocks: 2^64 - 2^32 + 1 (ç”¨äº Plonky2)                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Go ä»£ç ç¤ºä¾‹**ï¼š

```go
package main

import (
	"fmt"
	"math/big"
)

// FiniteField æœ‰é™åŸŸ
type FiniteField struct {
	p *big.Int // ç´ æ•°æ¨¡æ•°
}

// NewFiniteField åˆ›å»ºæœ‰é™åŸŸ
func NewFiniteField(p *big.Int) *FiniteField {
	return &FiniteField{p: p}
}

// Add åŸŸåŠ æ³•
func (f *FiniteField) Add(a, b *big.Int) *big.Int {
	result := new(big.Int).Add(a, b)
	return result.Mod(result, f.p)
}

// Mul åŸŸä¹˜æ³•
func (f *FiniteField) Mul(a, b *big.Int) *big.Int {
	result := new(big.Int).Mul(a, b)
	return result.Mod(result, f.p)
}

// Inv ä¹˜æ³•é€†å…ƒ (ä½¿ç”¨è´¹é©¬å°å®šç†: a^(-1) = a^(p-2) mod p)
func (f *FiniteField) Inv(a *big.Int) *big.Int {
	exp := new(big.Int).Sub(f.p, big.NewInt(2))
	return new(big.Int).Exp(a, exp, f.p)
}

// Div åŸŸé™¤æ³•
func (f *FiniteField) Div(a, b *big.Int) *big.Int {
	bInv := f.Inv(b)
	return f.Mul(a, bInv)
}

func main() {
	// ä½¿ç”¨å°ç´ æ•°æ¼”ç¤º
	p := big.NewInt(7)
	field := NewFiniteField(p)

	a := big.NewInt(5)
	b := big.NewInt(4)

	fmt.Printf("F_%d:\n", p)
	fmt.Printf("%d + %d = %d\n", a, b, field.Add(a, b))                         // 5 + 4 = 2
	fmt.Printf("%d * %d = %d\n", a, b, field.Mul(a, b))                         // 5 * 4 = 6
	fmt.Printf("%d / %d = %d\n", big.NewInt(2), a, field.Div(big.NewInt(2), a)) // 2 / 5 = 6
}
```

### 2.2 æ¤­åœ†æ›²çº¿åŸºç¡€

**ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ** SNARKs çš„å®‰å…¨æ€§åŸºäºæ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ¤­åœ†æ›²çº¿å¿«é€Ÿç†è§£                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ–¹ç¨‹ï¼šyÂ² = xÂ³ + ax + b (åœ¨æœ‰é™åŸŸ F_p ä¸Š)                              â”‚
â”‚                                                                     â”‚
â”‚  æ›²çº¿ä¸Šçš„ç‚¹å½¢æˆä¸€ä¸ªç¾¤ï¼š                                                 â”‚
â”‚  â€¢ å•ä½å…ƒï¼šæ— ç©·è¿œç‚¹ O (ç‚¹ + O = ç‚¹)                                    â”‚
â”‚  â€¢ åŠ æ³•ï¼šä¸¤ç‚¹è¿çº¿ä¸æ›²çº¿ç¬¬ä¸‰äº¤ç‚¹çš„å…³äº x è½´å¯¹ç§°ç‚¹                           â”‚
â”‚  â€¢ æ ‡é‡ä¹˜æ³•ï¼šn * P = P + P + ... + P (n æ¬¡)                           â”‚
â”‚                                                                     â”‚
â”‚  å…³é”®æ“ä½œï¼ˆä½ éœ€è¦çŸ¥é“çš„ï¼‰ï¼š                                              
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ç‚¹åŠ æ³•ï¼šP + Q = R                                           â”‚    â”‚
â”‚  â”‚  æ ‡é‡ä¹˜æ³•ï¼šn * G = P  (G æ˜¯ç”Ÿæˆå…ƒ)                             â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  æ ¸å¿ƒæ€§è´¨ï¼ˆç¦»æ•£å¯¹æ•°éš¾é¢˜ï¼‰ï¼š                                     â”‚    â”‚
â”‚  â”‚  â€¢ å·²çŸ¥ G å’Œ nï¼Œè®¡ç®— P = n * G å¾ˆå®¹æ˜“                          â”‚    â”‚
â”‚  â”‚  â€¢ å·²çŸ¥ G å’Œ Pï¼Œæ±‚ n å‡ ä¹ä¸å¯èƒ½                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  å¸¸ç”¨æ›²çº¿ï¼š                                                          â”‚
â”‚  â€¢ BN254 (alt_bn128)ï¼šä»¥å¤ªåŠé¢„ç¼–è¯‘åˆçº¦æ”¯æŒ                             â”‚
â”‚  â€¢ BLS12-381ï¼šä»¥å¤ªåŠ 2.0 ç­¾å                                         â”‚
â”‚  â€¢ secp256k1ï¼šæ¯”ç‰¹å¸/ä»¥å¤ªåŠè´¦æˆ·ç­¾å                                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 å¤šé¡¹å¼æ‰¿è¯º (Polynomial Commitment)

**ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ** è¿™æ˜¯ç°ä»£ ZK è¯æ˜ç³»ç»Ÿçš„æ ¸å¿ƒæ„å»ºå—ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤šé¡¹å¼æ‰¿è¯ºæ ¸å¿ƒæ¦‚å¿µ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  é—®é¢˜ï¼šæˆ‘æœ‰ä¸€ä¸ªå¤šé¡¹å¼ f(x)ï¼Œæƒ³è®©ä½ ç›¸ä¿¡ f(a) = bï¼Œä½†ä¸å‘Šè¯‰ä½  f(x)           â”‚
â”‚                                                                     â”‚
â”‚  æ–¹æ¡ˆï¼šå¤šé¡¹å¼æ‰¿è¯º                                                     â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. Commit: ç”Ÿæˆå¤šé¡¹å¼çš„æ‰¿è¯º C = Commit(f)                    â”‚    â”‚
â”‚  â”‚     â€¢ C å¾ˆå°ï¼ˆä¸€ä¸ªç¾¤å…ƒç´ ï¼‰                                    â”‚    â”‚
â”‚  â”‚     â€¢ æ— æ³•ä» C åæ¨ f                                        â”‚    â”‚
â”‚  â”‚     â€¢ ç»‘å®šæ€§ï¼šC å”¯ä¸€ç¡®å®š f                                    â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  2. Open: è¯æ˜ f(a) = b                                      â”‚    â”‚
â”‚  â”‚     â€¢ ç”Ÿæˆè¯æ˜ Ï€                                             â”‚    â”‚
â”‚  â”‚     â€¢ éªŒè¯è€…æ£€æŸ¥ Verify(C, a, b, Ï€)                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ä¸»æµæ–¹æ¡ˆï¼š                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  KZG (Kate-Zaverucha-Goldberg)                              â”‚    â”‚
â”‚  â”‚  â€¢ éœ€è¦å¯ä¿¡è®¾ç½®                                               â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜å¤§å°ï¼š1 ä¸ªç¾¤å…ƒç´  (~48 bytes)                            â”‚    â”‚
â”‚  â”‚  â€¢ éªŒè¯ï¼š2 æ¬¡é…å¯¹è¿ç®—                                          â”‚    â”‚
â”‚  â”‚  â€¢ ç”¨äºï¼šPLONK, Scroll, Polygon zkEVM                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FRI (Fast Reed-Solomon IOP)                                â”‚    â”‚
â”‚  â”‚  â€¢ æ— éœ€å¯ä¿¡è®¾ç½®                                               â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜å¤§å°ï¼šO(logÂ²n) ä¸ªå“ˆå¸Œ                                   â”‚    â”‚
â”‚  â”‚  â€¢ åé‡å­å®‰å…¨                                                 â”‚    â”‚
â”‚  â”‚  â€¢ ç”¨äºï¼šSTARKs, Plonky2                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  IPA (Inner Product Argument)                               â”‚    â”‚
â”‚  â”‚  â€¢ æ— éœ€å¯ä¿¡è®¾ç½®                                               â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜å¤§å°ï¼šO(log n) ä¸ªç¾¤å…ƒç´                                  â”‚    â”‚
â”‚  â”‚  â€¢ ç”¨äºï¼šHalo2, Bulletproofs                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 KZG æ‰¿è¯ºç®€åŒ–ç†è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      KZG æ‰¿è¯ºå·¥ä½œåŸç†                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  è®¾ç½®é˜¶æ®µï¼ˆå¯ä¿¡è®¾ç½®ï¼‰ï¼š                                                 â”‚
â”‚  â€¢ é€‰æ‹©ç§˜å¯†å€¼ Ï„ï¼ˆè®¾ç½®åå¿…é¡»é”€æ¯ï¼‰                                       â”‚
â”‚  â€¢ è®¡ç®— SRS = [G, Ï„G, Ï„Â²G, Ï„Â³G, ..., Ï„â¿G]                           â”‚
â”‚    å…¶ä¸­ G æ˜¯æ¤­åœ†æ›²çº¿ç”Ÿæˆå…ƒ                                             â”‚
â”‚                                                                     â”‚
â”‚  æ‰¿è¯ºé˜¶æ®µï¼š                                                          â”‚
â”‚  â€¢ å¤šé¡¹å¼ f(x) = aâ‚€ + aâ‚x + aâ‚‚xÂ² + ... + aâ‚™xâ¿                        â”‚
â”‚  â€¢ æ‰¿è¯º C = aâ‚€G + aâ‚(Ï„G) + aâ‚‚(Ï„Â²G) + ... = f(Ï„)Â·G                   â”‚
â”‚    æ³¨æ„ï¼šæˆ‘ä»¬ä¸çŸ¥é“ Ï„ï¼Œä½†èƒ½è®¡ç®— f(Ï„)Â·G                                  â”‚
â”‚                                                                     â”‚
â”‚  è¯æ˜ f(z) = yï¼š                                                     â”‚
â”‚  â€¢ æ„é€ å•†å¤šé¡¹å¼ q(x) = (f(x) - y) / (x - z)                           â”‚
â”‚  â€¢ è¯æ˜ Ï€ = q(Ï„)Â·G                                                   â”‚
â”‚                                                                     â”‚
â”‚  éªŒè¯ï¼š                                                              â”‚
â”‚  â€¢ ä½¿ç”¨é…å¯¹è¿ç®—æ£€æŸ¥ e(C - yG, G) = e(Ï€, Ï„G - zG)                       â”‚
â”‚  â€¢ ç­‰ä»·äºæ£€æŸ¥ f(Ï„) - y = q(Ï„) Â· (Ï„ - z)                               â”‚
â”‚  â€¢ å³ f(Ï„) - y = (f(Ï„) - y)ï¼Œæ’æˆç«‹å½“ä¸”ä»…å½“ f(z) = y                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Go ä»£ç ç¤ºä¾‹**ï¼ˆæ¦‚å¿µæ¼”ç¤ºï¼‰ï¼š

```go
package main

import (
	"github.com/consensys/gnark-crypto/ecc/bn254"
	"github.com/consensys/gnark-crypto/ecc/bn254/fr"
)

// KZGSetup è¡¨ç¤º KZG è®¾ç½®å‚æ•°
type KZGSetup struct {
	G1Powers []bn254.G1Affine // [G, Ï„G, Ï„Â²G, ...]
	G2Tau    bn254.G2Affine   // Ï„Â·G2
}

// Polynomial è¡¨ç¤ºå¤šé¡¹å¼
type Polynomial []fr.Element

// Commit è®¡ç®—å¤šé¡¹å¼æ‰¿è¯º
func (setup *KZGSetup) Commit(poly Polynomial) bn254.G1Affine {
	var commitment bn254.G1Affine

	// C = Î£ aáµ¢ Â· (Ï„â±Â·G)
	for i, coeff := range poly {
		var term bn254.G1Affine
		term.ScalarMultiplication(&setup.G1Powers[i], coeff.BigInt(new(big.Int)))
		commitment.Add(&commitment, &term)
	}

	return commitment
}

// CreateProof åˆ›å»º f(z) = y çš„è¯æ˜
func (setup *KZGSetup) CreateProof(poly Polynomial, z, y fr.Element) bn254.G1Affine {
	// è®¡ç®—å•†å¤šé¡¹å¼ q(x) = (f(x) - y) / (x - z)
	quotient := dividePolynomial(poly, z, y)

	// è¿”å› q(Ï„)Â·G
	return setup.Commit(quotient)
}

// Verify éªŒè¯è¯æ˜
func (setup *KZGSetup) Verify(
	commitment bn254.G1Affine,
	z, y fr.Element,
	proof bn254.G1Affine,
) bool {
	// éªŒè¯: e(C - yÂ·G, G2) = e(proof, Ï„Â·G2 - zÂ·G2)

	var yG, zG2 bn254.G1Affine
	var g2Gen bn254.G2Affine
	g2Gen.FromJacobian(&bn254.G2Affine{}.Generator())

	// C - yÂ·G
	yG.ScalarMultiplication(&setup.G1Powers[0], y.BigInt(new(big.Int)))
	var lhs bn254.G1Affine
	lhs.Sub(&commitment, &yG)

	// Ï„Â·G2 - zÂ·G2
	zG2.ScalarMultiplication(&g2Gen, z.BigInt(new(big.Int)))
	var rhs bn254.G2Affine
	rhs.Sub(&setup.G2Tau, &zG2)

	// é…å¯¹æ£€æŸ¥
	pairingLhs, _ := bn254.Pair([]bn254.G1Affine{lhs}, []bn254.G2Affine{g2Gen})
	pairingRhs, _ := bn254.Pair([]bn254.G1Affine{proof}, []bn254.G2Affine{rhs})

	return pairingLhs.Equal(&pairingRhs)
}
```

### 2.5 å°ç»“ï¼šä½ éœ€è¦è®°ä½çš„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°å­¦åŸºç¡€å°ç»“                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. æœ‰é™åŸŸï¼šæ‰€æœ‰ ZK è¿ç®—åœ¨ mod p ä¸‹è¿›è¡Œ                              â”‚
â”‚     â†’ è®°ä½ï¼šè¿ç®—ç»“æœæ€»åœ¨ [0, p-1] èŒƒå›´å†…                             â”‚
â”‚                                                                     â”‚
â”‚  2. æ¤­åœ†æ›²çº¿ï¼šæä¾›"å•å‘é—¨"å®‰å…¨æ€§                                     â”‚
â”‚     â†’ è®°ä½ï¼šn*G å®¹æ˜“ç®—ï¼Œä» P æ±‚ n å¾ˆéš¾                               â”‚
â”‚                                                                     â”‚
â”‚  3. å¤šé¡¹å¼æ‰¿è¯ºï¼šZK çš„æ ¸å¿ƒå·¥å…·                                        â”‚
â”‚     â†’ è®°ä½ï¼šæ‰¿è¯ºä¸€ä¸ªå¤šé¡¹å¼ï¼Œç„¶åè¯æ˜å®ƒåœ¨æŸç‚¹çš„å€¼                      â”‚
â”‚                                                                     â”‚
â”‚  4. å®é™…ä½¿ç”¨ï¼šä½ é€šå¸¸ä¸éœ€è¦æ‰‹å†™è¿™äº›                                   â”‚
â”‚     â†’ ä½¿ç”¨åº“ï¼šgnark, arkworks, halo2                                â”‚
â”‚     â†’ å…³æ³¨ç”µè·¯è®¾è®¡ï¼Œæ•°å­¦ç”±åº“å¤„ç†                                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šåŒºå—é“¾åº”ç”¨å®è·µ

### 3.1 zkRollup æ¶æ„è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      zkRollup å®Œæ•´æ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Layer 1 (ä»¥å¤ªåŠä¸»ç½‘)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
â”‚  â”‚  â”‚ zkRollup åˆçº¦  â”‚    â”‚  Verifier åˆçº¦â”‚                     â”‚    â”‚
â”‚  â”‚  â”‚               â”‚    â”‚               â”‚                     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ State Root  â”‚â—„â”€â”€â”€â”‚ â€¢ éªŒè¯ ZK è¯æ˜ â”‚                     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ L2 å­˜æ¬¾/ææ¬¾ â”‚    â”‚ â€¢ ~200k gas   â”‚                     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ æ‰¹é‡æäº¤     â”‚    â”‚               â”‚                     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â–²                                         â”‚
â”‚                           â”‚ æäº¤æ‰¹æ¬¡ + è¯æ˜                          â”‚
â”‚                           â”‚                                         â”‚
â”‚  Layer 2 (zkRollup)       â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        â”‚                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
â”‚  â”‚  â”‚              Sequencer / Prover           â”‚              â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ æ”¶é›† TX  â”‚â”€â–¶â”‚ æ‰§è¡Œ TX â”‚â”€â–¶â”‚ ç”Ÿæˆè¯æ˜  â”‚    â”‚              â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
â”‚  â”‚                        â–²                                    â”‚    â”‚
â”‚  â”‚                        â”‚                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
â”‚  â”‚  â”‚              ç”¨æˆ·äº¤æ˜“                      â”‚              â”‚    â”‚
â”‚  â”‚  â”‚  TX1, TX2, TX3, ... TXn                   â”‚              â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  æ•°æ®æµï¼š                                                            â”‚
â”‚  1. ç”¨æˆ·æäº¤ L2 äº¤æ˜“                                                 â”‚
â”‚  2. Sequencer æ’åºå¹¶æ‰§è¡Œäº¤æ˜“                                         â”‚
â”‚  3. Prover ä¸ºæ‰¹é‡äº¤æ˜“ç”Ÿæˆ ZK è¯æ˜                                     â”‚
â”‚  4. æäº¤æ–°çŠ¶æ€æ ¹ + è¯æ˜åˆ° L1                                          â”‚
â”‚  5. L1 éªŒè¯è¯æ˜ï¼Œæ›´æ–°çŠ¶æ€                                              â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 zkRollup çŠ¶æ€è¯æ˜

zkRollup éœ€è¦è¯æ˜çš„æ ¸å¿ƒé™ˆè¿°ï¼š

```
è¯æ˜: ç»™å®šæ—§çŠ¶æ€æ ¹ S_old å’Œä¸€æ‰¹äº¤æ˜“ [tx1, tx2, ..., txn]ï¼Œ
     æ‰§è¡Œåå¾—åˆ°æ–°çŠ¶æ€æ ¹ S_new

å³: S_new = STF(S_old, [tx1, tx2, ..., txn])
    å…¶ä¸­ STF = State Transition Function
```

**çŠ¶æ€è½¬æ¢ç”µè·¯**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  zkRollup çŠ¶æ€è½¬æ¢ç”µè·¯                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å…¬å¼€è¾“å…¥ (Public Inputs):                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ old_state_root: bytes32                                  â”‚    â”‚
â”‚  â”‚  â€¢ new_state_root: bytes32                                  â”‚    â”‚
â”‚  â”‚  â€¢ transactions_hash: bytes32 (äº¤æ˜“æ‰¹æ¬¡çš„å“ˆå¸Œ)                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ç§æœ‰è¾“å…¥ (Witness):                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ transactions: [tx1, tx2, ..., txn]                       â”‚    â”‚
â”‚  â”‚  â€¢ merkle_proofs: æ¯ä¸ªè´¦æˆ·çš„ Merkle è¯æ˜                      â”‚    â”‚
â”‚  â”‚  â€¢ signatures: æ¯ç¬”äº¤æ˜“çš„ç­¾å                                 â”‚    â”‚
â”‚  â”‚  â€¢ account_states: æ¯ä¸ªè´¦æˆ·çš„çŠ¶æ€ (nonce, balance)            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ç”µè·¯çº¦æŸï¼š                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  for each tx in transactions:                               â”‚    â”‚
â”‚  â”‚    1. éªŒè¯ç­¾åæ­£ç¡®                                            â”‚    â”‚
â”‚  â”‚    2. éªŒè¯ nonce æ­£ç¡®                                        â”‚    â”‚
â”‚  â”‚    3. éªŒè¯ä½™é¢å……è¶³                                            â”‚    â”‚
â”‚  â”‚    4. éªŒè¯ Merkle è¯æ˜ (è´¦æˆ·åœ¨æ—§çŠ¶æ€æ ‘ä¸­)                       â”‚    â”‚
â”‚  â”‚    5. æ›´æ–°è´¦æˆ·çŠ¶æ€ (æ‰£æ¬¾/æ”¶æ¬¾/æ›´æ–° nonce)                       â”‚    â”‚
â”‚  â”‚    6. è®¡ç®—æ–°çš„ Merkle æ ¹                                     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  final_root === new_state_root                              â”‚    â”‚
â”‚  â”‚  hash(transactions) === transactions_hash                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 zkEVM ç±»å‹å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      zkEVM ç±»å‹åˆ†ç±» (Vitalik)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Type 1: å®Œå…¨ä»¥å¤ªåŠç­‰æ•ˆ                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ä¸ä»¥å¤ªåŠå®Œå…¨ç›¸åŒï¼ˆåŒ…æ‹¬å“ˆå¸Œã€çŠ¶æ€æ ‘ç­‰ï¼‰                         â”‚    â”‚
â”‚  â”‚  â€¢ æ— éœ€ä»»ä½•ä»£ç ä¿®æ”¹                                           â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜ç”Ÿæˆéå¸¸æ…¢ï¼ˆå°æ—¶çº§ï¼‰                                     â”‚    â”‚
â”‚  â”‚  â€¢ ä»£è¡¨ï¼šTaiko, (éƒ¨åˆ†) Scroll                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  Type 2: å®Œå…¨ EVM ç­‰æ•ˆ                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ EVM å®Œå…¨ç›¸åŒï¼Œä½†åº•å±‚æ•°æ®ç»“æ„å¯èƒ½ä¸åŒ                          â”‚    â”‚
â”‚  â”‚  â€¢ åº”ç”¨æ— éœ€ä¿®æ”¹                                              â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜è¾ƒæ…¢ï¼ˆåˆ†é’Ÿçº§ï¼‰                                          â”‚    â”‚
â”‚  â”‚  â€¢ ä»£è¡¨ï¼šScroll, Polygon zkEVM                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  Type 2.5: EVM ç­‰æ•ˆä½† gas ä¸åŒ                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ æŸäº›æ“ä½œ gas æˆæœ¬ä¸åŒ                                     â”‚    â”‚
â”‚  â”‚  â€¢ å¤§éƒ¨åˆ†åº”ç”¨å…¼å®¹                                            â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜è¾ƒå¿«                                                  â”‚    â”‚
â”‚  â”‚  â€¢ ä»£è¡¨ï¼šScroll                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  Type 3: æ¥è¿‘ EVM ç­‰æ•ˆ                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ç§»é™¤äº†éš¾ä»¥è¯æ˜çš„ç‰¹æ€§ (å¦‚æŸäº›é¢„ç¼–è¯‘)                        â”‚    â”‚
â”‚  â”‚  â€¢ éœ€è¦å°å¹…ä¿®æ”¹æ‰èƒ½éƒ¨ç½²                                       â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜æ›´å¿«                                                  â”‚    â”‚
â”‚  â”‚  â€¢ ä»£è¡¨ï¼šæ—©æœŸ Scroll                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  Type 4: é«˜çº§è¯­è¨€ç­‰æ•ˆ                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ç¼–è¯‘ Solidity/Vyper åˆ°è‡ªå®šä¹‰ VM                           â”‚    â”‚
â”‚  â”‚  â€¢ ä¸æ˜¯ EVM å­—èŠ‚ç å…¼å®¹                                       â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜æœ€å¿«ï¼ˆç§’çº§ï¼‰                                          â”‚    â”‚
â”‚  â”‚  â€¢ ä»£è¡¨ï¼šzkSync Era, StarkNet                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  æƒè¡¡ï¼šå…¼å®¹æ€§ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ€§èƒ½            â”‚
â”‚        Type 1                                          Type 4       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 ä¸»æµ zkRollup é¡¹ç›®å¯¹æ¯”

| é¡¹ç›®                | è¯æ˜ç³»ç»Ÿ           | zkEVM ç±»å‹       | TPS   | ç‰¹ç‚¹               |
|-------------------|----------------|----------------|-------|------------------|
| **zkSync Era**    | PLONK + Boojum | Type 4         | ~2000 | åŸç”Ÿè´¦æˆ·æŠ½è±¡, LLVM ç¼–è¯‘å™¨ |
| **StarkNet**      | STARK          | Type 4 (Cairo) | ~1000 | åé‡å­å®‰å…¨, Cairo è¯­è¨€  |
| **Scroll**        | PLONK + KZG    | Type 2         | ~500  | æœ€æ¥è¿‘ä»¥å¤ªåŠ, ç¤¾åŒºé©±åŠ¨     |
| **Polygon zkEVM** | PLONK + FRI    | Type 2         | ~500  | å¼€æº, é€’å½’è¯æ˜         |
| **Linea**         | Groth16        | Type 2         | ~500  | ConsenSys èƒŒä¹¦     |
| **Taiko**         | SGX + ZK       | Type 1         | ~200  | Based rollup     |

### 3.5 zkRollup äº¤äº’å®è·µ

**Go ä»£ç ï¼šä¸ zkSync Era äº¤äº’**

```go
package main

import (
	"context"
	"crypto/ecdsa"
	"fmt"
	"math/big"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/ethereum/go-ethereum/ethclient"
	"github.com/zksync-sdk/zksync2-go/accounts"
	"github.com/zksync-sdk/zksync2-go/clients"
	"github.com/zksync-sdk/zksync2-go/types"
)

func main() {
	// è¿æ¥ zkSync Era
	zkClient, err := clients.Dial("https://mainnet.era.zksync.io")
	if err != nil {
		panic(err)
	}
	defer zkClient.Close()

	// L1 ä»¥å¤ªåŠå®¢æˆ·ç«¯ (ç”¨äºå­˜æ¬¾/ææ¬¾)
	ethClient, err := ethclient.Dial("https://eth.llamarpc.com")
	if err != nil {
		panic(err)
	}
	defer ethClient.Close()

	// åŠ è½½ç§é’¥
	privateKey, err := crypto.HexToECDSA("YOUR_PRIVATE_KEY")
	if err != nil {
		panic(err)
	}

	// åˆ›å»ºé’±åŒ…
	wallet, err := accounts.NewWallet(privateKey, zkClient, ethClient)
	if err != nil {
		panic(err)
	}

	ctx := context.Background()

	// æŸ¥è¯¢ä½™é¢
	balance, err := wallet.Balance(ctx, utils.EthAddress, nil)
	if err != nil {
		panic(err)
	}
	fmt.Printf("L2 Balance: %s ETH\n", weiToEth(balance))

	// å‘é€ L2 äº¤æ˜“
	to := common.HexToAddress("0x...")
	amount := big.NewInt(1e16) // 0.01 ETH

	tx, err := wallet.Transfer(ctx, accounts.TransferTransaction{
		To:     to,
		Amount: amount,
		Token:  utils.EthAddress,
	})
	if err != nil {
		panic(err)
	}

	// ç­‰å¾…äº¤æ˜“ç¡®è®¤
	receipt, err := zkClient.WaitMined(ctx, tx.Hash())
	if err != nil {
		panic(err)
	}
	fmt.Printf("TX confirmed in block %d\n", receipt.BlockNumber)
}

func weiToEth(wei *big.Int) string {
	eth := new(big.Float).Quo(
		new(big.Float).SetInt(wei),
		new(big.Float).SetInt(big.NewInt(1e18)),
	)
	return eth.Text('f', 6)
}
```

**ä¸ StarkNet äº¤äº’ï¼ˆGo/Rustï¼‰**

```go
package main

import (
	"context"
	"fmt"

	"github.com/NethermindEth/starknet.go/account"
	"github.com/NethermindEth/starknet.go/rpc"
	"github.com/NethermindEth/starknet.go/utils"
)

func main() {
	// è¿æ¥ StarkNet
	client, err := rpc.NewClient("https://starknet-mainnet.public.blastapi.io")
	if err != nil {
		panic(err)
	}

	// åˆ›å»ºè´¦æˆ· (StarkNet ä½¿ç”¨ä¸åŒçš„ç­¾åæ–¹æ¡ˆ)
	privateKey := "0x..." // StarkNet ç§é’¥
	accountAddress := "0x..."

	account, err := account.NewAccount(
		client,
		utils.HexToFelt(accountAddress),
		utils.HexToFelt(privateKey),
	)
	if err != nil {
		panic(err)
	}

	ctx := context.Background()

	// æŸ¥è¯¢ä½™é¢ (è°ƒç”¨ ERC20 åˆçº¦)
	ethAddress := utils.HexToFelt("0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7")

	result, err := client.Call(ctx, rpc.FunctionCall{
		ContractAddress:    ethAddress,
		EntryPointSelector: utils.GetSelectorFromName("balanceOf"),
		Calldata:           []*felt.Felt{account.AccountAddress},
	}, rpc.BlockID{Tag: "latest"})
	if err != nil {
		panic(err)
	}

	fmt.Printf("Balance: %s\n", result[0].String())

	// å‘é€äº¤æ˜“
	tx, err := account.Execute(ctx, []rpc.FunctionCall{
		{
			ContractAddress:    ethAddress,
			EntryPointSelector: utils.GetSelectorFromName("transfer"),
			Calldata: []*felt.Felt{
				utils.HexToFelt("0x..."),  // æ¥æ”¶åœ°å€
				utils.HexToFelt("0x1000"), // é‡‘é¢ low
				utils.HexToFelt("0x0"),    // é‡‘é¢ high
			},
		},
	}, rpc.ExecuteDetails{})
	if err != nil {
		panic(err)
	}

	fmt.Printf("TX Hash: %s\n", tx.TransactionHash.String())
}
```

### 3.6 ZK éšç§åº”ç”¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK éšç§åè®®æ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ä»¥ Tornado Cash ç±»åè®®ä¸ºä¾‹ï¼š                                        â”‚
â”‚                                                                     â”‚
â”‚  å­˜æ¬¾æµç¨‹ï¼š                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1. ç”¨æˆ·ç”Ÿæˆéšæœº secret å’Œ nullifier                         â”‚    â”‚
â”‚  â”‚  2. commitment = hash(secret, nullifier)                    â”‚    â”‚
â”‚  â”‚  3. å°† commitment æ’å…¥ Merkle æ ‘                             â”‚    â”‚
â”‚  â”‚  4. å­˜å…¥å›ºå®šé‡‘é¢ (å¦‚ 1 ETH)                                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  é“¾ä¸Šå­˜å‚¨ï¼š                                                   â”‚    â”‚
â”‚  â”‚  â€¢ Merkle æ ‘ï¼ˆæ‰€æœ‰ commitmentï¼‰                              â”‚    â”‚
â”‚  â”‚  â€¢ å·²ä½¿ç”¨çš„ nullifier é›†åˆ                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  å–æ¬¾æµç¨‹ï¼š                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ç”¨æˆ·ç”Ÿæˆ ZK è¯æ˜ï¼Œè¯æ˜ï¼š                                     â”‚    â”‚
â”‚  â”‚  1. æˆ‘çŸ¥é“æŸä¸ª secret å’Œ nullifier                          â”‚    â”‚
â”‚  â”‚  2. hash(secret, nullifier) åœ¨ Merkle æ ‘ä¸­                  â”‚    â”‚
â”‚  â”‚  3. è¿™ä¸ª nullifier æ²¡æœ‰è¢«ä½¿ç”¨è¿‡                              â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  å…¬å¼€è¾“å…¥ï¼š                                                   â”‚    â”‚
â”‚  â”‚  â€¢ Merkle root (éªŒè¯ commitment å­˜åœ¨)                        â”‚    â”‚
â”‚  â”‚  â€¢ nullifier hash (é˜²æ­¢åŒèŠ±)                                 â”‚    â”‚
â”‚  â”‚  â€¢ recipient address (æ¥æ”¶åœ°å€)                              â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  ç§æœ‰è¾“å…¥ï¼š                                                   â”‚    â”‚
â”‚  â”‚  â€¢ secret                                                   â”‚    â”‚
â”‚  â”‚  â€¢ nullifier                                                â”‚    â”‚
â”‚  â”‚  â€¢ Merkle proof                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  éšç§ä¿è¯ï¼š                                                          â”‚
â”‚  â€¢ éªŒè¯è€…æ— æ³•çŸ¥é“æ˜¯å“ªç¬”å­˜æ¬¾                                          â”‚
â”‚  â€¢ æ— æ³•å…³è”å­˜æ¬¾äººå’Œå–æ¬¾äºº                                            â”‚
â”‚  â€¢ é‡‘é¢å›ºå®šè¿›ä¸€æ­¥å¢å¼ºéšç§                                            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.7 ZK è·¨é“¾æ¡¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZK è·¨é“¾æ¡¥æ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ä¼ ç»Ÿæ¡¥ vs ZK æ¡¥ï¼š                                                   â”‚
â”‚                                                                     â”‚
â”‚  ä¼ ç»Ÿå¤šç­¾æ¡¥ï¼š                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ä¾èµ– N/M å¤šç­¾éªŒè¯è€…                                       â”‚    â”‚
â”‚  â”‚  â€¢ ä¿¡ä»»å‡è®¾ï¼šè¯šå®å¤šæ•°                                        â”‚    â”‚
â”‚  â”‚  â€¢ æ”»å‡»é¢ï¼šè´¿èµ‚/é»‘å®¢æ”»å‡»éªŒè¯è€…                                â”‚    â”‚
â”‚  â”‚  â€¢ å†å²æŸå¤±ï¼šæ•°åäº¿ç¾å…ƒ                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ZK æ¡¥ï¼š                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ è¯æ˜æºé“¾ä¸Šçš„çŠ¶æ€/äº¤æ˜“                                      â”‚    â”‚
â”‚  â”‚  â€¢ ä¿¡ä»»å‡è®¾ï¼šä»…å¯†ç å­¦                                        â”‚    â”‚
â”‚  â”‚  â€¢ æ— éœ€ä¿¡ä»»ä»»ä½•éªŒè¯è€…                                        â”‚    â”‚
â”‚  â”‚  â€¢ å®‰å…¨æ€§ = æºé“¾å®‰å…¨æ€§ + ZK å®‰å…¨æ€§                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ZK Light Client æ¡¥å·¥ä½œæµç¨‹ï¼š                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚   Chain A                           Chain B                 â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚   â”‚ Block N â”‚                       â”‚ Verifierâ”‚             â”‚    â”‚
â”‚  â”‚   â”‚ Header  â”‚                       â”‚ Contractâ”‚             â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â–²â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚        â”‚                                 â”‚                  â”‚    â”‚
â”‚  â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                  â”‚    â”‚
â”‚  â”‚        â””â”€â”€â”€â–¶â”‚   ZK Prover    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚  â”‚             â”‚                 â”‚                             â”‚    â”‚
â”‚  â”‚             â”‚ è¯æ˜:           â”‚                             â”‚    â”‚
â”‚  â”‚             â”‚ 1. Block N æœ‰æ•ˆ â”‚                             â”‚    â”‚
â”‚  â”‚             â”‚ 2. TX åœ¨ Block Nâ”‚                             â”‚    â”‚
â”‚  â”‚             â”‚ 3. å…±è¯†ç­¾åæœ‰æ•ˆ â”‚                             â”‚    â”‚
â”‚  â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ZK è·¨é“¾æ¡¥é¡¹ç›®**ï¼š

| é¡¹ç›®                       | æ–¹æ¡ˆ                   | æ”¯æŒé“¾ | ç‰¹ç‚¹       |
|--------------------------|----------------------|-----|----------|
| **Succinct**             | SNARK + Light Client | å¤šé“¾  | è¯æ˜å…±è¯†ç­¾å   |
| **Polyhedra (zkBridge)** | STARK                | å¤šé“¾  | å»ä¸­å¿ƒåŒ–è¯æ˜ç½‘ç»œ |
| **=nil; Foundation**     | PLONK                | å¤šé“¾  | é€šç”¨è¯æ˜å¸‚åœº   |
| **Lagrange**             | State Proof          | å¤šé“¾  | è¯æ˜å­˜å‚¨çŠ¶æ€   |

### 3.8 ZK èº«ä»½ä¸å‡­è¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK èº«ä»½éªŒè¯                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  åœºæ™¯ï¼šè¯æ˜"æˆ‘å¹´é¾„ >= 18"è€Œä¸é€éœ²å…·ä½“ç”Ÿæ—¥                             â”‚
â”‚                                                                     â”‚
â”‚  ä¼ ç»Ÿæ–¹æ¡ˆï¼š                                                          â”‚
â”‚  â€¢ å‡ºç¤ºèº«ä»½è¯ â†’ å¯¹æ–¹çŸ¥é“ä½ çš„ç”Ÿæ—¥ã€åœ°å€ã€å§“å...                        â”‚
â”‚                                                                     â”‚
â”‚  ZK æ–¹æ¡ˆï¼š                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  å‘è¡Œæ–¹ (å¦‚æ”¿åºœ)           ç”¨æˆ·                   éªŒè¯æ–¹      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚ ç­¾å    â”‚              â”‚         â”‚           â”‚         â”‚ â”‚    â”‚
â”‚  â”‚  â”‚ ç”¨æˆ·    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ ç”Ÿæˆ    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ éªŒè¯    â”‚ â”‚    â”‚
â”‚  â”‚  â”‚ å‡­è¯    â”‚              â”‚ ZK è¯æ˜ â”‚           â”‚ è¯æ˜    â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  ç­¾åå‡­è¯åŒ…å«:              ZK è¯æ˜:              éªŒè¯æ–¹å¾—çŸ¥: â”‚    â”‚
â”‚  â”‚  â€¢ å§“å: Alice             â€¢ æˆ‘æœ‰æœ‰æ•ˆå‡­è¯         â€¢ ç”¨æˆ·>=18 â”‚    â”‚
â”‚  â”‚  â€¢ ç”Ÿæ—¥: 1990-01-15        â€¢ å‡­è¯è¢«æˆæƒæœºæ„ç­¾å    â€¢ å‡­è¯æœ‰æ•ˆ â”‚    â”‚
â”‚  â”‚  â€¢ è¯ä»¶å·: xxx             â€¢ æˆ‘çš„å¹´é¾„ >= 18                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  éªŒè¯æ–¹ä¸çŸ¥é“:                                                â”‚    â”‚
â”‚  â”‚  â€¢ å…·ä½“å§“åã€ç”Ÿæ—¥ã€è¯ä»¶å·                                      â”‚    â”‚
â”‚  â”‚  â€¢ åªçŸ¥é“"æŸä¸ªæœ‰æ•ˆå‡­è¯æŒæœ‰è€…å¹´é¾„>=18"                          â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ä»£è¡¨é¡¹ç›®ï¼š                                                          â”‚
â”‚  â€¢ Worldcoin: è¯æ˜"æˆ‘æ˜¯äººç±»"ä¸”æœªæ³¨å†Œè¿‡                               â”‚
â”‚  â€¢ Polygon ID: é€šç”¨å‡­è¯æ¡†æ¶                                         â”‚
â”‚  â€¢ Semaphore: åŒ¿åç¾¤ç»„æˆå‘˜è¯æ˜                                       â”‚
â”‚  â€¢ Sismo: é“¾ä¸Šå£°èª‰èšåˆ                                              â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šä»£ç å®æˆ˜

### 4.1 ZK å¼€å‘æ¡†æ¶é€‰æ‹©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZK å¼€å‘æ¡†æ¶å¯¹æ¯”                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  è¯­è¨€ / æ¡†æ¶          è¯æ˜ç³»ç»Ÿ         é€‚ç”¨åœºæ™¯                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Circom (JS DSL)      Groth16/PLONK    å…¥é—¨å­¦ä¹ , å°å‹ç”µè·¯            â”‚
â”‚  gnark (Go)           Groth16/PLONK    ç”Ÿäº§çº§, Go ç”Ÿæ€               â”‚
â”‚  arkworks (Rust)      å¤šç§             åº•å±‚å¼€å‘, é«˜æ€§èƒ½              â”‚
â”‚  halo2 (Rust)         PLONK/IPA        Scroll, Zcash                â”‚
â”‚  Cairo (Rust-like)    STARK            StarkNet ä¸“ç”¨                â”‚
â”‚  Noir (Rust-like)     å¤šç§             Aztec, æ–°æ‰‹å‹å¥½               â”‚
â”‚  SP1 (Rust)           STARK            zkVM, é€šç”¨ Rust è¯æ˜          â”‚
â”‚  Risc0 (Rust)         STARK            zkVM, RISC-V è¯æ˜            â”‚
â”‚                                                                     â”‚
â”‚  æ¨èå­¦ä¹ è·¯å¾„ï¼š                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  å…¥é—¨ â†’ Circom (æ¦‚å¿µç†è§£) â†’ gnark/Noir (å®é™…å¼€å‘)            â”‚    â”‚
â”‚  â”‚       â†’ arkworks/halo2 (æ·±å…¥ç ”ç©¶)                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Circom å¿«é€Ÿå…¥é—¨

**å®‰è£…**ï¼š

```bash
# å®‰è£… Circom ç¼–è¯‘å™¨
curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh
git clone https://github.com/iden3/circom.git
cd circom
cargo build --release
cargo install --path circom

# å®‰è£… snarkjs
npm install -g snarkjs
```

**ç¤ºä¾‹ 1ï¼šç®€å•ä¹˜æ³•è¯æ˜**

```circom
// multiply.circom
// è¯æ˜: æˆ‘çŸ¥é“ a å’Œ bï¼Œä½¿å¾— a * b = c

pragma circom 2.0.0;

template Multiply() {
    // ç§æœ‰è¾“å…¥
    signal input a;
    signal input b;

    // å…¬å¼€è¾“å‡º
    signal output c;

    // çº¦æŸ: a * b = c
    c <== a * b;
}

component main = Multiply();
```

**ç¼–è¯‘å’Œç”Ÿæˆè¯æ˜**ï¼š

```bash
# ç¼–è¯‘ç”µè·¯
circom multiply.circom --r1cs --wasm --sym

# ç”Ÿæˆå¯ä¿¡è®¾ç½® (Powers of Tau)
snarkjs powersoftau new bn128 12 pot12_0000.ptau -v
snarkjs powersoftau contribute pot12_0000.ptau pot12_0001.ptau --name="First" -v
snarkjs powersoftau prepare phase2 pot12_0001.ptau pot12_final.ptau -v

# ä¸ºç‰¹å®šç”µè·¯ç”Ÿæˆå¯†é’¥
snarkjs groth16 setup multiply.r1cs pot12_final.ptau multiply_0000.zkey
snarkjs zkey contribute multiply_0000.zkey multiply_final.zkey --name="Contributor" -v
snarkjs zkey export verificationkey multiply_final.zkey verification_key.json

# ç”Ÿæˆ witness
echo '{"a": "3", "b": "4"}' > input.json
node multiply_js/generate_witness.js multiply_js/multiply.wasm input.json witness.wtns

# ç”Ÿæˆè¯æ˜
snarkjs groth16 prove multiply_final.zkey witness.wtns proof.json public.json

# éªŒè¯è¯æ˜
snarkjs groth16 verify verification_key.json public.json proof.json

# å¯¼å‡º Solidity éªŒè¯åˆçº¦
snarkjs zkey export solidityverifier multiply_final.zkey verifier.sol
```

**ç¤ºä¾‹ 2ï¼šMerkle æ ‘æˆå‘˜è¯æ˜**

```circom
// merkle.circom
// è¯æ˜: æˆ‘çŸ¥é“ä¸€ä¸ªå¶å­èŠ‚ç‚¹å’Œ Merkle è·¯å¾„ï¼Œä½¿å¾—å®ƒå±äºæŸä¸ª Merkle æ ‘

pragma circom 2.0.0;

include "circomlib/poseidon.circom";

template MerkleProof(levels) {
    signal input leaf;
    signal input pathElements[levels];
    signal input pathIndices[levels];  // 0 = å·¦, 1 = å³
    signal output root;

    signal hashes[levels + 1];
    hashes[0] <== leaf;

    component hashers[levels];

    for (var i = 0; i < levels; i++) {
        hashers[i] = Poseidon(2);

        // æ ¹æ® pathIndex å†³å®šå·¦å³é¡ºåº
        var left = (1 - pathIndices[i]) * hashes[i] + pathIndices[i] * pathElements[i];
        var right = pathIndices[i] * hashes[i] + (1 - pathIndices[i]) * pathElements[i];

        hashers[i].inputs[0] <== left;
        hashers[i].inputs[1] <== right;
        hashes[i + 1] <== hashers[i].out;
    }

    root <== hashes[levels];
}

// 20 å±‚ Merkle æ ‘ï¼Œå¯å®¹çº³ 2^20 = 100ä¸‡+ å¶å­
component main {public [root]} = MerkleProof(20);
```

### 4.3 gnark (Go) å®æˆ˜

**å®‰è£…**ï¼š

```bash
go get github.com/consensys/gnark
go get github.com/consensys/gnark-crypto
```

**ç¤ºä¾‹ 1ï¼šHash åŸåƒè¯æ˜**

```go
package main

import (
	"fmt"

	"github.com/consensys/gnark-crypto/ecc"
	"github.com/consensys/gnark/backend/groth16"
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/frontend/cs/r1cs"
	"github.com/consensys/gnark/std/hash/mimc"
)

// HashPreimageCircuit è¯æ˜: æˆ‘çŸ¥é“ preimageï¼Œä½¿å¾— hash(preimage) = hash
type HashPreimageCircuit struct {
	// ç§æœ‰è¾“å…¥
	Preimage frontend.Variable

	// å…¬å¼€è¾“å…¥
	Hash frontend.Variable `gnark:",public"`
}

// Define å®šä¹‰ç”µè·¯çº¦æŸ
func (circuit *HashPreimageCircuit) Define(api frontend.API) error {
	// åˆ›å»º MiMC å“ˆå¸Œå™¨
	mimc, _ := mimc.NewMiMC(api)
	mimc.Write(circuit.Preimage)
	computedHash := mimc.Sum()

	// çº¦æŸ: è®¡ç®—çš„å“ˆå¸Œå¿…é¡»ç­‰äºå…¬å¼€çš„å“ˆå¸Œ
	api.AssertIsEqual(computedHash, circuit.Hash)

	return nil
}

func main() {
	// 1. ç¼–è¯‘ç”µè·¯
	var circuit HashPreimageCircuit
	r1cs, err := frontend.Compile(ecc.BN254.ScalarField(), r1cs.NewBuilder, &circuit)
	if err != nil {
		panic(err)
	}
	fmt.Printf("ç”µè·¯çº¦æŸæ•°é‡: %d\n", r1cs.GetNbConstraints())

	// 2. è®¾ç½® (ç”Ÿæˆ pk, vk)
	pk, vk, err := groth16.Setup(r1cs)
	if err != nil {
		panic(err)
	}

	// 3. è®¡ç®—çœŸå®çš„å“ˆå¸Œå€¼ (é“¾ä¸‹)
	preimageValue := 12345
	goMimc := mimc.NewMiMC()
	goMimc.Write([]byte{byte(preimageValue)})
	hashValue := goMimc.Sum(nil)

	// 4. åˆ›å»º witness
	assignment := HashPreimageCircuit{
		Preimage: preimageValue,
		Hash:     hashValue,
	}
	witness, err := frontend.NewWitness(&assignment, ecc.BN254.ScalarField())
	if err != nil {
		panic(err)
	}

	// 5. ç”Ÿæˆè¯æ˜
	proof, err := groth16.Prove(r1cs, pk, witness)
	if err != nil {
		panic(err)
	}
	fmt.Println("è¯æ˜ç”ŸæˆæˆåŠŸ!")

	// 6. éªŒè¯è¯æ˜
	publicWitness, _ := witness.Public()
	err = groth16.Verify(proof, vk, publicWitness)
	if err != nil {
		panic(err)
	}
	fmt.Println("è¯æ˜éªŒè¯æˆåŠŸ!")

	// 7. å¯¼å‡º Solidity éªŒè¯åˆçº¦
	f, _ := os.Create("verifier.sol")
	vk.ExportSolidity(f)
	f.Close()
	fmt.Println("Solidity åˆçº¦å·²ç”Ÿæˆ")
}
```

**ç¤ºä¾‹ 2ï¼šç­¾åéªŒè¯ç”µè·¯**

```go
package main

import (
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/std/algebra/native/twistededwards"
	"github.com/consensys/gnark/std/signature/eddsa"
)

// SignatureVerifyCircuit éªŒè¯ EdDSA ç­¾å
type SignatureVerifyCircuit struct {
	PublicKey eddsa.PublicKey   `gnark:",public"`
	Signature eddsa.Signature   `gnark:",public"`
	Message   frontend.Variable `gnark:",public"`
}

func (circuit *SignatureVerifyCircuit) Define(api frontend.API) error {
	// è·å–æ›²çº¿
	curve, _ := twistededwards.NewEdCurve(api, twistededwards.BN254)

	// åˆ›å»º MiMC å“ˆå¸Œ
	mimc, _ := mimc.NewMiMC(api)

	// éªŒè¯ç­¾å
	eddsa.Verify(curve, circuit.Signature, circuit.Message, circuit.PublicKey, &mimc)

	return nil
}
```

**ç¤ºä¾‹ 3ï¼šèŒƒå›´è¯æ˜ (Range Proof)**

```go
package main

import (
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/std/rangecheck"
)

// RangeProofCircuit è¯æ˜: value åœ¨ [0, 2^bits) èŒƒå›´å†…
type RangeProofCircuit struct {
	Value frontend.Variable // ç§æœ‰: è¦è¯æ˜çš„å€¼
	Max   frontend.Variable `gnark:",public"` // å…¬å¼€: æœ€å¤§å€¼
}

func (circuit *RangeProofCircuit) Define(api frontend.API) error {
	// ä½¿ç”¨èŒƒå›´æ£€æŸ¥å™¨
	rangeChecker := rangecheck.New(api)

	// æ£€æŸ¥ value åœ¨ 64 ä½èŒƒå›´å†…
	rangeChecker.Check(circuit.Value, 64)

	// æ£€æŸ¥ value <= max
	diff := api.Sub(circuit.Max, circuit.Value)
	rangeChecker.Check(diff, 64)

	return nil
}

// åº”ç”¨åœºæ™¯: éšç§äº¤æ˜“ä¸­è¯æ˜"æˆ‘æœ‰è¶³å¤Ÿä½™é¢"è€Œä¸é€éœ²å…·ä½“é‡‘é¢
```

### 4.4 Halo2 (Rust) ç¤ºä¾‹

**Cargo.toml**ï¼š

```toml
[dependencies]
halo2_proofs = "0.3"
halo2curves = "0.4"
```

**ç¤ºä¾‹ï¼šç®€å•ç®—æœ¯ç”µè·¯**

```rust
use halo2_proofs::{
    circuit::{Layouter, SimpleFloorPlanner, Value},
    plonk::{Advice, Circuit, Column, ConstraintSystem, Error, Selector},
    poly::Rotation,
    pasta::Fp,
};

// ç”µè·¯é…ç½®
#[derive(Clone, Debug)]
struct SimpleConfig {
    advice: [Column<Advice>; 2],
    selector: Selector,
}

// ç”µè·¯å®šä¹‰: è¯æ˜ a * b = c
#[derive(Default)]
struct SimpleCircuit {
    a: Value<Fp>,
    b: Value<Fp>,
}

impl Circuit<Fp> for SimpleCircuit {
    type Config = SimpleConfig;
    type FloorPlanner = SimpleFloorPlanner;

    fn without_witnesses(&self) -> Self {
        Self::default()
    }

    fn configure(meta: &mut ConstraintSystem<Fp>) -> Self::Config {
        let advice = [meta.advice_column(), meta.advice_column()];
        let selector = meta.selector();

        // å¯ç”¨ç›¸ç­‰çº¦æŸ
        meta.enable_equality(advice[0]);
        meta.enable_equality(advice[1]);

        // å®šä¹‰ä¹˜æ³•é—¨
        meta.create_gate("mul", |meta| {
            let s = meta.query_selector(selector);
            let a = meta.query_advice(advice[0], Rotation::cur());
            let b = meta.query_advice(advice[1], Rotation::cur());
            let c = meta.query_advice(advice[0], Rotation::next());

            // s * (a * b - c) = 0
            // å½“ s = 1 æ—¶ï¼Œè¦æ±‚ a * b = c
            vec![s * (a * b - c)]
        });

        SimpleConfig { advice, selector }
    }

    fn synthesize(
        &self,
        config: Self::Config,
        mut layouter: impl Layouter<Fp>,
    ) -> Result<(), Error> {
        layouter.assign_region(
            || "multiply",
            |mut region| {
                // å¯ç”¨é€‰æ‹©å™¨
                config.selector.enable(&mut region, 0)?;

                // åˆ†é… a
                region.assign_advice(
                    || "a",
                    config.advice[0],
                    0,
                    || self.a,
                )?;

                // åˆ†é… b
                region.assign_advice(
                    || "b",
                    config.advice[1],
                    0,
                    || self.b,
                )?;

                // åˆ†é… c = a * b
                let c = self.a.and_then(|a| self.b.map(|b| a * b));
                region.assign_advice(
                    || "c",
                    config.advice[0],
                    1,
                    || c,
                )?;

                Ok(())
            },
        )
    }
}

fn main() {
    use halo2_proofs::{
        dev::MockProver,
        pasta::Fp,
    };

    // åˆ›å»ºç”µè·¯å®ä¾‹
    let circuit = SimpleCircuit {
        a: Value::known(Fp::from(3)),
        b: Value::known(Fp::from(4)),
    };

    // ä½¿ç”¨ MockProver æµ‹è¯•
    let prover = MockProver::run(4, &circuit, vec![]).unwrap();
    prover.assert_satisfied();

    println!("ç”µè·¯æµ‹è¯•é€šè¿‡!");
}
```

### 4.5 SP1 / Risc0 zkVM

**zkVM çš„ä¼˜åŠ¿**ï¼šæ— éœ€æ‰‹å†™ç”µè·¯ï¼Œç›´æ¥è¯æ˜ Rust ç¨‹åºæ‰§è¡Œ

**SP1 ç¤ºä¾‹**ï¼š

```rust
// program/main.rs - è¦è¯æ˜çš„ç¨‹åº
#![no_main]
sp1_zkvm::entrypoint!(main);

use sha2::{Digest, Sha256};

pub fn main() {
    // è¯»å–ç§æœ‰è¾“å…¥
    let preimage: Vec<u8> = sp1_zkvm::io::read();

    // è®¡ç®—å“ˆå¸Œ
    let mut hasher = Sha256::new();
    hasher.update(&preimage);
    let hash = hasher.finalize();

    // è¾“å‡ºå…¬å¼€ç»“æœ
    sp1_zkvm::io::commit(&hash[..]);
}
```

```rust
// script/main.rs - ç”Ÿæˆè¯æ˜
use sp1_sdk::{ProverClient, SP1Stdin};

fn main() {
    // åˆå§‹åŒ–
    let client = ProverClient::new();
    let elf = include_bytes!("../../program/elf/riscv32im-succinct-zkvm-elf");

    // å‡†å¤‡è¾“å…¥
    let mut stdin = SP1Stdin::new();
    stdin.write(&b"secret preimage".to_vec());

    // ç”Ÿæˆè¯æ˜
    let (pk, vk) = client.setup(elf);
    let proof = client.prove(&pk, stdin).expect("proving failed");

    // éªŒè¯
    client.verify(&proof, &vk).expect("verification failed");

    println!("è¯æ˜éªŒè¯æˆåŠŸ!");

    // è·å–å…¬å¼€è¾“å‡º
    let hash: Vec<u8> = proof.public_values.read();
    println!("Hash: {:?}", hash);
}
```

### 4.6 é“¾ä¸ŠéªŒè¯åˆçº¦

**Groth16 éªŒè¯åˆçº¦ (Solidity)**ï¼š

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

/// @title Groth16 éªŒè¯åˆçº¦
/// @notice ç”± snarkjs æˆ– gnark è‡ªåŠ¨ç”Ÿæˆ
contract Groth16Verifier {
    // é…å¯¹é¢„ç¼–è¯‘åˆçº¦åœ°å€
    uint256 constant PRIME_Q = 21888242871839275222246405745257275088696311157297823662689037894645226208583;

    // éªŒè¯å¯†é’¥ (ç”± setup ç”Ÿæˆ)
    struct VerifyingKey {
        uint256[2] alpha1;
        uint256[2][2] beta2;
        uint256[2][2] gamma2;
        uint256[2][2] delta2;
        uint256[2][] IC;
    }

    VerifyingKey vk;

    constructor() {
        // åˆå§‹åŒ–éªŒè¯å¯†é’¥ (ä» gnark/snarkjs å¯¼å‡º)
        vk.alpha1 = [uint256(0x...), uint256(0x...)];
        vk.beta2 = [[uint256(0x...), uint256(0x...)], [uint256(0x...), uint256(0x...)]];
        // ... å…¶ä»–å‚æ•°
    }

    /// @notice éªŒè¯ Groth16 è¯æ˜
    /// @param proof è¯æ˜æ•°æ® [a, b, c]
    /// @param publicInputs å…¬å¼€è¾“å…¥
    function verify(
        uint256[8] calldata proof,
        uint256[] calldata publicInputs
    ) public view returns (bool) {
        require(publicInputs.length + 1 == vk.IC.length, "Invalid inputs length");

        // è®¡ç®—çº¿æ€§ç»„åˆ
        uint256[2] memory vk_x = vk.IC[0];
        for (uint256 i = 0; i < publicInputs.length; i++) {
            require(publicInputs[i] < PRIME_Q, "Input too large");
            vk_x = addition(
                vk_x,
                scalar_mul(vk.IC[i + 1], publicInputs[i])
            );
        }

        // é…å¯¹æ£€æŸ¥
        // e(A, B) = e(alpha, beta) * e(vk_x, gamma) * e(C, delta)
        return pairing(
            negate(proof[0 : 2]),   // -A
            proof[2 : 6],           // B
            vk.alpha1,
            vk.beta2,
            vk_x,
            vk.gamma2,
            proof[6 : 8],           // C
            vk.delta2
        );
    }

    // æ¤­åœ†æ›²çº¿è¿ç®— (ä½¿ç”¨é¢„ç¼–è¯‘åˆçº¦)
    function addition(uint256[2] memory p1, uint256[2] memory p2)
    internal view returns (uint256[2] memory r)
    {
        assembly {
            let success := staticcall(sub(gas(), 2000), 6, p1, 0x80, r, 0x40)
            if iszero(success) {revert(0, 0)}
        }
    }

    function scalar_mul(uint256[2] memory p, uint256 s)
    internal view returns (uint256[2] memory r)
    {
        uint256[3] memory input;
        input[0] = p[0];
        input[1] = p[1];
        input[2] = s;
        assembly {
            let success := staticcall(sub(gas(), 2000), 7, input, 0x60, r, 0x40)
            if iszero(success) {revert(0, 0)}
        }
    }

    function pairing(/* ... */) internal view returns (bool) {
        // è°ƒç”¨é…å¯¹é¢„ç¼–è¯‘åˆçº¦ (0x08)
        // ...
    }
}
```

### 4.7 å®Œæ•´åº”ç”¨ï¼šéšç§æŠ•ç¥¨ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    éšç§æŠ•ç¥¨ç³»ç»Ÿæ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  éœ€æ±‚ï¼š                                                              â”‚
â”‚  1. åªæœ‰æ³¨å†Œé€‰æ°‘å¯ä»¥æŠ•ç¥¨                                              â”‚
â”‚  2. æ¯äººåªèƒ½æŠ•ä¸€ç¥¨                                                   â”‚
â”‚  3. æŠ•ç¥¨å†…å®¹ä¿å¯†                                                     â”‚
â”‚  4. ä»»ä½•äººå¯ä»¥éªŒè¯æŠ•ç¥¨ç»“æœ                                            â”‚
â”‚                                                                     â”‚
â”‚  ZK æ–¹æ¡ˆï¼š                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  è¯æ˜å†…å®¹:                                                   â”‚    â”‚
â”‚  â”‚  1. æˆ‘æ‹¥æœ‰æŸä¸ªæ³¨å†Œçš„èº«ä»½ (åœ¨ Merkle æ ‘ä¸­)                     â”‚    â”‚
â”‚  â”‚  2. æˆ‘çš„ nullifier æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ (é˜²æ­¢åŒé‡æŠ•ç¥¨)                â”‚    â”‚
â”‚  â”‚  3. æˆ‘çš„æŠ•ç¥¨æ˜¯æœ‰æ•ˆé€‰é¡¹ä¹‹ä¸€                                    â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  å…¬å¼€è¾“å…¥: Merkle root, nullifier hash, vote option         â”‚    â”‚
â”‚  â”‚  ç§æœ‰è¾“å…¥: identity, merkle proof, nullifier                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Circom ç”µè·¯**ï¼š

```circom
pragma circom 2.0.0;

include "circomlib/poseidon.circom";
include "circomlib/comparators.circom";

template PrivateVoting(levels, numOptions) {
    // å…¬å¼€è¾“å…¥
    signal input merkleRoot;
    signal input nullifierHash;
    signal input voteOption;

    // ç§æœ‰è¾“å…¥
    signal input identitySecret;
    signal input identityNullifier;
    signal input merklePathElements[levels];
    signal input merklePathIndices[levels];

    // 1. éªŒè¯èº«ä»½åœ¨ Merkle æ ‘ä¸­
    component identityHasher = Poseidon(2);
    identityHasher.inputs[0] <== identitySecret;
    identityHasher.inputs[1] <== identityNullifier;
    signal identityCommitment <== identityHasher.out;

    // è®¡ç®— Merkle æ ¹
    component merkleProof = MerkleTreeChecker(levels);
    merkleProof.leaf <== identityCommitment;
    for (var i = 0; i < levels; i++) {
        merkleProof.pathElements[i] <== merklePathElements[i];
        merkleProof.pathIndices[i] <== merklePathIndices[i];
    }
    merkleRoot === merkleProof.root;

    // 2. éªŒè¯ nullifier hash
    component nullifierHasher = Poseidon(1);
    nullifierHasher.inputs[0] <== identityNullifier;
    nullifierHash === nullifierHasher.out;

    // 3. éªŒè¯æŠ•ç¥¨é€‰é¡¹æœ‰æ•ˆ (0 åˆ° numOptions-1)
    component validOption = LessThan(32);
    validOption.in[0] <== voteOption;
    validOption.in[1] <== numOptions;
    validOption.out === 1;
}

component main {public [merkleRoot, nullifierHash, voteOption]} = PrivateVoting(20, 5);
```

**Go æŠ•ç¥¨åˆçº¦äº¤äº’**ï¼š

```go
package main

import (
	"context"
	"math/big"

	"github.com/ethereum/go-ethereum/accounts/abi/bind"
	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/ethclient"
)

// æŠ•ç¥¨ç³»ç»Ÿå®¢æˆ·ç«¯
type VotingClient struct {
	contract *VotingContract
	prover   *ZKProver
}

// æŠ•ç¥¨
func (c *VotingClient) Vote(
	ctx context.Context,
	identity *Identity,
	voteOption uint64,
	merkleProof *MerkleProof,
) error {
	// 1. ç”Ÿæˆ ZK è¯æ˜
	proof, publicInputs, err := c.prover.GenerateProof(
		identity.Secret,
		identity.Nullifier,
		voteOption,
		merkleProof,
	)
	if err != nil {
		return err
	}

	// 2. æäº¤åˆ°é“¾ä¸Š
	tx, err := c.contract.Vote(
		&bind.TransactOpts{},
		publicInputs.MerkleRoot,
		publicInputs.NullifierHash,
		big.NewInt(int64(voteOption)),
		proof,
	)
	if err != nil {
		return err
	}

	// 3. ç­‰å¾…ç¡®è®¤
	receipt, err := bind.WaitMined(ctx, c.contract.client, tx)
	if err != nil {
		return err
	}

	fmt.Printf("æŠ•ç¥¨æˆåŠŸ! TX: %s\n", receipt.TxHash.Hex())
	return nil
}
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šæ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ

### 5.1 ç”µè·¯ä¼˜åŒ–æŠ€å·§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”µè·¯ä¼˜åŒ–æŒ‡å—                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. å‡å°‘çº¦æŸæ•°é‡                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ä½åˆ†è§£ä»£æ›¿æ¯”è¾ƒè¿ç®—                                     â”‚    â”‚
â”‚  â”‚  â€¢ åˆå¹¶ç›¸ä¼¼çº¦æŸ                                               â”‚    â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨æŸ¥æ‰¾è¡¨ (lookup) ä»£æ›¿å¤æ‚è®¡ç®—                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  // å·®: å¤šæ¬¡çº¦æŸ                                             â”‚    â”‚
â”‚  â”‚  for i in 0..n { assert(arr[i] < 256) }                     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  // å¥½: ä½¿ç”¨èŒƒå›´æŸ¥æ‰¾è¡¨                                        â”‚    â”‚
â”‚  â”‚  range_check(arr, 8_bits)                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  2. é€‰æ‹©åˆé€‚çš„å“ˆå¸Œå‡½æ•°                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  å“ˆå¸Œå‡½æ•°          çº¦æŸæ•° (per hash)   é€‚ç”¨åœºæ™¯               â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚    â”‚
â”‚  â”‚  Poseidon          ~300              ZK å‹å¥½ï¼Œé¦–é€‰          â”‚    â”‚
â”‚  â”‚  MiMC              ~500              è¾ƒè€ä½†æˆç†Ÿ              â”‚    â”‚
â”‚  â”‚  Pedersen          ~1500             æ‰¿è¯ºåœºæ™¯                â”‚    â”‚
â”‚  â”‚  SHA256            ~25000            å…¼å®¹æ€§éœ€æ±‚              â”‚    â”‚
â”‚  â”‚  Keccak256         ~140000           ä»¥å¤ªåŠå…¼å®¹              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  3. å¹¶è¡ŒåŒ–è¯æ˜ç”Ÿæˆ                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ GPU åŠ é€Ÿ (CUDA/Metal)                                â”‚    â”‚
â”‚  â”‚  â€¢ å¤šæ ¸ CPU å¹¶è¡Œ                                             â”‚    â”‚
â”‚  â”‚  â€¢ åˆ†å¸ƒå¼è¯æ˜ç”Ÿæˆ                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  4. é€’å½’è¯æ˜                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  åœºæ™¯: éªŒè¯å¤§é‡äº¤æ˜“                                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  æ–¹æ¡ˆ A: ä¸€ä¸ªå¤§è¯æ˜ (æ…¢)                                      â”‚    â”‚
â”‚  â”‚  proof = prove(tx1, tx2, ..., tx1000)                       â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  æ–¹æ¡ˆ B: é€’å½’è¯æ˜ (å¿«)                                        â”‚    â”‚
â”‚  â”‚  proof1 = prove(tx1, tx2, ..., tx100)                       â”‚    â”‚
â”‚  â”‚  proof2 = prove(tx101, ..., tx200)                          â”‚    â”‚
â”‚  â”‚  ...                                                        â”‚    â”‚
â”‚  â”‚  final = prove(proof1, proof2, ..., proof10)                â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  ä¼˜åŠ¿: å¯å¹¶è¡Œï¼Œå¢é‡æ›´æ–°                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å®‰å…¨æ³¨æ„äº‹é¡¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZK å®‰å…¨æ¸…å•                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  âš ï¸ å¸¸è§æ¼æ´:                                                        â”‚
â”‚                                                                     â”‚
â”‚  1. æœªçº¦æŸä¿¡å·                                                       â”‚
â”‚     âœ— signal x;  // x å¯ä»¥æ˜¯ä»»æ„å€¼!                                  â”‚
â”‚     âœ“ signal x; x * x === x;  // çº¦æŸ x åªèƒ½æ˜¯ 0 æˆ– 1                â”‚
â”‚                                                                     â”‚
â”‚  2. çº¦æŸä¸å®Œæ•´                                                       â”‚
â”‚     âœ— a * b === c;  // å¦‚æœ a = 0ï¼Œb å¯ä»¥æ˜¯ä»»æ„å€¼                    â”‚
â”‚     âœ“ a !== 0; a * b === c;                                        â”‚
â”‚                                                                     â”‚
â”‚  3. æ•´æ•°æº¢å‡º                                                         â”‚
â”‚     âœ— result <== a + b;  // å¯èƒ½æº¢å‡ºåŸŸå¤§å°                           â”‚
â”‚     âœ“ ç¡®ä¿è¾“å…¥åœ¨å®‰å…¨èŒƒå›´å†…                                           â”‚
â”‚                                                                     â”‚
â”‚  4. å¯ä¿¡è®¾ç½®æ³„éœ²                                                     â”‚
â”‚     âœ— ä½¿ç”¨æœªé”€æ¯ toxic waste çš„è®¾ç½®                                  â”‚
â”‚     âœ“ ä½¿ç”¨å…¬å¼€çš„ Powers of Tau ä»ªå¼å‚æ•°                              â”‚
â”‚                                                                     â”‚
â”‚  5. ä¿¡æ¯æ³„éœ²                                                         â”‚
â”‚     âœ— é€šè¿‡æ‰§è¡Œæ—¶é—´ã€è¯æ˜å¤§å°æ³„éœ²ç§æœ‰è¾“å…¥ä¿¡æ¯                          â”‚
â”‚     âœ“ ä½¿ç”¨å›ºå®šæ—¶é—´ç®—æ³•ï¼Œç»Ÿä¸€è¯æ˜å¤§å°                                  â”‚
â”‚                                                                     â”‚
â”‚  âœ… å®‰å…¨æ£€æŸ¥:                                                        â”‚
â”‚  â€¢ ä½¿ç”¨å½¢å¼åŒ–éªŒè¯å·¥å…· (Ecne, Picus)                                  â”‚
â”‚  â€¢ å®¡è®¡æ‰€æœ‰çº¦æŸå®Œæ•´æ€§                                                â”‚
â”‚  â€¢ æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œé›¶å€¼                                                â”‚
â”‚  â€¢ å®¡æŸ¥å…¬å¼€/ç§æœ‰è¾“å…¥åˆ’åˆ†                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 å·¥å…·é“¾ä¸èµ„æº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¼€å‘å·¥å…·ä¸èµ„æº                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å¼€å‘å·¥å…·:                                                           â”‚
â”‚  â€¢ Circomspect: Circom é™æ€åˆ†æå™¨                                   â”‚
â”‚  â€¢ gnark-debug: gnark è°ƒè¯•å·¥å…·                                      â”‚
â”‚  â€¢ halo2-analyzer: Halo2 ç”µè·¯åˆ†æ                                   â”‚
â”‚                                                                     â”‚
â”‚  æµ‹è¯•æ¡†æ¶:                                                           â”‚
â”‚  â€¢ MockProver (halo2): å¿«é€Ÿæœ¬åœ°æµ‹è¯•                                 â”‚
â”‚  â€¢ circom_tester: Circom å•å…ƒæµ‹è¯•                                   â”‚
â”‚  â€¢ gnark test package: Go æµ‹è¯•é›†æˆ                                  â”‚
â”‚                                                                     â”‚
â”‚  å­¦ä¹ èµ„æº:                                                           â”‚
â”‚  â€¢ ZK Whiteboard Sessions (YouTube)                                 â”‚
â”‚  â€¢ 0xPARC Learning Group                                           â”‚
â”‚  â€¢ zkSNARKs in a Nutshell                                          â”‚
â”‚  â€¢ Halo2 Book (https://zcash.github.io/halo2/)                     â”‚
â”‚  â€¢ gnark Docs (https://docs.gnark.consensys.net/)                  â”‚
â”‚                                                                     â”‚
â”‚  å¼€æºé¡¹ç›®å‚è€ƒ:                                                       â”‚
â”‚  â€¢ Semaphore: åŒ¿åä¿¡å·åè®®                                          â”‚
â”‚  â€¢ Tornado Cash: éšç§äº¤æ˜“ (æ•™è‚²ç”¨)                                  â”‚
â”‚  â€¢ zkSync: å¼€æº zkRollup                                           â”‚
â”‚  â€¢ Scroll: zkEVM å®ç°                                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ€»ç»“ï¼šå¿«é€Ÿä¸Šæ‰‹è·¯çº¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ZK å­¦ä¹ è·¯çº¿å›¾                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Week 1: æ¦‚å¿µç†è§£                                                    â”‚
â”‚  â”œâ”€â”€ ç†è§£ ZK ä¸‰å±æ€§ (å®Œå¤‡æ€§/å¯é æ€§/é›¶çŸ¥è¯†)                            â”‚
â”‚  â”œâ”€â”€ äº†è§£ SNARKs vs STARKs åŒºåˆ«                                     â”‚
â”‚  â””â”€â”€ é˜…è¯»ç®€å•ç”µè·¯ç¤ºä¾‹                                                â”‚
â”‚                                                                     â”‚
â”‚  Week 2: åŠ¨æ‰‹å®è·µ                                                    â”‚
â”‚  â”œâ”€â”€ å®‰è£… Circom + snarkjs                                         â”‚
â”‚  â”œâ”€â”€ ç¼–å†™ç¬¬ä¸€ä¸ªç”µè·¯ (ä¹˜æ³•/å“ˆå¸Œ)                                      â”‚
â”‚  â””â”€â”€ ç”Ÿæˆå¹¶éªŒè¯è¯æ˜                                                  â”‚
â”‚                                                                     â”‚
â”‚  Week 3: è¿›é˜¶å¼€å‘                                                    â”‚
â”‚  â”œâ”€â”€ å­¦ä¹  gnark (Go) æˆ– arkworks (Rust)                            â”‚
â”‚  â”œâ”€â”€ å®ç° Merkle æ ‘è¯æ˜                                             â”‚
â”‚  â””â”€â”€ éƒ¨ç½² Solidity éªŒè¯åˆçº¦                                         â”‚
â”‚                                                                     â”‚
â”‚  Week 4: åº”ç”¨æ„å»º                                                    â”‚
â”‚  â”œâ”€â”€ é€‰æ‹©å…·ä½“åº”ç”¨åœºæ™¯ (éšç§/æ‰©å®¹/èº«ä»½)                               â”‚
â”‚  â”œâ”€â”€ è®¾è®¡å®Œæ•´ç”µè·¯                                                    â”‚
â”‚  â””â”€â”€ é›†æˆå‰åç«¯                                                      â”‚
â”‚                                                                     â”‚
â”‚  æŒç»­å­¦ä¹ :                                                           â”‚
â”‚  â”œâ”€â”€ ç ”ç©¶ zkEVM å®ç°                                                â”‚
â”‚  â”œâ”€â”€ äº†è§£é€’å½’è¯æ˜                                                    â”‚
â”‚  â””â”€â”€ å…³æ³¨æ–°è¯æ˜ç³»ç»Ÿ (Plonky3, Binius)                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®è®°å¿†ç‚¹:

1. ZK = è¯æ˜è®¡ç®—æ­£ç¡®æ€§ï¼Œä¸æ³„éœ²è¾“å…¥
2. ç”µè·¯ = å°†ç¨‹åºè½¬æ¢ä¸ºçº¦æŸç³»ç»Ÿ
3. SNARKs: è¯æ˜å°/éªŒè¯å¿«/éœ€è¦è®¾ç½®
4. STARKs: é€æ˜/åé‡å­å®‰å…¨/è¯æ˜å¤§
5. å®é™…å¼€å‘: ç”¨åº“ï¼Œä¸“æ³¨ç”µè·¯è®¾è®¡
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šé€’å½’è¯æ˜ (Recursive Proofs)

### 6.1 ä»€ä¹ˆæ˜¯é€’å½’è¯æ˜ï¼Ÿ

**æ ¸å¿ƒæ€æƒ³**ï¼šåœ¨ç”µè·¯å†…éƒ¨éªŒè¯å¦ä¸€ä¸ª ZK è¯æ˜ï¼Œå®ç°"è¯æ˜çš„è¯æ˜"ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é€’å½’è¯æ˜æ ¸å¿ƒæ¦‚å¿µ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ™®é€šè¯æ˜:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Prover                              Verifier               â”‚    â”‚
â”‚  â”‚    â”‚                                    â”‚                   â”‚    â”‚
â”‚  â”‚    â”‚  proof = Prove(circuit, witness)   â”‚                   â”‚    â”‚
â”‚  â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚    â”‚
â”‚  â”‚    â”‚                                    â”‚ Verify(vk, proof) â”‚    â”‚
â”‚  â”‚    â”‚                                    â”‚ â†’ true/false      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  é€’å½’è¯æ˜:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  proofâ‚ â”€â”                                                  â”‚    â”‚
â”‚  â”‚          â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚    â”‚
â”‚  â”‚  proofâ‚‚ â”€â”¼â”€â”€â”€â”€â–¶â”‚  Aggregation     â”‚                         â”‚    â”‚
â”‚  â”‚          â”‚     â”‚  Circuit         â”‚â”€â”€â”€â”€â–¶ aggregated_proof   â”‚    â”‚
â”‚  â”‚  proofâ‚ƒ â”€â”˜     â”‚                  â”‚                         â”‚    â”‚
â”‚  â”‚                â”‚  éªŒè¯ proofâ‚,â‚‚,â‚ƒ  â”‚                         â”‚    â”‚
â”‚  â”‚                â”‚  åœ¨ç”µè·¯å†…éƒ¨!       â”‚                         â”‚    â”‚
â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  æœ€ç»ˆ: 1 ä¸ªå°è¯æ˜ = éªŒè¯ N ä¸ªåŸå§‹è¯æ˜                         â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  åº”ç”¨åœºæ™¯:                                                           â”‚
â”‚  â€¢ zkRollup: èšåˆæ•°åƒç¬”äº¤æ˜“çš„è¯æ˜                                    â”‚
â”‚  â€¢ å¢é‡å¯éªŒè¯è®¡ç®— (IVC): æŒç»­ç´¯ç§¯è®¡ç®—                                â”‚
â”‚  â€¢ è¯æ˜å‹ç¼©: å‡å°‘é“¾ä¸ŠéªŒè¯æˆæœ¬                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 é€’å½’è¯æ˜çš„æŒ‘æˆ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é€’å½’è¯æ˜æŠ€æœ¯æŒ‘æˆ˜                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ ¸å¿ƒé—®é¢˜: åœ¨ç”µè·¯ä¸­éªŒè¯è¯æ˜éœ€è¦"åŸç”Ÿ"æ”¯æŒéªŒè¯ç®—æ³•                      â”‚
â”‚                                                                     â”‚
â”‚  æŒ‘æˆ˜ 1: åŸŸä¸åŒ¹é… (Field Mismatch)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ A ä½¿ç”¨åŸŸ F_p                                     â”‚    â”‚
â”‚  â”‚  â€¢ åœ¨ F_p ç”µè·¯ä¸­éªŒè¯éœ€è¦æ¨¡æ‹Ÿ F_q è¿ç®—                         â”‚    â”‚
â”‚  â”‚  â€¢ éåŸç”ŸåŸŸè¿ç®—å¼€é”€å·¨å¤§ (~1000x)                              â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  è§£å†³æ–¹æ¡ˆ:                                                   â”‚    â”‚
â”‚  â”‚  â€¢ å¾ªç¯æ›²çº¿ (Cycle of Curves): ä¸¤æ¡æ›²çº¿äº’ä¸ºå¯¹æ–¹çš„æ ‡é‡åŸŸ       â”‚    â”‚
â”‚  â”‚  â€¢ ä¾‹: Pasta curves (Pallas + Vesta) ç”¨äº Halo2              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  æŒ‘æˆ˜ 2: éªŒè¯ç”µè·¯å¤§å°                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ Groth16 éªŒè¯éœ€è¦é…å¯¹è¿ç®— â†’ ç”µè·¯çº¦æŸæ•°ç™¾ä¸‡                   â”‚    â”‚
â”‚  â”‚  â€¢ PLONK éªŒè¯ç›¸å¯¹ç®€å•ä½†ä»éœ€å¤§é‡çº¦æŸ                           â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  è§£å†³æ–¹æ¡ˆ:                                                   â”‚    â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨éªŒè¯å‹å¥½çš„è¯æ˜ç³»ç»Ÿ (IPA-based)                         â”‚    â”‚
â”‚  â”‚  â€¢ å»¶è¿ŸéªŒè¯ (Deferred Verification)                          â”‚    â”‚
â”‚  â”‚  â€¢ æŠ˜å æ–¹æ¡ˆ (Folding Schemes)                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  æŒ‘æˆ˜ 3: å¯ä¿¡è®¾ç½®ä¼ é€’                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â€¢ æ¯å±‚é€’å½’éœ€è¦ä¸åŒçš„ SRS?                                    â”‚    â”‚
â”‚  â”‚  â€¢ è§£å†³: ä½¿ç”¨é€šç”¨ SRS (Universal Setup)                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 å¾ªç¯æ›²çº¿ (Cycle of Curves)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Pasta Curves (Pallas + Vesta)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å®šä¹‰:                                                              â”‚
â”‚  â€¢ Pallas: yÂ² = xÂ³ + 5 over F_p                                    â”‚
â”‚  â€¢ Vesta:  yÂ² = xÂ³ + 5 over F_q                                    â”‚
â”‚  â€¢ å…³é”®: p = |Vesta| (Vesta ç¾¤çš„é˜¶)                                 â”‚
â”‚         q = |Pallas| (Pallas ç¾¤çš„é˜¶)                                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚    Pallas (F_p)                    Vesta (F_q)              â”‚    â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚    â”‚ æ ‡é‡åŸŸ=F_qâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ åŸºåŸŸ=F_q  â”‚             â”‚    â”‚
â”‚  â”‚    â”‚ åŸºåŸŸ=F_p  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ æ ‡é‡åŸŸ=F_pâ”‚             â”‚    â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚         â”‚                               â”‚                   â”‚    â”‚
â”‚  â”‚         â”‚  Pallas ç”µè·¯çš„                â”‚  Vesta ç”µè·¯çš„      â”‚    â”‚
â”‚  â”‚         â”‚  witness åœ¨ F_q              â”‚  witness åœ¨ F_p    â”‚    â”‚
â”‚  â”‚         â”‚                               â”‚                   â”‚    â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
â”‚  â”‚                     â”‚                                       â”‚    â”‚
â”‚  â”‚                     â–¼                                       â”‚    â”‚
â”‚  â”‚         Pallas è¯æ˜å¯ä»¥åœ¨ Vesta ç”µè·¯ä¸­                       â”‚    â”‚
â”‚  â”‚         åŸç”ŸéªŒè¯ (æ— éœ€æ¨¡æ‹ŸåŸŸè¿ç®—)                            â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  å·¥ä½œæµç¨‹:                                                           â”‚
â”‚  1. åœ¨ Pallas ä¸Šç”Ÿæˆ proofâ‚                                         â”‚
â”‚  2. åœ¨ Vesta ç”µè·¯ä¸­éªŒè¯ proofâ‚ï¼Œç”Ÿæˆ proofâ‚‚                         â”‚
â”‚  3. åœ¨ Pallas ç”µè·¯ä¸­éªŒè¯ proofâ‚‚ï¼Œç”Ÿæˆ proofâ‚ƒ                        â”‚
â”‚  4. äº¤æ›¿è¿›è¡Œï¼Œæœ€ç»ˆèšåˆ                                              â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 é€’å½’è¯æ˜å®ç° (Halo2 é£æ ¼)

```rust
use halo2_proofs::{
    circuit::{Layouter, SimpleFloorPlanner, Value},
    plonk::{Circuit, ConstraintSystem, Error, VerifyingKey},
    poly::commitment::Params,
};

/// é€’å½’éªŒè¯ç”µè·¯
/// åœ¨ç”µè·¯å†…éƒ¨éªŒè¯å¦ä¸€ä¸ª Halo2 è¯æ˜
struct RecursiveCircuit<F: PrimeField> {
    // è¦éªŒè¯çš„å†…éƒ¨è¯æ˜
    inner_proof: Option<Vec<u8>>,
    inner_instances: Option<Vec<Vec<F>>>,

    // æ–°çš„è®¡ç®—
    new_input: Value<F>,
    new_output: Value<F>,
}

impl<F: PrimeField> Circuit<F> for RecursiveCircuit<F> {
    type Config = RecursiveConfig;
    type FloorPlanner = SimpleFloorPlanner;

    fn configure(meta: &mut ConstraintSystem<F>) -> Self::Config {
        // é…ç½®éªŒè¯ç”µè·¯
        let advice = meta.advice_column();
        let instance = meta.instance_column();

        // éªŒè¯å™¨é…ç½®
        let verifier_config = VerifierChip::configure(meta);

        // æ–°è®¡ç®—é…ç½®
        let computation_config = ComputationChip::configure(meta);

        RecursiveConfig {
            verifier_config,
            computation_config,
            advice,
            instance,
        }
    }

    fn synthesize(
        &self,
        config: Self::Config,
        mut layouter: impl Layouter<F>,
    ) -> Result<(), Error> {
        // 1. éªŒè¯å†…éƒ¨è¯æ˜
        layouter.assign_region(
            || "verify inner proof",
            |mut region| {
                // åœ¨ç”µè·¯ä¸­æ‰§è¡ŒéªŒè¯
                // è¿™æ˜¯é€’å½’çš„æ ¸å¿ƒï¼šéªŒè¯é€»è¾‘è¢«ç¼–ç ä¸ºçº¦æŸ
                config.verifier_config.verify_proof(
                    &mut region,
                    self.inner_proof.as_ref(),
                    self.inner_instances.as_ref(),
                )?;
                Ok(())
            },
        )?;

        // 2. æ‰§è¡Œæ–°è®¡ç®—
        layouter.assign_region(
            || "new computation",
            |mut region| {
                let input = region.assign_advice(
                    || "input",
                    config.advice,
                    0,
                    || self.new_input,
                )?;

                // æ‰§è¡Œè®¡ç®—...
                let output = self.new_input.map(|x| x * x);
                region.assign_advice(
                    || "output",
                    config.advice,
                    1,
                    || output,
                )?;

                Ok(())
            },
        )
    }
}

/// å¢é‡å¯éªŒè¯è®¡ç®— (IVC) é“¾
struct IVCChain<F: PrimeField> {
    current_proof: Option<Vec<u8>>,
    current_state: F,
    step_count: usize,
}

impl<F: PrimeField> IVCChain<F> {
    pub fn new(initial_state: F) -> Self {
        Self {
            current_proof: None,
            current_state: initial_state,
            step_count: 0,
        }
    }

    /// æ‰§è¡Œä¸€æ­¥è®¡ç®—å¹¶ç”Ÿæˆæ–°è¯æ˜
    pub fn step<C: Circuit<F>>(&mut self, step_circuit: C) -> Result<(), Error> {
        // æ„å»ºé€’å½’ç”µè·¯
        let recursive_circuit = RecursiveCircuit {
            inner_proof: self.current_proof.clone(),
            inner_instances: None,
            new_input: Value::known(self.current_state),
            new_output: Value::unknown(),
        };

        // ç”Ÿæˆæ–°è¯æ˜
        let new_proof = create_proof(&recursive_circuit)?;

        self.current_proof = Some(new_proof);
        self.step_count += 1;

        Ok(())
    }

    /// éªŒè¯æœ€ç»ˆè¯æ˜
    pub fn verify(&self) -> Result<bool, Error> {
        if let Some(proof) = &self.current_proof {
            verify_proof(proof)
        } else {
            Ok(true)
        }
    }
}
```

### 6.5 gnark é€’å½’è¯æ˜

```go
package recursion

import (
	"github.com/consensys/gnark/backend/groth16"
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/std/algebra/emulated/sw_bn254"
	stdgroth16 "github.com/consensys/gnark/std/recursion/groth16"
)

// RecursiveCircuit é€’å½’éªŒè¯ç”µè·¯
type RecursiveCircuit struct {
	// è¦éªŒè¯çš„è¯æ˜ (BN254 æ›²çº¿ä¸Šçš„ Groth16)
	Proof        stdgroth16.Proof[sw_bn254.G1Affine, sw_bn254.G2Affine]
	VerifyingKey stdgroth16.VerifyingKey[sw_bn254.G1Affine, sw_bn254.G2Affine, sw_bn254.GTEl]
	InnerWitness stdgroth16.Witness[sw_bn254.ScalarField]

	// æ–°è®¡ç®—
	NewInput  frontend.Variable
	NewOutput frontend.Variable `gnark:",public"`
}

func (c *RecursiveCircuit) Define(api frontend.API) error {
	// 1. åˆ›å»ºéªŒè¯å™¨
	verifier, err := stdgroth16.NewVerifier[sw_bn254.ScalarField, sw_bn254.G1Affine, sw_bn254.G2Affine, sw_bn254.GTEl](api)
	if err != nil {
		return err
	}

	// 2. åœ¨ç”µè·¯ä¸­éªŒè¯å†…éƒ¨è¯æ˜
	err = verifier.AssertProof(c.VerifyingKey, c.Proof, c.InnerWitness)
	if err != nil {
		return err
	}

	// 3. æ‰§è¡Œæ–°è®¡ç®—
	result := api.Mul(c.NewInput, c.NewInput)
	api.AssertIsEqual(result, c.NewOutput)

	return nil
}

// AggregationCircuit è¯æ˜èšåˆç”µè·¯
type AggregationCircuit struct {
	Proofs       []stdgroth16.Proof[sw_bn254.G1Affine, sw_bn254.G2Affine]
	VerifyingKey stdgroth16.VerifyingKey[sw_bn254.G1Affine, sw_bn254.G2Affine, sw_bn254.GTEl]
	Witnesses    []stdgroth16.Witness[sw_bn254.ScalarField]

	AggregatedHash frontend.Variable `gnark:",public"`
}

func (c *AggregationCircuit) Define(api frontend.API) error {
	verifier, _ := stdgroth16.NewVerifier[sw_bn254.ScalarField, sw_bn254.G1Affine, sw_bn254.G2Affine, sw_bn254.GTEl](api)

	// éªŒè¯æ‰€æœ‰è¯æ˜
	for i := range c.Proofs {
		err := verifier.AssertProof(c.VerifyingKey, c.Proofs[i], c.Witnesses[i])
		if err != nil {
			return err
		}
	}

	// è®¡ç®—èšåˆå“ˆå¸Œ
	mimc, _ := mimc.NewMiMC(api)
	for _, w := range c.Witnesses {
		for _, pub := range w.Public {
			mimc.Write(pub)
		}
	}
	hash := mimc.Sum()
	api.AssertIsEqual(hash, c.AggregatedHash)

	return nil
}
```

### 6.6 zkRollup é€’å½’æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  zkRollup é€’å½’è¯æ˜æ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  äº¤æ˜“å±‚ (æ¯ç¬”äº¤æ˜“ä¸€ä¸ªè¯æ˜):                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ tx1 â”‚ â”‚ tx2 â”‚ â”‚ tx3 â”‚ â”‚ tx4 â”‚ â”‚ tx5 â”‚ â”‚ tx6 â”‚ â”‚ tx7 â”‚ â”‚ tx8 â”‚   â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜   â”‚
â”‚     â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚
â”‚     â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â”‚
â”‚         â”‚               â”‚               â”‚               â”‚           â”‚
â”‚         â–¼               â–¼               â–¼               â–¼           â”‚
â”‚  èšåˆå±‚ 1:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ agg_1_1 â”‚       â”‚ agg_1_2 â”‚       â”‚ agg_1_3 â”‚       â”‚ agg_1_4 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚                 â”‚                 â”‚                 â”‚       â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                â”‚                                   â”‚                â”‚
â”‚                â–¼                                   â–¼                â”‚
â”‚  èšåˆå±‚ 2:                                                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚         â”‚  agg_2_1  â”‚                       â”‚  agg_2_2  â”‚           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚
â”‚               â”‚                                   â”‚                 â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                             â”‚                                       â”‚
â”‚                             â–¼                                       â”‚
â”‚  æœ€ç»ˆè¯æ˜:                                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                    â”‚   Final Proof   â”‚                              â”‚
â”‚                    â”‚  (æäº¤åˆ° L1)     â”‚                              â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                     â”‚
â”‚  ä¼˜åŠ¿:                                                               â”‚
â”‚  â€¢ å¹¶è¡ŒåŒ–: æ¯å±‚å¯ä»¥å¹¶è¡Œç”Ÿæˆ                                          â”‚
â”‚  â€¢ å»¶è¿Ÿä½: ä¸éœ€è¦ç­‰å¾…æ‰€æœ‰äº¤æ˜“                                         â”‚
â”‚  â€¢ æˆæœ¬åˆ†æ‘Š: æ¯ç¬”äº¤æ˜“åˆ†æ‘ŠéªŒè¯æˆæœ¬ â‰ˆ O(1)                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šLookup Arguments

### 7.1 ä¸ºä»€ä¹ˆéœ€è¦ Lookupï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Lookup çš„åŠ¨æœº                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  é—®é¢˜: æŸäº›æ“ä½œç”¨ç®—æœ¯çº¦æŸå®ç°ä»£ä»·å¾ˆé«˜                                  â”‚
â”‚                                                                     â”‚
â”‚  ç¤ºä¾‹ 1: èŒƒå›´æ£€æŸ¥ (x < 256)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ç®—æœ¯æ–¹å¼:                                                   â”‚    â”‚
â”‚  â”‚  â€¢ å°† x åˆ†è§£ä¸º 8 ä¸ª bit: x = bâ‚€ + 2bâ‚ + 4bâ‚‚ + ... + 128bâ‚‡   â”‚    â”‚
â”‚  â”‚  â€¢ æ¯ä¸ª bit çº¦æŸ: báµ¢ * (1 - báµ¢) = 0                         â”‚    â”‚
â”‚  â”‚  â€¢ éœ€è¦ 8 ä¸ªçº¦æŸ + 8 ä¸ªå˜é‡                                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  Lookup æ–¹å¼:                                                â”‚    â”‚
â”‚  â”‚  â€¢ é¢„å®šä¹‰è¡¨ T = {0, 1, 2, ..., 255}                         â”‚    â”‚
â”‚  â”‚  â€¢ è¯æ˜ x âˆˆ T                                                â”‚    â”‚
â”‚  â”‚  â€¢ 1 ä¸ª lookupï¼Œå¼€é”€è¿œå°äºä½åˆ†è§£                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  ç¤ºä¾‹ 2: XOR æ“ä½œ (a âŠ• b = c)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ç®—æœ¯æ–¹å¼: éœ€è¦å®Œæ•´çš„ä½åˆ†è§£                                   â”‚    â”‚
â”‚  â”‚  â€¢ åˆ†è§£ a, b ä¸º bits                                        â”‚    â”‚
â”‚  â”‚  â€¢ å¯¹æ¯å¯¹ bit è®¡ç®— XOR                                       â”‚    â”‚
â”‚  â”‚  â€¢ é‡ç»„ç»“æœ                                                  â”‚    â”‚
â”‚  â”‚  â€¢ 256 ä½æ•°éœ€è¦ ~768 ä¸ªçº¦æŸ                                  â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  Lookup æ–¹å¼:                                                â”‚    â”‚
â”‚  â”‚  â€¢ é¢„å®šä¹‰ XOR è¡¨: {(a, b, aâŠ•b) | a,b âˆˆ [0,255]}             â”‚    â”‚
â”‚  â”‚  â€¢ æŸ¥è¡¨éªŒè¯                                                  â”‚    â”‚
â”‚  â”‚  â€¢ å¤§å¹…å‡å°‘çº¦æŸ                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  å¸¸è§ Lookup è¡¨:                                                     â”‚
â”‚  â€¢ èŒƒå›´è¡¨: {0, 1, ..., 2â¿-1}                                       â”‚
â”‚  â€¢ ä½è¿ç®—è¡¨: XOR, AND, OR                                           â”‚
â”‚  â€¢ SHA256 è½®å‡½æ•°è¡¨                                                  â”‚
â”‚  â€¢ æ¤­åœ†æ›²çº¿ç‚¹è¡¨ (ç”¨äºç­¾åéªŒè¯)                                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Plookup åè®®åŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Plookup æ ¸å¿ƒæ€æƒ³                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ç›®æ ‡: è¯æ˜å‘é‡ f çš„æ‰€æœ‰å…ƒç´ éƒ½åœ¨è¡¨ T ä¸­                               â”‚
â”‚                                                                     â”‚
â”‚  f = [fâ‚, fâ‚‚, ..., fâ‚™]  (æŸ¥è¯¢å‘é‡ï¼Œå¯æœ‰é‡å¤)                        â”‚
â”‚  T = [tâ‚, tâ‚‚, ..., tâ‚˜]  (è¡¨ï¼Œæ— é‡å¤)                                â”‚
â”‚                                                                     â”‚
â”‚  æ ¸å¿ƒè§‚å¯Ÿ: å¦‚æœ f âŠ† Tï¼Œé‚£ä¹ˆæ’åºåçš„ (f âˆª T) æœ‰ç‰¹æ®Šç»“æ„               â”‚
â”‚                                                                     â”‚
â”‚  ç¤ºä¾‹:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  T = [1, 2, 3, 4]                                           â”‚    â”‚
â”‚  â”‚  f = [2, 2, 4, 1]  (æŸ¥è¯¢ï¼Œæœ‰é‡å¤)                            â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  åˆå¹¶å¹¶æ’åº: s = sort(f âˆª T) = [1, 1, 2, 2, 2, 3, 4, 4]     â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  å…³é”®æ€§è´¨: ç›¸é‚»å…ƒç´ è¦ä¹ˆç›¸ç­‰ï¼Œè¦ä¹ˆå·®å€¼åœ¨ T çš„ç›¸é‚»å…ƒç´ ä¸­          â”‚    â”‚
â”‚  â”‚  s[i+1] - s[i] âˆˆ {0} âˆª {t[j+1] - t[j]}                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â”‚  åè®®æ­¥éª¤:                                                           â”‚
â”‚  1. Prover æ„é€ æ’åºåçš„å‘é‡ s                                        â”‚
â”‚  2. ä½¿ç”¨éšæœºæŒ‘æˆ˜ Î³ å‹ç¼©å¤šåˆ—ä¸ºå•åˆ—                                    â”‚
â”‚  3. ä½¿ç”¨ Grand Product Argument éªŒè¯æ’åºæ­£ç¡®æ€§                       â”‚
â”‚  4. éªŒè¯ç›¸é‚»å·®å€¼çº¦æŸ                                                 â”‚
â”‚                                                                     â”‚
â”‚  Grand Product (ç®€åŒ–):                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  éªŒè¯: âˆ(Î³ + fáµ¢) Â· âˆ(Î³ + tâ±¼) = âˆ(Î³ + sâ‚–)                    â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  ä½¿ç”¨å¤šé¡¹å¼:                                                 â”‚    â”‚
â”‚  â”‚  â€¢ F(X) = âˆ(X - fáµ¢)                                         â”‚    â”‚
â”‚  â”‚  â€¢ T(X) = âˆ(X - tâ±¼)                                         â”‚    â”‚
â”‚  â”‚  â€¢ S(X) = âˆ(X - sâ‚–)                                         â”‚    â”‚
â”‚  â”‚                                                             â”‚    â”‚
â”‚  â”‚  éªŒè¯: F(Î³) Â· T(Î³) = S(Î³)                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 Halo2 Lookup å®ç°

```rust
use halo2_proofs::{
    circuit::{Layouter, Value},
    plonk::{Advice, Column, ConstraintSystem, Error, Selector, TableColumn},
    poly::Rotation,
    pasta::Fp,
};

/// èŒƒå›´æ£€æŸ¥ç”µè·¯é…ç½® (ä½¿ç”¨ Lookup)
#[derive(Clone, Debug)]
struct RangeCheckConfig {
    value: Column<Advice>,
    range_table: TableColumn,
    selector: Selector,
}

impl RangeCheckConfig {
    fn configure(
        meta: &mut ConstraintSystem<Fp>,
        value: Column<Advice>,
    ) -> Self {
        let range_table = meta.lookup_table_column();
        let selector = meta.complex_selector();

        // å®šä¹‰ lookup: value å¿…é¡»åœ¨ range_table ä¸­
        meta.lookup("range check", |meta| {
            let s = meta.query_selector(selector);
            let v = meta.query_advice(value, Rotation::cur());

            // å½“ selector å¯ç”¨æ—¶ï¼Œv å¿…é¡»åœ¨è¡¨ä¸­
            vec![(s * v, range_table)]
        });

        Self {
            value,
            range_table,
            selector,
        }
    }

    /// åŠ è½½èŒƒå›´è¡¨ [0, 1, ..., 2^k - 1]
    fn load_table(
        &self,
        layouter: &mut impl Layouter<Fp>,
        k: usize,
    ) -> Result<(), Error> {
        layouter.assign_table(
            || "range table",
            |mut table| {
                for i in 0..(1 << k) {
                    table.assign_cell(
                        || format!("row {}", i),
                        self.range_table,
                        i,
                        || Value::known(Fp::from(i as u64)),
                    )?;
                }
                Ok(())
            },
        )
    }
}

/// XOR è¡¨ç”µè·¯é…ç½®
#[derive(Clone, Debug)]
struct XorTableConfig {
    input_a: Column<Advice>,
    input_b: Column<Advice>,
    output: Column<Advice>,

    table_a: TableColumn,
    table_b: TableColumn,
    table_xor: TableColumn,

    selector: Selector,
}

impl XorTableConfig {
    fn configure(meta: &mut ConstraintSystem<Fp>) -> Self {
        let input_a = meta.advice_column();
        let input_b = meta.advice_column();
        let output = meta.advice_column();

        let table_a = meta.lookup_table_column();
        let table_b = meta.lookup_table_column();
        let table_xor = meta.lookup_table_column();

        let selector = meta.complex_selector();

        // å¤šåˆ— lookup
        meta.lookup("xor lookup", |meta| {
            let s = meta.query_selector(selector);
            let a = meta.query_advice(input_a, Rotation::cur());
            let b = meta.query_advice(input_b, Rotation::cur());
            let c = meta.query_advice(output, Rotation::cur());

            vec![
                (s.clone() * a, table_a),
                (s.clone() * b, table_b),
                (s * c, table_xor),
            ]
        });

        Self {
            input_a, input_b, output,
            table_a, table_b, table_xor,
            selector,
        }
    }

    /// åŠ è½½ XOR è¡¨ (8-bit)
    fn load_xor_table(&self, layouter: &mut impl Layouter<Fp>) -> Result<(), Error> {
        layouter.assign_table(
            || "xor table",
            |mut table| {
                let mut row = 0;
                for a in 0u64..256 {
                    for b in 0u64..256 {
                        table.assign_cell(|| "a", self.table_a, row, || Value::known(Fp::from(a)))?;
                        table.assign_cell(|| "b", self.table_b, row, || Value::known(Fp::from(b)))?;
                        table.assign_cell(|| "xor", self.table_xor, row, || Value::known(Fp::from(a ^ b)))?;
                        row += 1;
                    }
                }
                Ok(())
            },
        )
    }
}
```

### 7.4 gnark Lookup å®ç°

```go
package lookup

import (
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/std/lookup/logderivlookup"
)

// RangeCheckCircuit ä½¿ç”¨ lookup çš„èŒƒå›´æ£€æŸ¥
type RangeCheckCircuit struct {
	Values []frontend.Variable
	Bits   int // èŒƒå›´ [0, 2^Bits)
}

func (c *RangeCheckCircuit) Define(api frontend.API) error {
	// åˆ›å»ºèŒƒå›´è¡¨
	rangeTable := make([]frontend.Variable, 1<<c.Bits)
	for i := range rangeTable {
		rangeTable[i] = i
	}

	// ä½¿ç”¨ log-derivative lookup
	t := logderivlookup.New(api)
	t.Insert(rangeTable)

	// æ£€æŸ¥æ‰€æœ‰å€¼éƒ½åœ¨è¡¨ä¸­
	for _, v := range c.Values {
		t.Lookup(v)
	}

	return nil
}

// XORCircuit ä½¿ç”¨ lookup çš„ XOR
type XORCircuit struct {
	A, B   frontend.Variable
	Result frontend.Variable `gnark:",public"`
}

func (c *XORCircuit) Define(api frontend.API) error {
	// æ„å»º XOR è¡¨
	xorTable := make([]frontend.Variable, 256*256)
	for a := 0; a < 256; a++ {
		for b := 0; b < 256; b++ {
			xorTable[a*256+b] = a ^ b
		}
	}

	t := logderivlookup.New(api)
	t.Insert(xorTable)

	// è®¡ç®—ç´¢å¼•å¹¶æŸ¥è¡¨
	index := api.Add(api.Mul(c.A, 256), c.B)
	result := t.Lookup(index)

	api.AssertIsEqual(result[0], c.Result)
	return nil
}
```

### 7.5 Lookup æ€§èƒ½å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Lookup vs ç®—æœ¯çº¦æŸæ€§èƒ½å¯¹æ¯”                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ“ä½œ                â”‚ ç®—æœ¯çº¦æŸæ•°    â”‚ Lookup å¼€é”€   â”‚ åŠ é€Ÿæ¯”        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  èŒƒå›´æ£€æŸ¥ (8-bit)    â”‚ ~16          â”‚ ~1           â”‚ 16x          â”‚
â”‚  èŒƒå›´æ£€æŸ¥ (16-bit)   â”‚ ~32          â”‚ ~2           â”‚ 16x          â”‚
â”‚  XOR (8-bit)        â”‚ ~24          â”‚ ~1           â”‚ 24x          â”‚
â”‚  XOR (256-bit)      â”‚ ~768         â”‚ ~32          â”‚ 24x          â”‚
â”‚  AND (8-bit)        â”‚ ~16          â”‚ ~1           â”‚ 16x          â”‚
â”‚  SHA256 round       â”‚ ~25000       â”‚ ~3000        â”‚ 8x           â”‚
â”‚  Keccak permutation â”‚ ~140000      â”‚ ~15000       â”‚ 9x           â”‚
â”‚  ECDSA éªŒè¯         â”‚ ~500000      â”‚ ~50000       â”‚ 10x          â”‚
â”‚                                                                     â”‚
â”‚  æœ€ä½³å®è·µ:                                                           â”‚
â”‚  â€¢ å¯¹äºé‡å¤ä½¿ç”¨çš„æ“ä½œï¼Œä½¿ç”¨ lookup                                   â”‚
â”‚  â€¢ è¡¨å¤§å°æ§åˆ¶åœ¨ 2^16 ~ 2^20                                         â”‚
â”‚  â€¢ åˆå¹¶ç›¸å…³çš„ lookup å‡å°‘å¼€é”€                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 8: PLONK åè®®æ·±åº¦è§£æ

### 8.1 PLONK æ¦‚è¿°

PLONK (Permutations over Lagrange-bases for Oecumenical Noninteractive arguments of Knowledge) æ˜¯ç›®å‰æœ€æµè¡Œçš„é€šç”¨é›¶çŸ¥è¯†è¯æ˜åè®®ä¹‹ä¸€ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PLONK æ ¸å¿ƒç‰¹æ€§                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   é€šç”¨ Setup    â”‚    â”‚   é«˜æ•ˆè¯æ˜      â”‚    â”‚   å°è¯æ˜å°ºå¯¸    â”‚ â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚ â”‚
â”‚  â”‚ ä¸€æ¬¡ setup     â”‚    â”‚ O(n log n)     â”‚    â”‚  ~400 bytes    â”‚ â”‚
â”‚  â”‚ æ”¯æŒä»»æ„ç”µè·¯   â”‚    â”‚ è¯æ˜æ—¶é—´        â”‚    â”‚  æ’å®šå¤§å°       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  PLONK vs å…¶ä»–åè®®:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç‰¹æ€§          â”‚ Groth16  â”‚ PLONK    â”‚ STARK    â”‚ Halo2        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Setup         â”‚ ç”µè·¯ç‰¹å®š â”‚ é€šç”¨     â”‚ é€æ˜     â”‚ é€šç”¨+é€æ˜    â”‚ â”‚
â”‚  â”‚ è¯æ˜å¤§å°      â”‚ ~200B    â”‚ ~400B    â”‚ ~50KB    â”‚ ~400B        â”‚ â”‚
â”‚  â”‚ éªŒè¯æ—¶é—´      â”‚ ~3ms     â”‚ ~5ms     â”‚ ~10ms    â”‚ ~5ms         â”‚ â”‚
â”‚  â”‚ å‡è®¾          â”‚ é…å¯¹     â”‚ é…å¯¹     â”‚ å“ˆå¸Œ     â”‚ æ¤­åœ†æ›²çº¿     â”‚ â”‚
â”‚  â”‚ åé‡å­å®‰å…¨    â”‚ å¦       â”‚ å¦       â”‚ æ˜¯       â”‚ å¦           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 PLONK çº¦æŸç³»ç»Ÿ

PLONK ä½¿ç”¨ä¸€ç§ç§°ä¸º "Plonkish" çš„ç®—æœ¯åŒ–æ–¹å¼:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PLONK é—¨çº¦æŸç»“æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ ‡å‡† PLONK é—¨æ–¹ç¨‹:                                                 â”‚
â”‚                                                                     â”‚
â”‚  q_L Â· a + q_R Â· b + q_O Â· c + q_M Â· (aÂ·b) + q_C = 0               â”‚
â”‚                                                                     â”‚
â”‚  å…¶ä¸­:                                                              â”‚
â”‚  â€¢ a, b: å·¦å³è¾“å…¥çº¿                                                 â”‚
â”‚  â€¢ c: è¾“å‡ºçº¿                                                        â”‚
â”‚  â€¢ q_L, q_R, q_O: çº¿æ€§é€‰æ‹©å™¨                                       â”‚
â”‚  â€¢ q_M: ä¹˜æ³•é€‰æ‹©å™¨                                                  â”‚
â”‚  â€¢ q_C: å¸¸æ•°                                                        â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        ç¤ºä¾‹: è®¡ç®— xÂ² + x + 5                                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  è¡Œ  â”‚  a   â”‚  b   â”‚  c   â”‚ q_L â”‚ q_R â”‚ q_O â”‚ q_M â”‚ q_C      â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚  0   â”‚  x   â”‚  x   â”‚ xÂ²   â”‚  0  â”‚  0  â”‚ -1  â”‚  1  â”‚  0       â”‚ â”‚
â”‚  â”‚      â”‚      â”‚      â”‚      â”‚      (x Â· x - xÂ² = 0)             â”‚ â”‚
â”‚  â”‚  1   â”‚  xÂ²  â”‚  x   â”‚  y   â”‚  1  â”‚  1  â”‚ -1  â”‚  0  â”‚  5       â”‚ â”‚
â”‚  â”‚      â”‚      â”‚      â”‚      â”‚  (xÂ² + x + 5 - y = 0)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 ç½®æ¢è®ºè¯ (Permutation Argument)

PLONK çš„æ ¸å¿ƒåˆ›æ–°æ˜¯ä½¿ç”¨ç½®æ¢è®ºè¯æ¥å®ç° wire ä¹‹é—´çš„è¿æ¥:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç½®æ¢è®ºè¯åŸç†                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  é—®é¢˜: è¯æ˜ä¸¤ä¸ªå¤šé¡¹å¼ f å’Œ g è¡¨ç¤ºåŒä¸€ä¸ªå¤šé‡é›†åˆçš„ç½®æ¢              â”‚
â”‚                                                                     â”‚
â”‚  åŸå§‹æ–¹æ³• (Grand Product Argument):                                 â”‚
â”‚                                                                     â”‚
â”‚  æ„é€ ç´¯ç§¯å¤šé¡¹å¼ Z(X):                                               â”‚
â”‚                                                                     â”‚
â”‚         âˆáµ¢ (f(Ï‰â±) + Î²Â·Ï‰â± + Î³)                                      â”‚
â”‚  Z(X) = â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚         âˆáµ¢ (g(Ï‰â±) + Î²Â·Ïƒ(Ï‰â±) + Î³)                                   â”‚
â”‚                                                                     â”‚
â”‚  å…¶ä¸­:                                                              â”‚
â”‚  â€¢ Ï‰: n æ¬¡å•ä½æ ¹                                                    â”‚
â”‚  â€¢ Î², Î³: éšæœºæŒ‘æˆ˜å€¼                                                 â”‚
â”‚  â€¢ Ïƒ: ç½®æ¢å¤šé¡¹å¼                                                    â”‚
â”‚                                                                     â”‚
â”‚  éªŒè¯æ¡ä»¶:                                                          â”‚
â”‚  1. Z(1) = 1  (è¾¹ç•Œæ¡ä»¶)                                           â”‚
â”‚  2. Z(Ï‰â¿) = 1 (å¾ªç¯æ¡ä»¶)                                           â”‚
â”‚  3. é€’æ¨å…³ç³»:                                                       â”‚
â”‚                                                                     â”‚
â”‚     Z(Ï‰X) Â· (g(X) + Î²Â·Ïƒ(X) + Î³) = Z(X) Â· (f(X) + Î²Â·X + Î³)         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    ç½®æ¢ç¤ºæ„å›¾                                  â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚    Wire A      Wire B      Wire C                             â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”       â”Œâ”€â”€â”€â”       â”Œâ”€â”€â”€â”                              â”‚ â”‚
â”‚  â”‚  0 â”‚ x â”‚ â†â”€â”€â”€â†’ â”‚ x â”‚ 0     â”‚xÂ² â”‚ 0                            â”‚ â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”¤   Ïƒ   â”œâ”€â”€â”€â”¤       â”œâ”€â”€â”€â”¤                              â”‚ â”‚
â”‚  â”‚  1 â”‚xÂ² â”‚ â†â”€â”€â”€â†’ â”‚ x â”‚ 1     â”‚ y â”‚ 1                            â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”˜       â””â”€â”€â”€â”˜       â””â”€â”€â”€â”˜                              â”‚ â”‚
â”‚  â”‚                                                                â”‚ â”‚
â”‚  â”‚  Ïƒ å®šä¹‰äº†å“ªäº›ä½ç½®åº”è¯¥ç›¸ç­‰                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.4 PLONK åè®®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PLONK è¯æ˜ç”Ÿæˆæµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Round 1: æ‰¿è¯º witness å¤šé¡¹å¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ æ„é€  a(X), b(X), c(X) æ’å€¼å¤šé¡¹å¼                         â”‚   â”‚
â”‚  â”‚  â€¢ è®¡ç®—æ‰¿è¯º [a]â‚, [b]â‚, [c]â‚                                â”‚   â”‚
â”‚  â”‚  â€¢ æ·»åŠ  blinding factors ä¿æŠ¤é›¶çŸ¥è¯†                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  Round 2: ç½®æ¢è®ºè¯ (æ”¶åˆ°æŒ‘æˆ˜ Î², Î³)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ è®¡ç®—ç´¯ç§¯å¤šé¡¹å¼ z(X)                                      â”‚   â”‚
â”‚  â”‚  â€¢ è®¡ç®—æ‰¿è¯º [z]â‚                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  Round 3: å•†å¤šé¡¹å¼ (æ”¶åˆ°æŒ‘æˆ˜ Î±)                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ æ„é€ å•†å¤šé¡¹å¼ t(X) = (é—¨çº¦æŸ + Î±Â·ç½®æ¢çº¦æŸ) / Zâ‚•(X)        â”‚   â”‚
â”‚  â”‚  â€¢ åˆ†å‰² t(X) = t_lo + X^n Â· t_mid + X^{2n} Â· t_hi          â”‚   â”‚
â”‚  â”‚  â€¢ è®¡ç®—æ‰¿è¯º [t_lo]â‚, [t_mid]â‚, [t_hi]â‚                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  Round 4: æ±‚å€¼ (æ”¶åˆ°æŒ‘æˆ˜ Î¶)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ è®¡ç®—æ±‚å€¼: Ä = a(Î¶), bÌ„ = b(Î¶), cÌ„ = c(Î¶), ...            â”‚   â”‚
â”‚  â”‚  â€¢ è®¡ç®— z(Ï‰Î¶) ç”¨äºç½®æ¢è®ºè¯                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  Round 5: å¼€æ”¾è¯æ˜ (æ”¶åˆ°æŒ‘æˆ˜ v)                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ æ„é€ çº¿æ€§åŒ–å¤šé¡¹å¼ r(X)                                    â”‚   â”‚
â”‚  â”‚  â€¢ è®¡ç®—å¼€æ”¾è¯æ˜ W_Î¶(X), W_{Ï‰Î¶}(X)                          â”‚   â”‚
â”‚  â”‚  â€¢ è¾“å‡ºè¯æ˜ Ï€ = ([a]â‚, [b]â‚, [c]â‚, [z]â‚, [t]â‚, W_Î¶, W_Ï‰Î¶)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.5 PLONK éªŒè¯ç®—æ³•

```go
// PLONK éªŒè¯å™¨ä¼ªä»£ç 
package plonk

import (
	"math/big"
)

type PlonkProof struct {
	// Round 1: witness æ‰¿è¯º
	A, B, C Point // [a]â‚, [b]â‚, [c]â‚

	// Round 2: ç´¯ç§¯å¤šé¡¹å¼æ‰¿è¯º
	Z Point // [z]â‚

	// Round 3: å•†å¤šé¡¹å¼æ‰¿è¯º
	Tlo, Tmid, Thi Point

	// Round 4: æ±‚å€¼
	AEval, BEval, CEval *big.Int // a(Î¶), b(Î¶), c(Î¶)
	S1Eval, S2Eval      *big.Int // Ïƒâ‚(Î¶), Ïƒâ‚‚(Î¶)
	ZEvalOmega          *big.Int // z(Ï‰Î¶)

	// Round 5: å¼€æ”¾è¯æ˜
	Wz, Wzomega Point // KZG å¼€æ”¾è¯æ˜
}

type PlonkVerifier struct {
	// é¢„å¤„ç† (æ¥è‡ª setup)
	Qm, Ql, Qr, Qo, Qc Point   // é€‰æ‹©å™¨æ‰¿è¯º
	S1, S2, S3         Point   // ç½®æ¢æ‰¿è¯º
	X2                 PointG2 // [x]â‚‚

	// å…¬å…±å‚æ•°
	N      int      // ç”µè·¯å¤§å°
	Omega  *big.Int // N æ¬¡å•ä½æ ¹
	K1, K2 *big.Int // coset ç”Ÿæˆå…ƒ
}

func (v *PlonkVerifier) Verify(proof *PlonkProof, publicInputs []*big.Int) bool {
	// Step 1: éªŒè¯å…¬å…±è¾“å…¥åœ¨åŸŸå†…
	for _, pi := range publicInputs {
		if !inField(pi) {
			return false
		}
	}

	// Step 2: é‡æ–°è®¡ç®—æŒ‘æˆ˜å€¼ (Fiat-Shamir)
	beta, gamma := computeChallenge1(proof.A, proof.B, proof.C)
	alpha := computeChallenge2(proof.Z)
	zeta := computeChallenge3(proof.Tlo, proof.Tmid, proof.Thi)
	nu := computeChallenge4(proof.AEval, proof.BEval, proof.CEval)
	mu := computeChallenge5(proof.Wz, proof.Wzomega)

	// Step 3: è®¡ç®—æ¶ˆå¤±å¤šé¡¹å¼åœ¨ Î¶ å¤„çš„å€¼
	zhZeta := computeZH(zeta, v.N) // Î¶^n - 1

	// Step 4: è®¡ç®—æ‹‰æ ¼æœ—æ—¥å¤šé¡¹å¼ Lâ‚(Î¶)
	l1Zeta := computeL1(zeta, v.N, v.Omega)

	// Step 5: è®¡ç®—å…¬å…±è¾“å…¥å¤šé¡¹å¼ PI(Î¶)
	piZeta := evaluatePI(publicInputs, zeta, v.N)

	// Step 6: éªŒè¯é—¨çº¦æŸ
	// r = aÂ·bÂ·qm + aÂ·ql + bÂ·qr + cÂ·qo + qc + PI(Î¶)
	//   + Î±Â·[(a + Î²Â·Î¶ + Î³)(b + Î²Â·kâ‚Â·Î¶ + Î³)(c + Î²Â·kâ‚‚Â·Î¶ + Î³)Â·z
	//       - (a + Î²Â·Ïƒâ‚(Î¶) + Î³)(b + Î²Â·Ïƒâ‚‚(Î¶) + Î³)Â·Î²Â·Ïƒâ‚ƒ(X)Â·z(Ï‰Î¶)]
	//   + Î±Â²Â·(z - 1)Â·Lâ‚(Î¶)

	// Step 7: é…å¯¹æ£€æŸ¥
	// e(W_Î¶ + Î¼Â·W_{Ï‰Î¶}, [x]â‚‚) = e(Î¶Â·W_Î¶ + Î¼Â·Ï‰Â·Î¶Â·W_{Ï‰Î¶} + F - E, [1]â‚‚)

	return verifyPairing(proof, v, zeta, mu, zhZeta)
}

// è®¡ç®—æ¶ˆå¤±å¤šé¡¹å¼ Z_H(X) = X^n - 1
func computeZH(zeta *big.Int, n int) *big.Int {
	result := new(big.Int).Exp(zeta, big.NewInt(int64(n)), fieldOrder)
	result.Sub(result, big.NewInt(1))
	return result.Mod(result, fieldOrder)
}

// è®¡ç®—ç¬¬ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥åŸºå¤šé¡¹å¼ L_1(Î¶) = (Î¶^n - 1) / (n Â· (Î¶ - 1))
func computeL1(zeta *big.Int, n int, omega *big.Int) *big.Int {
	// L_1(Î¶) = (Î¶^n - 1) / (n Â· (Î¶ - 1))
	numerator := computeZH(zeta, n)

	zetaMinusOne := new(big.Int).Sub(zeta, big.NewInt(1))
	denominator := new(big.Int).Mul(big.NewInt(int64(n)), zetaMinusOne)

	return new(big.Int).Div(numerator, denominator)
}
```

### 8.6 Custom Gates æ‰©å±•

Plonkish ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰é—¨æ¥ä¼˜åŒ–ç‰¹å®šæ“ä½œ:

```rust
// Halo2 è‡ªå®šä¹‰é—¨å®ç°
use halo2_proofs::{
    circuit::{Layouter, SimpleFloorPlanner, Value},
    plonk::{Advice, Column, ConstraintSystem, Error, Expression, Selector},
    poly::Rotation,
};

/// è‡ªå®šä¹‰ Poseidon è½®å‡½æ•°é—¨
struct PoseidonConfig {
    state: [Column<Advice>; 3],
    round_constants: [Column<Advice>; 3],
    s_full: Selector,    // å®Œæ•´è½®é€‰æ‹©å™¨
    s_partial: Selector, // éƒ¨åˆ†è½®é€‰æ‹©å™¨
}

impl PoseidonConfig {
    fn configure(meta: &mut ConstraintSystem<Fr>) -> Self {
        let state = [
            meta.advice_column(),
            meta.advice_column(),
            meta.advice_column(),
        ];
        let round_constants = [
            meta.advice_column(),
            meta.advice_column(),
            meta.advice_column(),
        ];
        let s_full = meta.selector();
        let s_partial = meta.selector();

        // å®Œæ•´è½®é—¨: state' = MDS Â· (state + rc)^5
        meta.create_gate("full round", |meta| {
            let s = meta.query_selector(s_full);

            let state_cur: Vec<_> = state.iter()
                .map(|c| meta.query_advice(*c, Rotation::cur()))
                .collect();
            let state_next: Vec<_> = state.iter()
                .map(|c| meta.query_advice(*c, Rotation::next()))
                .collect();
            let rc: Vec<_> = round_constants.iter()
                .map(|c| meta.query_advice(*c, Rotation::cur()))
                .collect();

            // S-box: x^5
            let sbox = |x: Expression<Fr>| {
                let x2 = x.clone() * x.clone();
                let x4 = x2.clone() * x2.clone();
                x4 * x
            };

            // åº”ç”¨ S-box
            let after_sbox: Vec<_> = state_cur.iter()
                .zip(rc.iter())
                .map(|(s, r)| sbox(s.clone() + r.clone()))
                .collect();

            // MDS çŸ©é˜µä¹˜æ³•
            let mds = get_mds_matrix();
            let after_mds = mds_multiply(&mds, &after_sbox);

            // çº¦æŸ: state_next = MDS Â· sbox(state + rc)
            (0..3).map(|i| {
                s.clone() * (state_next[i].clone() - after_mds[i].clone())
            }).collect::<Vec<_>>()
        });

        // éƒ¨åˆ†è½®é—¨: åªå¯¹ç¬¬ä¸€ä¸ªå…ƒç´ åº”ç”¨ S-box
        meta.create_gate("partial round", |meta| {
            let s = meta.query_selector(s_partial);

            let state_cur: Vec<_> = state.iter()
                .map(|c| meta.query_advice(*c, Rotation::cur()))
                .collect();
            let state_next: Vec<_> = state.iter()
                .map(|c| meta.query_advice(*c, Rotation::next()))
                .collect();
            let rc: Vec<_> = round_constants.iter()
                .map(|c| meta.query_advice(*c, Rotation::cur()))
                .collect();

            let sbox = |x: Expression<Fr>| {
                let x2 = x.clone() * x.clone();
                let x4 = x2.clone() * x2.clone();
                x4 * x
            };

            // åªå¯¹ç¬¬ä¸€ä¸ªå…ƒç´ åº”ç”¨ sbox
            let mut after_sbox = vec![sbox(state_cur[0].clone() + rc[0].clone())];
            for i in 1..3 {
                after_sbox.push(state_cur[i].clone() + rc[i].clone());
            }

            let mds = get_mds_matrix();
            let after_mds = mds_multiply(&mds, &after_sbox);

            (0..3).map(|i| {
                s.clone() * (state_next[i].clone() - after_mds[i].clone())
            }).collect::<Vec<_>>()
        });

        Self {
            state,
            round_constants,
            s_full,
            s_partial,
        }
    }
}
```

### 8.7 PLONK ä¼˜åŒ–æŠ€æœ¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PLONK æ€§èƒ½ä¼˜åŒ–ç­–ç•¥                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. FFT ä¼˜åŒ–                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ä½¿ç”¨ 4-step FFT å‡å°‘å†…å­˜è®¿é—®                             â”‚   â”‚
â”‚  â”‚  â€¢ SIMD å¹¶è¡ŒåŒ–è¶å½¢è¿ç®—                                      â”‚   â”‚
â”‚  â”‚  â€¢ ç¼“å­˜å‹å¥½çš„æ•°æ®å¸ƒå±€                                       â”‚   â”‚
â”‚  â”‚  â€¢ GPU åŠ é€Ÿçš„ NTT å®ç°                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  2. å¤šæ ‡é‡ä¹˜æ³• (MSM) ä¼˜åŒ–                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Pippenger ç®—æ³•: O(n/log n) ç‚¹åŠ æ³•                        â”‚   â”‚
â”‚  â”‚  â€¢ é¢„è®¡ç®—çª—å£æ³•                                             â”‚   â”‚
â”‚  â”‚  â€¢ æ‰¹é‡ä»¿å°„åæ ‡è½¬æ¢                                         â”‚   â”‚
â”‚  â”‚  â€¢ GPU å¹¶è¡Œ MSM                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  3. å¤šé¡¹å¼æ‰¿è¯ºä¼˜åŒ–                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ æ‰¹é‡å¼€æ”¾: å¤šä¸ªç‚¹ä¸€ä¸ªè¯æ˜                                 â”‚   â”‚
â”‚  â”‚  â€¢ Lagrange åŸºç›´æ¥æ‰¿è¯º                                      â”‚   â”‚
â”‚  â”‚  â€¢ é¢„è®¡ç®—çš„éªŒè¯å¯†é’¥                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  4. è¯æ˜èšåˆ                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ åŒç”µè·¯æ‰¹å¤„ç†éªŒè¯                                         â”‚   â”‚
â”‚  â”‚  â€¢ è·¨ç”µè·¯é€’å½’èšåˆ                                           â”‚   â”‚
â”‚  â”‚  â€¢ æ¦‚ç‡æ€§æ‰¹é‡éªŒè¯                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½åŸºå‡† (2^20 çº¦æŸ):                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ“ä½œ             â”‚ CPU (å•æ ¸) â”‚ CPU (å¤šæ ¸) â”‚ GPU           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ è¯æ˜ç”Ÿæˆ         â”‚ 60s        â”‚ 15s        â”‚ 3s            â”‚  â”‚
â”‚  â”‚ éªŒè¯             â”‚ 5ms        â”‚ 5ms        â”‚ 5ms           â”‚  â”‚
â”‚  â”‚ FFT (2^20)       â”‚ 2s         â”‚ 0.5s       â”‚ 0.1s          â”‚  â”‚
â”‚  â”‚ MSM (2^20)       â”‚ 10s        â”‚ 3s         â”‚ 0.5s          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.8 gnark PLONK å®ç°

```go
package main

import (
	"github.com/consensys/gnark-crypto/ecc"
	"github.com/consensys/gnark/backend/plonk"
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/frontend/cs/scs"
	"github.com/consensys/gnark/test"
)

// å¤æ‚ç”µè·¯ç¤ºä¾‹: Merkle æ ‘éªŒè¯
type MerkleCircuit struct {
	// å…¬å…±è¾“å…¥
	Root frontend.Variable `gnark:",public"`
	Leaf frontend.Variable `gnark:",public"`

	// ç§æœ‰è¾“å…¥
	Path     [32]frontend.Variable // Merkle è·¯å¾„
	PathBits [32]frontend.Variable // è·¯å¾„æ–¹å‘ (0=å·¦, 1=å³)
}

func (c *MerkleCircuit) Define(api frontend.API) error {
	// ä½¿ç”¨ MiMC å“ˆå¸Œ
	mimc, _ := mimc.NewMiMC(api)

	current := c.Leaf

	for i := 0; i < 32; i++ {
		// æ ¹æ®è·¯å¾„æ–¹å‘é€‰æ‹©å·¦å³
		left := api.Select(c.PathBits[i], c.Path[i], current)
		right := api.Select(c.PathBits[i], current, c.Path[i])

		// è®¡ç®—å“ˆå¸Œ
		mimc.Reset()
		mimc.Write(left, right)
		current = mimc.Sum()
	}

	// éªŒè¯è®¡ç®—å‡ºçš„æ ¹ä¸ç»™å®šæ ¹åŒ¹é…
	api.AssertIsEqual(current, c.Root)

	return nil
}

func main() {
	// ç¼–è¯‘ç”µè·¯
	var circuit MerkleCircuit
	ccs, _ := frontend.Compile(ecc.BN254.ScalarField(), scs.NewBuilder, &circuit)

	// è®¾ç½®
	srs, _ := test.NewKZGSRS(ccs)
	pk, vk, _ := plonk.Setup(ccs, srs)

	// å‡†å¤‡ witness
	assignment := &MerkleCircuit{
		Root: "12345...", // å®é™…æ ¹å€¼
		Leaf: "67890...", // å¶å­å€¼
		// ... å¡«å……è·¯å¾„
	}

	witness, _ := frontend.NewWitness(assignment, ecc.BN254.ScalarField())
	publicWitness, _ := witness.Public()

	// ç”Ÿæˆè¯æ˜
	proof, _ := plonk.Prove(ccs, pk, witness)

	// éªŒè¯
	err := plonk.Verify(proof, vk, publicWitness)
	if err != nil {
		panic("verification failed")
	}
}
```

---

## Part 9: FRI åè®®è¯¦è§£

### 9.1 FRI æ¦‚è¿°

FRI (Fast Reed-Solomon Interactive Oracle Proof of Proximity) æ˜¯ STARK çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºè¯æ˜å¤šé¡¹å¼çš„ä½åº¦æ€§è´¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRI æ ¸å¿ƒç‰¹æ€§                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ç›®æ ‡: è¯æ˜å‡½æ•° f: D â†’ F æ¥è¿‘æŸä¸ªä½åº¦å¤šé¡¹å¼                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   é€æ˜ Setup    â”‚    â”‚   åé‡å­å®‰å…¨    â”‚    â”‚   å¿«é€ŸéªŒè¯      â”‚ â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚ â”‚
â”‚  â”‚ æ— éœ€å¯ä¿¡è®¾ç½®   â”‚    â”‚ ä»…åŸºäºå“ˆå¸Œ     â”‚    â”‚ O(logÂ² n)      â”‚ â”‚
â”‚  â”‚ ä»…ä½¿ç”¨å“ˆå¸Œ    â”‚    â”‚ æŠ—é‡å­æ”»å‡»     â”‚    â”‚ éªŒè¯æ—¶é—´        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  FRI åœ¨ ZK ç³»ç»Ÿä¸­çš„ä½ç½®:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  STARK = AIR (ç®—æœ¯åŒ–) + FRI (ä½åº¦æµ‹è¯•) + Merkle (æ‰¿è¯º)       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚    AIR      â”‚ â†’  â”‚    FRI      â”‚ â†’  â”‚   Merkle    â”‚       â”‚ â”‚
â”‚  â”‚  â”‚ çº¦æŸç³»ç»Ÿ    â”‚    â”‚ ä½åº¦è¯æ˜    â”‚    â”‚ å“ˆå¸Œæ‰¿è¯º    â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Reed-Solomon ç ä¸ä½åº¦æµ‹è¯•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Reed-Solomon ç åŸºç¡€                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å®šä¹‰: RS[F, D, k] = { (f(xâ‚), ..., f(xâ‚™)) : deg(f) < k }          â”‚
â”‚                                                                     â”‚
â”‚  å…¶ä¸­:                                                              â”‚
â”‚  â€¢ F: æœ‰é™åŸŸ                                                        â”‚
â”‚  â€¢ D = {xâ‚, ..., xâ‚™} âŠ‚ F: æ±‚å€¼åŸŸ                                   â”‚
â”‚  â€¢ k: æœ€å¤§åº¦æ•°                                                      â”‚
â”‚                                                                     â”‚
â”‚  Reed-Solomon ç çš„æ€§è´¨:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ç ç‡ Ï = k/n        (ä¿¡æ¯ä½/ç é•¿)                            â”‚ â”‚
â”‚  â”‚  æœ€å°è·ç¦» d = n - k + 1  (æ±‰æ˜è·ç¦»)                           â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  ä¾‹: n=8, k=2 (çº¿æ€§å¤šé¡¹å¼)                              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  å¤šé¡¹å¼ f(x) = ax + b                                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  ç å­—: (f(0), f(1), f(2), ..., f(7))                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  ä»»æ„ 2 ç‚¹å¯å”¯ä¸€ç¡®å®š f â†’ æœ€å°è·ç¦» = 7                  â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  ä½åº¦æµ‹è¯•é—®é¢˜:                                                      â”‚
â”‚  ç»™å®šå‡½æ•° f: D â†’ Fï¼ŒéªŒè¯ f æ˜¯å¦æ¥è¿‘åº¦æ•° < k çš„å¤šé¡¹å¼               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 FRI åè®®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       FRI æŠ˜å è¿‡ç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ ¸å¿ƒæ€æƒ³: é€æ­¥å°†åº¦æ•°å‡åŠï¼Œç›´åˆ°å˜æˆå¸¸æ•°                             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  åˆå§‹: fâ‚€(x), deg < d, åŸŸå¤§å° n                              â”‚ â”‚
â”‚  â”‚    â†“                                                          â”‚ â”‚
â”‚  â”‚  ç¬¬1è½®: fâ‚(x), deg < d/2, åŸŸå¤§å° n/2                         â”‚ â”‚
â”‚  â”‚    â†“                                                          â”‚ â”‚
â”‚  â”‚  ç¬¬2è½®: fâ‚‚(x), deg < d/4, åŸŸå¤§å° n/4                         â”‚ â”‚
â”‚  â”‚    â†“                                                          â”‚ â”‚
â”‚  â”‚   ...                                                         â”‚ â”‚
â”‚  â”‚    â†“                                                          â”‚ â”‚
â”‚  â”‚  æœ€ç»ˆ: fâ‚– = å¸¸æ•°                                              â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  æŠ˜å æ“ä½œ (ä»¥å› å­ 2 ä¸ºä¾‹):                                          â”‚
â”‚                                                                     â”‚
â”‚  ç»™å®š f(x) = f_even(xÂ²) + x Â· f_odd(xÂ²)                            â”‚
â”‚                                                                     â”‚
â”‚  å®šä¹‰ f'(y) = f_even(y) + Î± Â· f_odd(y)    (Î± æ˜¯éšæœºæŒ‘æˆ˜)           â”‚
â”‚                                                                     â”‚
â”‚  æ€§è´¨: deg(f') = deg(f)/2                                          â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚               FRI æŠ˜å å›¾ç¤º                                    â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  åŸŸ Dâ‚€ (å¤§å° n):     xâ‚€  xâ‚  xâ‚‚  xâ‚ƒ  xâ‚„  xâ‚…  xâ‚†  xâ‚‡         â”‚ â”‚
â”‚  â”‚                       â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚          â”‚ â”‚
â”‚  â”‚                       â””â”¬â”€â”€â”˜   â””â”¬â”€â”€â”˜   â””â”¬â”€â”€â”˜   â””â”¬â”€â”€â”˜          â”‚ â”‚
â”‚  â”‚  æ˜ å°„ x â†’ xÂ²          â”‚       â”‚       â”‚       â”‚              â”‚ â”‚
â”‚  â”‚                       â†“       â†“       â†“       â†“              â”‚ â”‚
â”‚  â”‚  åŸŸ Dâ‚ (å¤§å° n/2):   yâ‚€      yâ‚      yâ‚‚      yâ‚ƒ              â”‚ â”‚
â”‚  â”‚                       â”‚       â”‚       â”‚       â”‚              â”‚ â”‚
â”‚  â”‚                       â””â”€â”€â”€â”¬â”€â”€â”€â”˜       â””â”€â”€â”€â”¬â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â”‚                           â”‚               â”‚                  â”‚ â”‚
â”‚  â”‚                           â†“               â†“                  â”‚ â”‚
â”‚  â”‚  åŸŸ Dâ‚‚ (å¤§å° n/4):       zâ‚€              zâ‚                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 FRI æ‰¿è¯ºé˜¶æ®µ

```go
// FRI æ‰¿è¯ºå®ç°
package fri

import (
	"crypto/sha256"
	"math/big"
)

type FRICommitment struct {
	Layers      [][]FieldElement // æ¯ä¸€å±‚çš„æ±‚å€¼
	MerkleTrees []*MerkleTree    // æ¯ä¸€å±‚çš„ Merkle æ‰¿è¯º
	FinalValue  FieldElement     // æœ€ç»ˆå¸¸æ•°å€¼
}

type FRIParams struct {
	BlowupFactor int            // æ‰©å±•å› å­ (é€šå¸¸ 4-16)
	NumQueries   int            // æŸ¥è¯¢æ•°é‡
	MaxDegree    int            // æœ€å¤§åº¦æ•°
	Domain       []FieldElement // æ±‚å€¼åŸŸ
}

// æ‰¿è¯ºé˜¶æ®µ
func (p *FRIParams) Commit(polynomial []FieldElement) (*FRICommitment, []FieldElement) {
	commitment := &FRICommitment{
		Layers:      make([][]FieldElement, 0),
		MerkleTrees: make([]*MerkleTree, 0),
	}

	// å½“å‰å¤šé¡¹å¼æ±‚å€¼
	currentEvals := p.evaluateOnDomain(polynomial)
	challenges := make([]FieldElement, 0)

	// è¿­ä»£æŠ˜å ç›´åˆ°åº¦æ•°ä¸ºå¸¸æ•°
	for len(currentEvals) > p.BlowupFactor {
		// æ‰¿è¯ºå½“å‰å±‚
		commitment.Layers = append(commitment.Layers, currentEvals)
		tree := NewMerkleTree(currentEvals)
		commitment.MerkleTrees = append(commitment.MerkleTrees, tree)

		// ç”ŸæˆéšæœºæŒ‘æˆ˜ (Fiat-Shamir)
		alpha := p.generateChallenge(tree.Root())
		challenges = append(challenges, alpha)

		// æŠ˜å 
		currentEvals = p.foldLayer(currentEvals, alpha)
	}

	// å­˜å‚¨æœ€ç»ˆå¸¸æ•°
	commitment.FinalValue = currentEvals[0]

	return commitment, challenges
}

// æŠ˜å å•å±‚
func (p *FRIParams) foldLayer(evals []FieldElement, alpha FieldElement) []FieldElement {
	n := len(evals) / 2
	folded := make([]FieldElement, n)

	for i := 0; i < n; i++ {
		// f(x) å’Œ f(-x) çš„å€¼
		fx := evals[i]
		fMinusX := evals[n+i]

		// f_even = (f(x) + f(-x)) / 2
		// f_odd = (f(x) - f(-x)) / (2x)
		fEven := fx.Add(fMinusX).Mul(InverseOf2)
		fOdd := fx.Sub(fMinusX).Mul(InverseOf2).Mul(p.Domain[i].Inverse())

		// æŠ˜å : f'(xÂ²) = f_even + Î± Â· f_odd
		folded[i] = fEven.Add(alpha.Mul(fOdd))
	}

	return folded
}

// åœ¨åŸŸä¸Šæ±‚å€¼
func (p *FRIParams) evaluateOnDomain(poly []FieldElement) []FieldElement {
	// ä½¿ç”¨ FFT è¿›è¡Œå¿«é€Ÿæ±‚å€¼
	return FFT(poly, p.Domain)
}

// Fiat-Shamir ç”ŸæˆæŒ‘æˆ˜
func (p *FRIParams) generateChallenge(merkleRoot []byte) FieldElement {
	hash := sha256.Sum256(merkleRoot)
	return FieldElementFromBytes(hash[:])
}
```

### 9.5 FRI æŸ¥è¯¢é˜¶æ®µ

```go
// FRI æŸ¥è¯¢å’ŒéªŒè¯
type FRIQuery struct {
Index       int
Values      []FieldElement // æ¯å±‚çš„æŸ¥è¯¢å€¼
AuthPaths   [][]*MerkleProof // Merkle è®¤è¯è·¯å¾„
}

// ç”ŸæˆæŸ¥è¯¢è¯æ˜
func (c *FRICommitment) GenerateQueries(
params *FRIParams,
challenges []FieldElement,
) []FRIQuery {
queries := make([]FRIQuery, params.NumQueries)

for q := 0; q < params.NumQueries; q++ {
// éšæœºé€‰æ‹©æŸ¥è¯¢ç´¢å¼•
index := params.sampleIndex(q, len(c.Layers[0]))

query := FRIQuery{
Index:     index,
Values:    make([]FieldElement, len(c.Layers)),
AuthPaths: make([][]*MerkleProof, len(c.Layers)),
}

currentIndex := index
for layer := 0; layer < len(c.Layers); layer++ {
// è·å–æŸ¥è¯¢ç‚¹å’Œå…¶"å…„å¼Ÿ"ç‚¹
layerSize := len(c.Layers[layer])
siblingIndex := (currentIndex + layerSize/2) % layerSize

// è®°å½•å€¼
query.Values[layer] = c.Layers[layer][currentIndex]

// ç”Ÿæˆ Merkle è¯æ˜
query.AuthPaths[layer] = append(query.AuthPaths[layer],
c.MerkleTrees[layer].GetProof(currentIndex),
c.MerkleTrees[layer].GetProof(siblingIndex),
)

// æ›´æ–°ç´¢å¼• (æŠ˜å åçš„ç´¢å¼•)
currentIndex = currentIndex % (layerSize / 2)
}

queries[q] = query
}

return queries
}

// éªŒè¯ FRI è¯æ˜
func VerifyFRI(
params *FRIParams,
commitment *FRICommitment,
challenges []FieldElement,
queries []FRIQuery,
) bool {

for _, query := range queries {
currentIndex := query.Index

for layer := 0; layer < len(commitment.MerkleTrees); layer++ {
layerSize := len(commitment.Layers[layer])
siblingIndex := (currentIndex + layerSize/2) % layerSize

// éªŒè¯ Merkle è¯æ˜
if !commitment.MerkleTrees[layer].Verify(
query.AuthPaths[layer][0],
currentIndex,
) {
return false
}

// è·å– f(x) å’Œ f(-x)
fx := query.Values[layer]
fMinusX := commitment.Layers[layer][siblingIndex]

// è®¡ç®—æŠ˜å å€¼
alpha := challenges[layer]
fEven := fx.Add(fMinusX).Mul(InverseOf2)
fOdd := fx.Sub(fMinusX).Mul(InverseOf2).Mul(
params.Domain[currentIndex].Inverse(),
)
expectedNext := fEven.Add(alpha.Mul(fOdd))

// éªŒè¯ä¸‹ä¸€å±‚çš„å€¼
if layer < len(commitment.MerkleTrees)-1 {
nextIndex := currentIndex % (layerSize / 2)
if !query.Values[layer+1].Equal(expectedNext) {
return false
}
currentIndex = nextIndex
} else {
// æœ€åä¸€å±‚,æ£€æŸ¥å¸¸æ•°
if !expectedNext.Equal(commitment.FinalValue) {
return false
}
}
}
}

return true
}
```

### 9.6 FRI å®‰å…¨æ€§åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRI å®‰å…¨æ€§å‚æ•°                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å®‰å…¨çº§åˆ«è®¡ç®—:                                                      â”‚
â”‚                                                                     â”‚
â”‚  ç»™å®š:                                                              â”‚
â”‚  â€¢ Ï = k/n: ç ç‡ (é€šå¸¸ 1/4 åˆ° 1/16)                                â”‚
â”‚  â€¢ t: æŸ¥è¯¢æ•°é‡                                                      â”‚
â”‚  â€¢ Î»: å®‰å…¨å‚æ•° (é€šå¸¸ 128 bit)                                      â”‚
â”‚                                                                     â”‚
â”‚  å®‰å…¨è¯¯å·® Îµ â‰¤ (1 - Î´)^t                                            â”‚
â”‚                                                                     â”‚
â”‚  å…¶ä¸­ Î´ = 1 - âˆšÏ (å”¯ä¸€è§£ç åŠå¾„)                                    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              å‚æ•°é€‰æ‹©ç¤ºä¾‹                                      â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  ç ç‡ Ï    â”‚ Î´          â”‚ 128-bit æ‰€éœ€æŸ¥è¯¢æ•°                 â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚  â”‚  1/4       â”‚ 0.5        â”‚ ~185 æ¬¡                             â”‚ â”‚
â”‚  â”‚  1/8       â”‚ 0.646      â”‚ ~127 æ¬¡                             â”‚ â”‚
â”‚  â”‚  1/16      â”‚ 0.75       â”‚ ~92 æ¬¡                              â”‚ â”‚
â”‚  â”‚  1/32      â”‚ 0.823      â”‚ ~70 æ¬¡                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  è¯æ˜å¤§å°:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  è¯æ˜å¤§å° â‰ˆ t Ã— log(n) Ã— 32 bytes (Merkle è·¯å¾„)              â”‚ â”‚
â”‚  â”‚                 Ã— log(d)          (æŠ˜å å±‚æ•°)                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ä¾‹: n = 2Â²â°, d = 2Â¹â¶, t = 100                               â”‚ â”‚
â”‚  â”‚  è¯æ˜å¤§å° â‰ˆ 100 Ã— 20 Ã— 16 Ã— 32 â‰ˆ 1 MB                        â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  ä¼˜åŒ–æŠ€æœ¯:                                                          â”‚
â”‚  â€¢ Grinding: å¢åŠ å·¥ä½œé‡è¯æ˜å‡å°‘æŸ¥è¯¢æ•°                              â”‚
â”‚  â€¢ æ‰¹å¤„ç†: å¤šä¸ªå¤šé¡¹å¼å…±äº« Merkle æ ‘                                â”‚
â”‚  â€¢ DEEP-FRI: åœ¨å•ç‚¹è¿›è¡Œæ·±åº¦æµ‹è¯•                                    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.7 DEEP-FRI ä¼˜åŒ–

```go
// DEEP-FRI: æ›´é«˜æ•ˆçš„ FRI å˜ä½“
type DEEPFRIProof struct {
// æ ‡å‡† FRI æ‰¿è¯º
FRICommitment *FRICommitment

// DEEP ç»„åˆ
DeepPoint     FieldElement // åŸŸå¤–éšæœºç‚¹ z
DeepValues    []FieldElement // åœ¨ z ç‚¹çš„æ±‚å€¼
QuotientProof *FRICommitment // å•†å¤šé¡¹å¼è¯æ˜
}

// DEEP-FRI å…³é”®æ€æƒ³:
// ä¸ç›´æ¥è¯æ˜ f(x) æ˜¯ä½åº¦å¤šé¡¹å¼
// è€Œæ˜¯è¯æ˜ (f(x) - f(z)) / (x - z) æ˜¯ä½åº¦å¤šé¡¹å¼
// å…¶ä¸­ z æ˜¯åŸŸå¤–çš„éšæœºç‚¹

func DEEPFRIProve(
params *FRIParams,
f []FieldElement, // å¤šé¡¹å¼ç³»æ•°
constraint func ([]FieldElement) FieldElement, // çº¦æŸ
) *DEEPFRIProof {

// Step 1: æ‰¿è¯ºåŸå§‹å¤šé¡¹å¼
fCommit, _ := params.Commit(f)

// Step 2: æ”¶åˆ°éšæœºç‚¹ z (Fiat-Shamir)
z := params.generateChallenge(fCommit.MerkleTrees[0].Root())

// Step 3: è®¡ç®— f(z)
fz := EvaluatePolynomial(f, z)

// Step 4: æ„é€ å•†å¤šé¡¹å¼ g(x) = (f(x) - f(z)) / (x - z)
g := make([]FieldElement, len(f)-1)
// ... å¤šé¡¹å¼é™¤æ³•

// Step 5: å¯¹å•†å¤šé¡¹å¼è¿è¡Œ FRI
gCommit, challenges := params.Commit(g)

// Step 6: ç”ŸæˆæŸ¥è¯¢
queries := gCommit.GenerateQueries(params, challenges)

return &DEEPFRIProof{
FRICommitment: fCommit,
DeepPoint:     z,
DeepValues:    []FieldElement{fz},
QuotientProof: gCommit,
}
}

// DEEP-FRI ä¼˜åŠ¿:
// 1. å•ç‚¹æµ‹è¯•å³å¯ç¡®è®¤å¤šé¡¹å¼åº¦æ•°
// 2. å‡å°‘éœ€è¦çš„æŸ¥è¯¢æ•°é‡
// 3. æ›´å°çš„è¯æ˜å°ºå¯¸
```

### 9.8 FRI åœ¨ STARK ä¸­çš„åº”ç”¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STARK = AIR + FRI                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  å®Œæ•´ STARK è¯æ˜æµç¨‹:                                               â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. ç”Ÿæˆæ‰§è¡Œè½¨è¿¹ (Trace)                                    â”‚   â”‚
â”‚  â”‚     â€¢ tâ‚€, tâ‚, tâ‚‚, ..., tâ‚™â‚‹â‚ (çŠ¶æ€åºåˆ—)                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  2. æ’å€¼ä¸ºå¤šé¡¹å¼ T(x)                                       â”‚   â”‚
â”‚  â”‚     â€¢ T(Ï‰â±) = táµ¢ for i = 0, ..., n-1                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  3. æ„é€ çº¦æŸå¤šé¡¹å¼ C(x)                                     â”‚   â”‚
â”‚  â”‚     â€¢ C(x) = constraint(T(x), T(Ï‰x), ...)                  â”‚   â”‚
â”‚  â”‚     â€¢ C(x) åœ¨ trace åŸŸä¸Šä¸ºé›¶                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  4. æ„é€ å•†å¤šé¡¹å¼                                            â”‚   â”‚
â”‚  â”‚     â€¢ Q(x) = C(x) / Z_trace(x)                             â”‚   â”‚
â”‚  â”‚     â€¢ Z_trace(x) = âˆ(x - Ï‰â±) æ˜¯æ¶ˆå¤±å¤šé¡¹å¼                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  5. ç»„åˆå¹¶è¿è¡Œ FRI                                          â”‚   â”‚
â”‚  â”‚     â€¢ è¯æ˜ Q(x) æ˜¯ä½åº¦å¤šé¡¹å¼                               â”‚   â”‚
â”‚  â”‚     â€¢ ä½¿ç”¨éšæœºçº¿æ€§ç»„åˆå‡å°‘å¤šé¡¹å¼æ•°é‡                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  6. ç”ŸæˆæŸ¥è¯¢è¯æ˜                                            â”‚   â”‚
â”‚  â”‚     â€¢ é€‰æ‹©éšæœºæŸ¥è¯¢ç‚¹                                        â”‚   â”‚
â”‚  â”‚     â€¢ æä¾› Merkle è®¤è¯è·¯å¾„                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```rust
// Rust STARK å®ç°æ¡†æ¶ (ä½¿ç”¨ winterfell é£æ ¼)
use std::marker::PhantomData;

pub trait Air {
    type BaseField: Field;
    type PublicInputs;

    // å®šä¹‰çº¦æŸ
    fn evaluate_transition<E: FieldElement>(
        &self,
        frame: &EvaluationFrame<E>,
        periodic_values: &[E],
        result: &mut [E],
    );

    // è¾¹ç•Œçº¦æŸ
    fn get_boundary_constraints(&self) -> Vec<BoundaryConstraint>;

    // è·å–è½¨è¿¹ä¿¡æ¯
    fn trace_length(&self) -> usize;
    fn trace_width(&self) -> usize;
}

// ç¤ºä¾‹: æ–æ³¢é‚£å¥‘ STARK
pub struct FibonacciAir {
    trace_length: usize,
    result: u64,
}

impl Air for FibonacciAir {
    type BaseField = Fp;
    type PublicInputs = u64;

    fn evaluate_transition<E: FieldElement>(
        &self,
        frame: &EvaluationFrame<E>,
        _periodic: &[E],
        result: &mut [E],
    ) {
        let current = frame.current();
        let next = frame.next();

        // çº¦æŸ: f(n+2) = f(n+1) + f(n)
        // è½¬æ¢ä¸º: next[0] - current[0] - current[1] = 0
        //         next[1] - current[1] - next[0] = 0
        result[0] = next[0] - current[0] - current[1];
        result[1] = next[1] - current[1] - next[0];
    }

    fn get_boundary_constraints(&self) -> Vec<BoundaryConstraint> {
        vec![
            // f(0) = 1
            BoundaryConstraint::new(0, 0, E::ONE),
            // f(1) = 1
            BoundaryConstraint::new(0, 1, E::ONE),
            // f(n-1) = result
            BoundaryConstraint::new(
                self.trace_length - 1,
                1,
                E::from(self.result),
            ),
        ]
    }

    fn trace_length(&self) -> usize {
        self.trace_length
    }

    fn trace_width(&self) -> usize {
        2
    }
}
```

---

## Part 10: zkEVM ç”µè·¯è®¾è®¡

### 10.1 zkEVM æ¶æ„æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      zkEVM æ•´ä½“æ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        EVM æ‰§è¡Œ                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”‚
â”‚  â”‚  â”‚  äº¤æ˜“   â”‚ â†’ â”‚  çŠ¶æ€   â”‚ â†’ â”‚  æ“ä½œç   â”‚ â†’ â”‚ æ–°çŠ¶æ€  â”‚      â”‚ â”‚
â”‚  â”‚  â”‚  è¾“å…¥   â”‚   â”‚  è¯»å–   â”‚   â”‚  æ‰§è¡Œ   â”‚   â”‚  å†™å…¥   â”‚      â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      ç”µè·¯å±‚                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚ EVM ç”µè·¯ â”‚ â”‚ çŠ¶æ€ç”µè·¯ â”‚ â”‚ å­—èŠ‚ç    â”‚ â”‚ å­˜å‚¨ç”µè·¯ â”‚        â”‚ â”‚
â”‚  â”‚  â”‚          â”‚ â”‚          â”‚ â”‚ ç”µè·¯     â”‚ â”‚          â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚       â”‚            â”‚            â”‚            â”‚               â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â”‚                         â†“                                    â”‚ â”‚
â”‚  â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚ â”‚
â”‚  â”‚               â”‚   èšåˆç”µè·¯       â”‚                          â”‚ â”‚
â”‚  â”‚               â”‚   (Aggregator)   â”‚                          â”‚ â”‚
â”‚  â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      è¯æ˜å±‚                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚    PLONK/STARK è¯æ˜  â†’  é€’å½’èšåˆ  â†’  æœ€ç»ˆè¯æ˜ (~400B)        â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 zkEVM ç”µè·¯åˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ ¸å¿ƒç”µè·¯ç»„ä»¶                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. EVM ç”µè·¯ (EVM Circuit)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ éªŒè¯æ¯æ¡ EVM æŒ‡ä»¤çš„æ‰§è¡Œ                                  â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ“ä½œç è¯­ä¹‰                                            â”‚   â”‚
â”‚  â”‚  â€¢ ç®¡ç†ç¨‹åºè®¡æ•°å™¨ (PC)                                       â”‚   â”‚
â”‚  â”‚  â€¢ è¿½è¸ª gas æ¶ˆè€—                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  2. çŠ¶æ€ç”µè·¯ (State Circuit)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ éªŒè¯è´¦æˆ·çŠ¶æ€è½¬æ¢                                          â”‚   â”‚
â”‚  â”‚  â€¢ ä½™é¢ã€nonceã€ä»£ç å“ˆå¸Œå˜åŒ–                                 â”‚   â”‚
â”‚  â”‚  â€¢ å­˜å‚¨æ§½è¯»å†™                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  3. å­—èŠ‚ç ç”µè·¯ (Bytecode Circuit)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ éªŒè¯åˆçº¦å­—èŠ‚ç æ­£ç¡®æ€§                                      â”‚   â”‚
â”‚  â”‚  â€¢ PUSH æŒ‡ä»¤æ•°æ®æå–                                         â”‚   â”‚
â”‚  â”‚  â€¢ ä»£ç å“ˆå¸Œè®¡ç®—                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  4. å¤åˆ¶ç”µè·¯ (Copy Circuit)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ CALLDATACOPY, CODECOPY, RETURNDATACOPY                   â”‚   â”‚
â”‚  â”‚  â€¢ éªŒè¯å†…å­˜å¤åˆ¶æ“ä½œ                                          â”‚   â”‚
â”‚  â”‚  â€¢ å¤„ç†è·¨åŒºåŸŸæ•°æ®ç§»åŠ¨                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  5. Keccak ç”µè·¯                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ SHA3 æ“ä½œç                                                â”‚   â”‚
â”‚  â”‚  â€¢ åœ°å€æ´¾ç”Ÿ                                                  â”‚   â”‚
â”‚  â”‚  â€¢ å­˜å‚¨é”®è®¡ç®—                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 EVM ç”µè·¯å®ç°

```rust
// zkEVM EVM ç”µè·¯ (Halo2 é£æ ¼)
use halo2_proofs::{
    circuit::{Layouter, Value},
    plonk::{Advice, Column, ConstraintSystem, Error, Expression, Selector},
    poly::Rotation,
};

/// EVM æ‰§è¡Œæ­¥éª¤
#[derive(Clone, Debug)]
pub struct ExecutionStep {
    pub pc: u64,
    pub opcode: u8,
    pub stack: Vec<U256>,
    pub memory: Vec<u8>,
    pub gas_left: u64,
    pub rwc: u32,  // è¯»å†™è®¡æ•°å™¨
}

/// EVM ç”µè·¯é…ç½®
#[derive(Clone)]
pub struct EvmCircuitConfig {
    // æ‰§è¡ŒçŠ¶æ€åˆ—
    pub pc: Column<Advice>,
    pub opcode: Column<Advice>,
    pub gas_left: Column<Advice>,
    pub stack_pointer: Column<Advice>,
    pub memory_size: Column<Advice>,
    pub rwc: Column<Advice>,

    // æ ˆæ“ä½œåˆ—
    pub stack_value: [Column<Advice>; 4],

    // é€‰æ‹©å™¨
    pub q_step: Selector,
    pub q_step_first: Selector,
    pub q_step_last: Selector,

    // æ“ä½œç ç‰¹å®šé€‰æ‹©å™¨
    pub opcode_selectors: OpcodeSelectors,
}

#[derive(Clone)]
pub struct OpcodeSelectors {
    pub q_add: Selector,
    pub q_mul: Selector,
    pub q_sub: Selector,
    pub q_div: Selector,
    pub q_push: Selector,
    pub q_pop: Selector,
    pub q_jump: Selector,
    pub q_jumpi: Selector,
    pub q_sload: Selector,
    pub q_sstore: Selector,
    pub q_call: Selector,
    // ... æ›´å¤šæ“ä½œç 
}

impl EvmCircuitConfig {
    pub fn configure(meta: &mut ConstraintSystem<Fr>) -> Self {
        let pc = meta.advice_column();
        let opcode = meta.advice_column();
        let gas_left = meta.advice_column();
        let stack_pointer = meta.advice_column();
        let memory_size = meta.advice_column();
        let rwc = meta.advice_column();

        let stack_value = [
            meta.advice_column(),
            meta.advice_column(),
            meta.advice_column(),
            meta.advice_column(),
        ];

        let q_step = meta.selector();
        let q_step_first = meta.selector();
        let q_step_last = meta.selector();

        // ADD æ“ä½œç çº¦æŸ
        let q_add = meta.selector();
        meta.create_gate("ADD opcode", |meta| {
            let q = meta.query_selector(q_add);

            let a = meta.query_advice(stack_value[0], Rotation::cur());
            let b = meta.query_advice(stack_value[1], Rotation::cur());
            let result = meta.query_advice(stack_value[0], Rotation::next());

            // æ ˆæŒ‡é’ˆå˜åŒ–: pop 2, push 1 â†’ SP' = SP - 1
            let sp_cur = meta.query_advice(stack_pointer, Rotation::cur());
            let sp_next = meta.query_advice(stack_pointer, Rotation::next());

            // Gas æ¶ˆè€—: ADD = 3
            let gas_cur = meta.query_advice(gas_left, Rotation::cur());
            let gas_next = meta.query_advice(gas_left, Rotation::next());

            vec![
                // result = (a + b) mod 2^256
                q.clone() * (result - a - b),  // ç®€åŒ–,å®é™…éœ€è¦å¤„ç†æº¢å‡º
                // SP' = SP - 1
                q.clone() * (sp_next - sp_cur + Expression::Constant(Fr::one())),
                // Gas' = Gas - 3
                q * (gas_next - gas_cur + Expression::Constant(Fr::from(3))),
            ]
        });

        // SLOAD æ“ä½œç çº¦æŸ (éœ€è¦ä¸çŠ¶æ€ç”µè·¯äº¤äº’)
        let q_sload = meta.selector();
        meta.create_gate("SLOAD opcode", |meta| {
            let q = meta.query_selector(q_sload);

            let key = meta.query_advice(stack_value[0], Rotation::cur());
            let value = meta.query_advice(stack_value[0], Rotation::next());
            let rwc_cur = meta.query_advice(rwc, Rotation::cur());
            let rwc_next = meta.query_advice(rwc, Rotation::next());

            vec![
                // RWC å¢åŠ  1 (è¯»æ“ä½œ)
                q.clone() * (rwc_next - rwc_cur - Expression::Constant(Fr::one())),
                // å®é™…å€¼éªŒè¯é€šè¿‡ lookup åˆ°çŠ¶æ€ç”µè·¯
            ]
        });

        // JUMP æ“ä½œç çº¦æŸ
        let q_jump = meta.selector();
        meta.create_gate("JUMP opcode", |meta| {
            let q = meta.query_selector(q_jump);

            let dest = meta.query_advice(stack_value[0], Rotation::cur());
            let pc_next = meta.query_advice(pc, Rotation::next());
            let sp_cur = meta.query_advice(stack_pointer, Rotation::cur());
            let sp_next = meta.query_advice(stack_pointer, Rotation::next());

            vec![
                // PC' = dest
                q.clone() * (pc_next - dest),
                // SP' = SP - 1
                q * (sp_next - sp_cur + Expression::Constant(Fr::one())),
                // æ³¨æ„: éœ€è¦é¢å¤–çº¦æŸ dest æ˜¯æœ‰æ•ˆçš„ JUMPDEST
            ]
        });

        // ... é…ç½®æ›´å¤šæ“ä½œç 

        Self {
            pc,
            opcode,
            gas_left,
            stack_pointer,
            memory_size,
            rwc,
            stack_value,
            q_step,
            q_step_first,
            q_step_last,
            opcode_selectors: OpcodeSelectors {
                q_add,
                q_mul: meta.selector(),
                q_sub: meta.selector(),
                q_div: meta.selector(),
                q_push: meta.selector(),
                q_pop: meta.selector(),
                q_jump,
                q_jumpi: meta.selector(),
                q_sload,
                q_sstore: meta.selector(),
                q_call: meta.selector(),
            },
        }
    }
}
```

### 10.4 çŠ¶æ€ç”µè·¯å®ç°

```rust
// çŠ¶æ€ç”µè·¯: è¿½è¸ªæ‰€æœ‰çŠ¶æ€è¯»å†™æ“ä½œ
use halo2_proofs::plonk::*;

#[derive(Clone, Copy, Debug)]
pub enum RwOp {
    Read = 0,
    Write = 1,
}

#[derive(Clone, Copy, Debug)]
pub enum Target {
    Memory = 0,
    Stack = 1,
    Storage = 2,
    CallContext = 3,
    Account = 4,
    TxAccessList = 5,
}

/// è¯»å†™è¡Œ
#[derive(Clone, Debug)]
pub struct RwRow {
    pub rwc: u32,           // å…¨å±€è¯»å†™è®¡æ•°å™¨
    pub is_write: bool,
    pub target: Target,
    pub id: u64,            // call_id æˆ– tx_id
    pub address: U256,      // åœ°å€æˆ–é”®
    pub field_tag: u8,      // å­—æ®µç±»å‹
    pub storage_key: U256,
    pub value: U256,
    pub value_prev: U256,   // å†™æ“ä½œçš„å‰å€¼
}

/// çŠ¶æ€ç”µè·¯é…ç½®
#[derive(Clone)]
pub struct StateCircuitConfig {
    pub rwc: Column<Advice>,
    pub is_write: Column<Advice>,
    pub target: Column<Advice>,
    pub id: Column<Advice>,
    pub address: Column<Advice>,
    pub field_tag: Column<Advice>,
    pub storage_key: Column<Advice>,
    pub value: Column<Advice>,
    pub value_prev: Column<Advice>,

    pub q_first: Selector,
    pub q_last: Selector,
    pub q_sorted: Selector,
}

impl StateCircuitConfig {
    pub fn configure(meta: &mut ConstraintSystem<Fr>) -> Self {
        // ... åˆ—å®šä¹‰

        // æ ¸å¿ƒçº¦æŸ: ç¡®ä¿ RW æ“ä½œæŒ‰ (target, id, address, field, storage_key, rwc) æ’åº
        // è¿™å…è®¸é«˜æ•ˆéªŒè¯è¯»å–å€¼çš„æ­£ç¡®æ€§

        meta.create_gate("sorted constraint", |meta| {
            let q = meta.query_selector(q_sorted);

            // å½“å‰è¡Œ
            let target_cur = meta.query_advice(target, Rotation::cur());
            let id_cur = meta.query_advice(id, Rotation::cur());
            let address_cur = meta.query_advice(address, Rotation::cur());
            let rwc_cur = meta.query_advice(rwc, Rotation::cur());

            // ä¸‹ä¸€è¡Œ
            let target_next = meta.query_advice(target, Rotation::next());
            let id_next = meta.query_advice(id, Rotation::next());
            let address_next = meta.query_advice(address, Rotation::next());
            let rwc_next = meta.query_advice(rwc, Rotation::next());

            // æ’åºçº¦æŸ: æŒ‰å­—å…¸åºæ’åˆ—
            // (target, id, address, ..., rwc) <= (target', id', address', ..., rwc')
            // ç®€åŒ–å®ç°,å®é™…éœ€è¦å¤šçº§æ¯”è¾ƒ
            vec![
                // å¦‚æœ target ç›¸åŒ,æ£€æŸ¥ id
                // å¦‚æœ target å’Œ id ç›¸åŒ,æ£€æŸ¥ address
                // ...
                // æœ€åæ£€æŸ¥ rwc ä¸¥æ ¼é€’å¢ (åŒä½ç½®)
            ]
        });

        // è¯»å†™ä¸€è‡´æ€§çº¦æŸ
        meta.create_gate("read consistency", |meta| {
            let q = meta.query_selector(q_sorted);

            let is_write = meta.query_advice(is_write, Rotation::cur());
            let value = meta.query_advice(value, Rotation::cur());
            let value_prev = meta.query_advice(value_prev, Rotation::cur());

            // ä¸Šä¸€è¡Œçš„å€¼
            let prev_value = meta.query_advice(value, Rotation::prev());
            let prev_is_write = meta.query_advice(is_write, Rotation::prev());

            // å¦‚æœå½“å‰æ˜¯è¯»æ“ä½œ,å€¼å¿…é¡»ç­‰äºæœ€è¿‘çš„å†™å…¥å€¼
            // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®,å€¼ä¸º 0

            vec![
                // è¯»æ“ä½œ: value = prev_value (å¦‚æœæ˜¯åŒä¸€ä½ç½®)
                // å†™æ“ä½œ: value_prev = prev_value
            ]
        });

        // ... è¿”å›é…ç½®
        unimplemented!()
    }
}
```

### 10.5 Keccak ç”µè·¯

```rust
// Keccak-256 ç”µè·¯å®ç°
// Keccak ä½¿ç”¨ä½è¿ç®— (XOR, AND, NOT, ROT),åœ¨ ZK ä¸­å¼€é”€å¾ˆå¤§

/// Keccak ç”µè·¯é…ç½®
pub struct KeccakCircuitConfig {
    // çŠ¶æ€çŸ©é˜µ (5x5x64 bits)
    pub state: [[Column<Advice>; 5]; 5],

    // è½®å¸¸æ•°
    pub round_constants: Column<Fixed>,

    // é€‰æ‹©å™¨
    pub q_absorb: Selector,
    pub q_round: Selector,
    pub q_squeeze: Selector,

    // ä½åˆ†è§£åˆ— (ç”¨äºéªŒè¯ä½è¿ç®—)
    pub bits: [Column<Advice>; 64],
}

/// Keccak è½®å‡½æ•°çº¦æŸ
impl KeccakCircuitConfig {
    pub fn configure(meta: &mut ConstraintSystem<Fr>) -> Self {
        // Keccak-f[1600] çš„ 5 ä¸ªæ­¥éª¤

        // 1. Î¸ (Theta) - åˆ—å¥‡å¶æ ¡éªŒ
        meta.create_gate("theta", |meta| {
            // C[x] = A[x,0] âŠ• A[x,1] âŠ• A[x,2] âŠ• A[x,3] âŠ• A[x,4]
            // D[x] = C[x-1] âŠ• rot(C[x+1], 1)
            // A'[x,y] = A[x,y] âŠ• D[x]

            // ä½¿ç”¨ lookup éªŒè¯ XOR æ“ä½œ
            vec![]
        });

        // 2. Ï (Rho) - ä½æ—‹è½¬
        meta.create_gate("rho", |meta| {
            // A'[x,y] = rot(A[x,y], r[x,y])
            // r[x,y] æ˜¯é¢„å®šä¹‰çš„æ—‹è½¬åç§»é‡

            // éªŒè¯æ—‹è½¬: å°†å€¼åˆ†è§£ä¸ºä½,é‡æ–°ç»„åˆ
            vec![]
        });

        // 3. Ï€ (Pi) - ä½ç½®ç½®æ¢
        meta.create_gate("pi", |meta| {
            // A'[y, 2x+3y] = A[x,y]
            // è¿™æ˜¯çº¯ç²¹çš„çº¿ç½®æ¢,åªéœ€è¦æ­£ç¡®èµ‹å€¼
            vec![]
        });

        // 4. Ï‡ (Chi) - éçº¿æ€§å±‚
        meta.create_gate("chi", |meta| {
            // A'[x,y] = A[x,y] âŠ• (Â¬A[x+1,y] âˆ§ A[x+2,y])

            // è¿™æ˜¯ Keccak å”¯ä¸€çš„éçº¿æ€§æ“ä½œ
            // éœ€è¦ä½¿ç”¨ lookup æˆ–ä½åˆ†è§£æ¥éªŒè¯
            vec![]
        });

        // 5. Î¹ (Iota) - è½®å¸¸æ•°åŠ æ³•
        meta.create_gate("iota", |meta| {
            // A'[0,0] = A[0,0] âŠ• RC[round]
            // RC æ˜¯é¢„è®¡ç®—çš„è½®å¸¸æ•°
            vec![]
        });

        unimplemented!()
    }
}

// Keccak ä¼˜åŒ–ç­–ç•¥
/*
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Keccak ç”µè·¯ä¼˜åŒ–                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. ç¨€ç–è¡¨ç¤º                                                        â”‚
â”‚     â€¢ å°† 64-bit word åˆ†è§£ä¸º 4-bit chunks                           â”‚
â”‚     â€¢ å‡å°‘ XOR çš„çº¦æŸæ•°é‡                                          â”‚
â”‚                                                                     â”‚
â”‚  2. æŸ¥æ‰¾è¡¨                                                          â”‚
â”‚     â€¢ é¢„è®¡ç®— XOR, AND æ“ä½œçš„æŸ¥æ‰¾è¡¨                                  â”‚
â”‚     â€¢ ä½¿ç”¨ Plookup éªŒè¯ä½è¿ç®—                                       â”‚
â”‚                                                                     â”‚
â”‚  3. æ‰¹å¤„ç†                                                          â”‚
â”‚     â€¢ å¤šä¸ª Keccak è°ƒç”¨å…±äº«è¡¨                                        â”‚
â”‚     â€¢ å‡å°‘æ¯æ¬¡è°ƒç”¨çš„è¾¹é™…æˆæœ¬                                        â”‚
â”‚                                                                     â”‚
â”‚  4. ç‰¹æ®Šç¼–ç                                                         â”‚
â”‚     â€¢ Î¸-Ï-Ï€ å¯ä»¥åˆå¹¶ä¼˜åŒ–                                           â”‚
â”‚     â€¢ ä½¿ç”¨ä»£æ•°æŠ€å·§å‡å°‘çº¦æŸ                                          â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½å¯¹æ¯”:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ æ–¹æ³•                    â”‚ æ¯è½®çº¦æŸæ•°    â”‚ æ€»çº¦æŸ (24è½®) â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ æœ´ç´ å®ç°                â”‚ ~150,000      â”‚ ~3,600,000    â”‚       â”‚
â”‚  â”‚ ä½åˆ†è§£ + Lookup         â”‚ ~25,000       â”‚ ~600,000      â”‚       â”‚
â”‚  â”‚ ç¨€ç–è¡¨ç¤º                â”‚ ~6,000        â”‚ ~144,000      â”‚       â”‚
â”‚  â”‚ é«˜åº¦ä¼˜åŒ– (PSE zkEVM)    â”‚ ~3,000        â”‚ ~72,000       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
*/
```

### 10.6 ç”µè·¯é—´é€šä¿¡: Bus Mapping

```rust
// Bus Mapping: è¿æ¥å„ä¸ªå­ç”µè·¯
// ä½¿ç”¨ Lookup Arguments å®ç°ç”µè·¯é—´æ•°æ®éªŒè¯

/// Bus æ“ä½œç±»å‹
#[derive(Clone, Copy)]
pub enum BusOp {
    // å†…å­˜æ“ä½œ
    MemoryRead { call_id: u64, address: u64, value: U256 },
    MemoryWrite { call_id: u64, address: u64, value: U256 },

    // æ ˆæ“ä½œ
    StackRead { call_id: u64, index: usize, value: U256 },
    StackWrite { call_id: u64, index: usize, value: U256 },

    // å­˜å‚¨æ“ä½œ
    StorageRead { address: Address, key: U256, value: U256 },
    StorageWrite { address: Address, key: U256, value: U256, value_prev: U256 },

    // ä»£ç æ“ä½œ
    BytecodeRead { code_hash: H256, index: u64, value: u8 },

    // è´¦æˆ·æ“ä½œ
    AccountRead { address: Address, field: AccountField, value: U256 },
}

/// Bus Mapping é…ç½®
pub struct BusMappingConfig {
    // EVM ç”µè·¯å‘å‡ºçš„æ“ä½œ
    pub evm_ops: Column<Advice>,

    // çŠ¶æ€ç”µè·¯çš„ RW è¡¨
    pub rw_table: [Column<Advice>; 8],

    // å­—èŠ‚ç è¡¨
    pub bytecode_table: [Column<Advice>; 4],

    // Keccak è¡¨
    pub keccak_table: [Column<Advice>; 3],
}

impl BusMappingConfig {
    pub fn configure_lookups(meta: &mut ConstraintSystem<Fr>) {
        // EVM ç”µè·¯æŸ¥æ‰¾çŠ¶æ€ç”µè·¯
        meta.lookup_any("evm_to_state", |meta| {
            // å½“ EVM æ‰§è¡Œ SLOAD/SSTORE æ—¶
            // å¿…é¡»åœ¨çŠ¶æ€ç”µè·¯çš„ RW è¡¨ä¸­æ‰¾åˆ°å¯¹åº”æ¡ç›®
            vec![]
        });

        // EVM ç”µè·¯æŸ¥æ‰¾å­—èŠ‚ç ç”µè·¯
        meta.lookup_any("evm_to_bytecode", |meta| {
            // æ¯æ¡æ‰§è¡Œçš„æŒ‡ä»¤å¿…é¡»åœ¨å­—èŠ‚ç è¡¨ä¸­
            vec![]
        });

        // çŠ¶æ€ç”µè·¯æŸ¥æ‰¾ Keccak ç”µè·¯
        meta.lookup_any("state_to_keccak", |meta| {
            // å­˜å‚¨é”®è®¡ç®—éœ€è¦ Keccak
            vec![]
        });
    }
}

/*
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç”µè·¯äº’è¿ç¤ºæ„å›¾                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  EVM ç”µè·¯    â”‚                   â”‚  çŠ¶æ€ç”µè·¯    â”‚               â”‚
â”‚  â”‚              â”‚   lookup          â”‚              â”‚               â”‚
â”‚  â”‚  SLOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º RW Table    â”‚               â”‚
â”‚  â”‚  SSTORE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚               â”‚
â”‚  â”‚              â”‚                   â”‚              â”‚               â”‚
â”‚  â”‚  PC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚              â”‚               â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                                 â”‚   â”‚  å­—èŠ‚ç ç”µè·¯  â”‚               â”‚
â”‚                                 â””â”€â”€â–ºâ”‚              â”‚               â”‚
â”‚                                     â”‚  Code Table  â”‚               â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  Copy ç”µè·¯   â”‚                   â”‚  Keccak ç”µè·¯ â”‚               â”‚
â”‚  â”‚              â”‚   lookup          â”‚              â”‚               â”‚
â”‚  â”‚  CODECOPY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Hash Table  â”‚               â”‚
â”‚  â”‚  SHA3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚               â”‚
â”‚  â”‚              â”‚                   â”‚              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
*/
```

### 10.7 zkEVM å®ç°å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸»æµ zkEVM å®ç°å¯¹æ¯”                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Polygon zkEVM (Type 2)                                     â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ: PLONK + KZG                                    â”‚   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: Go (èŠ‚ç‚¹) + Rust (è¯æ˜å™¨)                          â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: ç”Ÿäº§å°±ç»ª,é«˜å…¼å®¹æ€§                                  â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ•°: ~2B (æ•´ä¸ªå—)                                     â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: ~3 åˆ†é’Ÿ (GPU)                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  zkSync Era (Type 4)                                        â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ: å®šåˆ¶ PLONK (Boojum)                            â”‚   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: Rust                                               â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: è‡ªå®šä¹‰ VM,é«˜æ€§èƒ½                                   â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ•°: ä¼˜åŒ–çš„ç”µè·¯è®¾è®¡                                   â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: ~10 ç§’ (GPU)                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Scroll (Type 2-3)                                          â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ: Halo2 + KZG                                    â”‚   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: Rust                                               â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: åŸºäº PSE zkEVM,å­—èŠ‚ç å…¼å®¹                          â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ•°: ~1.5B (æ•´ä¸ªå—)                                   â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: ~5 åˆ†é’Ÿ (GPU)                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  StarkNet (Type 4)                                          â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ: STARK                                          â”‚   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: Rust + Cairo                                       â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: åé‡å­å®‰å…¨,æ— å¯ä¿¡è®¾ç½®                              â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ•°: AIR çº¦æŸ                                         â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: ~30 ç§’ (CPU)                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Linea (Type 2)                                             â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜ç³»ç»Ÿ: å®šåˆ¶ SNARK                                     â”‚   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: Go + Kotlin                                        â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: Consensys å¼€å‘,vortex è¯æ˜å™¨                       â”‚   â”‚
â”‚  â”‚  â€¢ çº¦æŸæ•°: ä¼˜åŒ–çš„è®¾è®¡                                       â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: ~15 ç§’ (GPU)                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½å¯¹æ¯”:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æŒ‡æ ‡            â”‚ Polygon  â”‚ zkSync   â”‚ Scroll   â”‚ StarkNet â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ TPS (ç†è®º)      â”‚ 2000     â”‚ 3000     â”‚ 1500     â”‚ 1000     â”‚  â”‚
â”‚  â”‚ è¯æ˜æˆæœ¬/tx     â”‚ ~$0.01   â”‚ ~$0.005  â”‚ ~$0.01   â”‚ ~$0.02   â”‚  â”‚
â”‚  â”‚ æœ€ç»ˆæ€§          â”‚ ~30 min  â”‚ ~1 hour  â”‚ ~30 min  â”‚ ~3 hour  â”‚  â”‚
â”‚  â”‚ åé‡å­å®‰å…¨      â”‚ å¦       â”‚ å¦       â”‚ å¦       â”‚ æ˜¯       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 11: Nova/Supernova æŠ˜å æ–¹æ¡ˆ

### 11.1 æŠ˜å æ–¹æ¡ˆæ¦‚è¿°

Nova æ˜¯ä¸€ç§å¢é‡å¯éªŒè¯è®¡ç®— (IVC) æ–¹æ¡ˆï¼Œä½¿ç”¨"æŠ˜å "æŠ€æœ¯å®ç°é«˜æ•ˆçš„é€’å½’è¯æ˜ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æŠ˜å æ–¹æ¡ˆ vs ä¼ ç»Ÿé€’å½’                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ä¼ ç»Ÿé€’å½’è¯æ˜:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  Ï€â‚ â”€â”€â–º Verify(Ï€â‚) â”€â”€â–º Ï€â‚' â”€â”€â–º Verify(Ï€â‚') â”€â”€â–º Ï€â‚'' â”€â”€â–º ... â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æ¯ä¸€æ­¥éƒ½éœ€è¦å®Œæ•´çš„ SNARK è¯æ˜                                â”‚ â”‚
â”‚  â”‚  å¼€é”€: O(|C|) Ã— æ­¥æ•°                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  Nova æŠ˜å :                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  (uâ‚, wâ‚) â”€â”€â”                                                 â”‚ â”‚
â”‚  â”‚             â”œâ”€â”€â–º Fold â”€â”€â–º (u', w')  ç´¯ç§¯å®ä¾‹                  â”‚ â”‚
â”‚  â”‚  (uâ‚‚, wâ‚‚) â”€â”€â”˜                                                 â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æŠ˜å ä¸éœ€è¦è¯æ˜,åªéœ€è¦ç®€å•çš„çº¿æ€§ç»„åˆ!                         â”‚ â”‚
â”‚  â”‚  å¼€é”€: O(1) æ¯æ­¥                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½å¯¹æ¯”:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ æ–¹æ¡ˆ                â”‚ æ¯æ­¥è¯æ˜æ—¶é—´   â”‚ éªŒè¯å™¨å¼€é”€     â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ Groth16 é€’å½’        â”‚ ~ç§’çº§          â”‚ O(|C|)         â”‚        â”‚
â”‚  â”‚ Halo2 é€’å½’          â”‚ ~100ms         â”‚ O(|C|)         â”‚        â”‚
â”‚  â”‚ Nova æŠ˜å            â”‚ ~æ¯«ç§’çº§        â”‚ O(1)           â”‚        â”‚
â”‚  â”‚ Nova + Spartan      â”‚ ~10ms          â”‚ O(1)           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 R1CS æ”¾æ¾ä¸æŠ˜å 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Relaxed R1CS æ ¸å¿ƒæ¦‚å¿µ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  æ ‡å‡† R1CS:                                                         â”‚
â”‚  A Â· z âŠ™ B Â· z = C Â· z                                              â”‚
â”‚  å…¶ä¸­ z = (1, x, w)  (å…¬å…±è¾“å…¥ x, witness w)                        â”‚
â”‚                                                                     â”‚
â”‚  Relaxed R1CS:                                                      â”‚
â”‚  A Â· z âŠ™ B Â· z = u Â· (C Â· z) + E                                   â”‚
â”‚                                                                     â”‚
â”‚  å…¶ä¸­:                                                              â”‚
â”‚  â€¢ u: æ ‡é‡ (æ”¾æ¾å› å­)                                              â”‚
â”‚  â€¢ E: è¯¯å·®å‘é‡                                                      â”‚
â”‚                                                                     â”‚
â”‚  å½“ u = 1, E = 0 æ—¶,ç­‰ä»·äºæ ‡å‡† R1CS                                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Committed Relaxed R1CS                           â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  å®ä¾‹ (Instance): U = (Com(W), Com(E), u, x)                  â”‚ â”‚
â”‚  â”‚  witness: W = (w, E)                                          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  Com(W), Com(E) æ˜¯å¤šé¡¹å¼æ‰¿è¯º                                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  æŠ˜å æ“ä½œ:                                                          â”‚
â”‚  ç»™å®šä¸¤ä¸ªå®ä¾‹-witness å¯¹ (Uâ‚, Wâ‚) å’Œ (Uâ‚‚, Wâ‚‚)                      â”‚
â”‚                                                                     â”‚
â”‚  1. è®¡ç®—äº¤å‰é¡¹ T = AÂ·zâ‚ âŠ™ BÂ·zâ‚‚ + AÂ·zâ‚‚ âŠ™ BÂ·zâ‚ - uâ‚Â·CÂ·zâ‚‚ - uâ‚‚Â·CÂ·zâ‚ â”‚
â”‚  2. æ‰¿è¯ºäº¤å‰é¡¹: Com(T)                                             â”‚
â”‚  3. æ”¶åˆ°éšæœºæŒ‘æˆ˜ r                                                 â”‚
â”‚  4. è®¡ç®—æŠ˜å :                                                       â”‚
â”‚     â€¢ W' = Wâ‚ + r Â· Wâ‚‚                                             â”‚
â”‚     â€¢ E' = Eâ‚ + r Â· T + rÂ² Â· Eâ‚‚                                    â”‚
â”‚     â€¢ u' = uâ‚ + r Â· uâ‚‚                                             â”‚
â”‚     â€¢ x' = xâ‚ + r Â· xâ‚‚                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.3 Nova IVC åè®®

```go
// Nova IVC å®ç°
package nova

import (
	"github.com/consensys/gnark-crypto/ecc"
)

// Relaxed R1CS å®ä¾‹
type RelaxedR1CSInstance struct {
	CommW []byte     // Pedersen æ‰¿è¯º witness
	CommE []byte     // æ‰¿è¯ºè¯¯å·®å‘é‡
	U     *big.Int   // æ”¾æ¾å› å­
	X     []*big.Int // å…¬å…±è¾“å…¥
}

// Relaxed R1CS witness
type RelaxedR1CSWitness struct {
	W []FieldElement // witness å‘é‡
	E []FieldElement // è¯¯å·®å‘é‡
}

// Nova è¯æ˜è€…çŠ¶æ€
type NovaProver struct {
	// ç”µè·¯æè¿°
	R1CS *R1CS

	// å½“å‰ç´¯ç§¯å®ä¾‹
	RunningInstance *RelaxedR1CSInstance
	RunningWitness  *RelaxedR1CSWitness

	// æ­¥éª¤è®¡æ•°
	Step int
}

// åˆå§‹åŒ–
func NewNovaProver(r1cs *R1CS) *NovaProver {
	return &NovaProver{
		R1CS: r1cs,
		RunningInstance: &RelaxedR1CSInstance{
			U: big.NewInt(1),
			X: make([]*big.Int, r1cs.NumPublicInputs),
			// CommW, CommE åˆå§‹åŒ–ä¸ºé›¶
		},
		RunningWitness: &RelaxedR1CSWitness{
			W: make([]FieldElement, r1cs.NumWitness),
			E: make([]FieldElement, r1cs.NumConstraints),
		},
		Step: 0,
	}
}

// æ‰§è¡Œä¸€æ­¥è®¡ç®—å¹¶æŠ˜å 
func (p *NovaProver) Prove(input []FieldElement) (*NovaProof, error) {
	// Step 1: æ‰§è¡Œç”µè·¯å¾—åˆ°æ–°çš„ witness
	newWitness, err := p.R1CS.Compute(input, p.Step)
	if err != nil {
		return nil, err
	}

	// Step 2: åˆ›å»ºæ–°å®ä¾‹
	newInstance := &RelaxedR1CSInstance{
		U: big.NewInt(1),
		X: publicInputsFromWitness(newWitness),
	}
	newInstance.CommW = Commit(newWitness.W)
	newInstance.CommE = Commit(make([]FieldElement, p.R1CS.NumConstraints)) // E = 0

	// Step 3: è®¡ç®—äº¤å‰é¡¹ T
	T := p.computeCrossTerm(p.RunningWitness, &RelaxedR1CSWitness{
		W: newWitness.W,
		E: make([]FieldElement, p.R1CS.NumConstraints),
	})
	commT := Commit(T)

	// Step 4: ç”ŸæˆéšæœºæŒ‘æˆ˜ (Fiat-Shamir)
	r := HashToField(
		p.RunningInstance.CommW,
		p.RunningInstance.CommE,
		newInstance.CommW,
		commT,
	)

	// Step 5: æŠ˜å 
	foldedInstance, foldedWitness := p.fold(
		p.RunningInstance, p.RunningWitness,
		newInstance, &RelaxedR1CSWitness{W: newWitness.W, E: make([]FieldElement, p.R1CS.NumConstraints)},
		T, r,
	)

	// Step 6: æ›´æ–°è¿è¡ŒçŠ¶æ€
	p.RunningInstance = foldedInstance
	p.RunningWitness = foldedWitness
	p.Step++

	return &NovaProof{
		CommT:       commT,
		NewInstance: newInstance,
		Step:        p.Step,
	}, nil
}

// è®¡ç®—äº¤å‰é¡¹
func (p *NovaProver) computeCrossTerm(w1, w2 *RelaxedR1CSWitness) []FieldElement {
	z1 := constructZ(p.RunningInstance, w1)
	z2 := constructZ(&RelaxedR1CSInstance{U: big.NewInt(1)}, w2)

	// T = AÂ·zâ‚ âŠ™ BÂ·zâ‚‚ + AÂ·zâ‚‚ âŠ™ BÂ·zâ‚ - uâ‚Â·CÂ·zâ‚‚ - uâ‚‚Â·CÂ·zâ‚
	Az1 := p.R1CS.A.Mul(z1)
	Az2 := p.R1CS.A.Mul(z2)
	Bz1 := p.R1CS.B.Mul(z1)
	Bz2 := p.R1CS.B.Mul(z2)
	Cz1 := p.R1CS.C.Mul(z1)
	Cz2 := p.R1CS.C.Mul(z2)

	T := make([]FieldElement, p.R1CS.NumConstraints)
	for i := range T {
		T[i] = Az1[i].Mul(Bz2[i]).Add(Az2[i].Mul(Bz1[i]))
		T[i] = T[i].Sub(Cz2[i].Mul(p.RunningInstance.U))
		T[i] = T[i].Sub(Cz1[i]) // uâ‚‚ = 1
	}

	return T
}

// æŠ˜å ä¸¤ä¸ªå®ä¾‹
func (p *NovaProver) fold(
	inst1 *RelaxedR1CSInstance, wit1 *RelaxedR1CSWitness,
	inst2 *RelaxedR1CSInstance, wit2 *RelaxedR1CSWitness,
	T []FieldElement, r *big.Int,
) (*RelaxedR1CSInstance, *RelaxedR1CSWitness) {

	// W' = Wâ‚ + r Â· Wâ‚‚
	newW := make([]FieldElement, len(wit1.W))
	for i := range newW {
		newW[i] = wit1.W[i].Add(wit2.W[i].Mul(r))
	}

	// E' = Eâ‚ + r Â· T + rÂ² Â· Eâ‚‚
	r2 := new(big.Int).Mul(r, r)
	newE := make([]FieldElement, len(wit1.E))
	for i := range newE {
		newE[i] = wit1.E[i].Add(T[i].Mul(r)).Add(wit2.E[i].Mul(r2))
	}

	// u' = uâ‚ + r Â· uâ‚‚
	newU := new(big.Int).Add(inst1.U, new(big.Int).Mul(r, inst2.U))

	// æ›´æ–°æ‰¿è¯º (åŒæ€æ€§)
	newCommW := AddCommitments(inst1.CommW, ScalarMulCommitment(inst2.CommW, r))
	newCommE := AddCommitments(
		inst1.CommE,
		AddCommitments(
			ScalarMulCommitment(Commit(T), r),
			ScalarMulCommitment(inst2.CommE, r2),
		),
	)

	return &RelaxedR1CSInstance{
			CommW: newCommW,
			CommE: newCommE,
			U:     newU,
			X:     foldPublicInputs(inst1.X, inst2.X, r),
		}, &RelaxedR1CSWitness{
			W: newW,
			E: newE,
		}
}
```

### 11.4 Nova éªŒè¯å™¨

```go
// Nova éªŒè¯å™¨
type NovaVerifier struct {
R1CS *R1CS
}

// éªŒè¯ Nova IVC è¯æ˜
func (v *NovaVerifier) Verify(
initialInput []*big.Int,
finalOutput []*big.Int,
proofs []*NovaProof,
finalInstance *RelaxedR1CSInstance,
) bool {

// Step 1: é‡æ”¾æŠ˜å è¿‡ç¨‹ (åªä½¿ç”¨æ‰¿è¯º)
runningInstance := &RelaxedR1CSInstance{
U:     big.NewInt(1),
X:     initialInput,
CommW: ZeroCommitment(),
CommE: ZeroCommitment(),
}

for _, proof := range proofs {
// é‡æ–°è®¡ç®—éšæœºæŒ‘æˆ˜
r := HashToField(
runningInstance.CommW,
runningInstance.CommE,
proof.NewInstance.CommW,
proof.CommT,
)

// éªŒè¯æŠ˜å  (åªæ›´æ–°æ‰¿è¯º)
runningInstance = v.foldInstances(runningInstance, proof.NewInstance, proof.CommT, r)
}

// Step 2: éªŒè¯æœ€ç»ˆå®ä¾‹åŒ¹é…
if !CommitmentsEqual(runningInstance.CommW, finalInstance.CommW) {
return false
}
if !CommitmentsEqual(runningInstance.CommE, finalInstance.CommE) {
return false
}
if runningInstance.U.Cmp(finalInstance.U) != 0 {
return false
}

// Step 3: æœ€ç»ˆæ‰§è¡Œä¸€æ¬¡ SNARK è¯æ˜éªŒè¯
// éªŒè¯æœ€ç»ˆç´¯ç§¯å®ä¾‹æ»¡è¶³ Relaxed R1CS
return v.verifySNARK(finalInstance)
}

// æœ€ç»ˆ SNARK éªŒè¯ (ä½¿ç”¨ Spartan)
func (v *NovaVerifier) verifySNARK(instance *RelaxedR1CSInstance) bool {
// ä½¿ç”¨ Spartan æˆ–å…¶ä»– SNARK éªŒè¯ Relaxed R1CS
// åªéœ€è¦ä¸€æ¬¡å®Œæ•´çš„ SNARK è¯æ˜
return true
}
```

### 11.5 SuperNova: å¤šæŒ‡ä»¤æŠ˜å 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SuperNova æ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Nova çš„å±€é™: åªæ”¯æŒå•ä¸€ç”µè·¯çš„è¿­ä»£                                  â”‚
â”‚                                                                     â”‚
â”‚  SuperNova æ‰©å±•: æ”¯æŒå¤šä¸ªä¸åŒç”µè·¯çš„é€‰æ‹©æ€§æ‰§è¡Œ                       â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ç”µè·¯é›†åˆ F = {Fâ‚, Fâ‚‚, ..., Fâ‚–}                               â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æ¯æ­¥é€‰æ‹©ä¸€ä¸ªç”µè·¯æ‰§è¡Œ:                                        â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  Step 1: Fâ‚‚(xâ‚€) â†’ xâ‚                                         â”‚ â”‚
â”‚  â”‚  Step 2: Fâ‚(xâ‚) â†’ xâ‚‚                                         â”‚ â”‚
â”‚  â”‚  Step 3: Fâ‚ƒ(xâ‚‚) â†’ xâ‚ƒ                                         â”‚ â”‚
â”‚  â”‚  ...                                                          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  åº”ç”¨åœºæ™¯:                                                          â”‚
â”‚  â€¢ zkVM: ä¸åŒæ“ä½œç å¯¹åº”ä¸åŒç”µè·¯                                     â”‚
â”‚  â€¢ æ™ºèƒ½åˆçº¦: ä¸åŒå‡½æ•°å¯¹åº”ä¸åŒç”µè·¯                                   â”‚
â”‚  â€¢ çŠ¶æ€æœº: ä¸åŒçŠ¶æ€è½¬æ¢å¯¹åº”ä¸åŒç”µè·¯                                 â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```rust
// SuperNova å®ç° (Rust é£æ ¼)
use std::collections::HashMap;

/// SuperNova è¯æ˜è€…
pub struct SuperNovaProver<F: Field> {
    /// ç”µè·¯é›†åˆ
    circuits: Vec<R1CS<F>>,

    /// æ¯ä¸ªç”µè·¯çš„ç´¯ç§¯å®ä¾‹
    running_instances: Vec<RelaxedR1CSInstance<F>>,

    /// å½“å‰æ­¥éª¤
    step: usize,
}

impl<F: Field> SuperNovaProver<F> {
    /// æ‰§è¡Œä¸€æ­¥å¹¶æŠ˜å 
    pub fn prove_step(
        &mut self,
        circuit_index: usize,  // é€‰æ‹©å“ªä¸ªç”µè·¯
        input: Vec<F>,
    ) -> SuperNovaProof<F> {
        assert!(circuit_index < self.circuits.len());

        // è·å–é€‰ä¸­çš„ç”µè·¯
        let circuit = &self.circuits[circuit_index];

        // æ‰§è¡Œç”µè·¯
        let witness = circuit.compute(&input);

        // åˆ›å»ºæ–°å®ä¾‹
        let new_instance = RelaxedR1CSInstance::new_standard(&witness);

        // ä¸è¯¥ç”µè·¯çš„è¿è¡Œå®ä¾‹æŠ˜å 
        let running = &mut self.running_instances[circuit_index];
        let (cross_term, proof) = self.fold(running, &new_instance, &witness);

        self.step += 1;

        SuperNovaProof {
            circuit_index,
            cross_term_commitment: commit(&cross_term),
            new_instance_commitment: new_instance.commitment(),
        }
    }

    /// NIVC (Non-uniform IVC) éªŒè¯
    pub fn verify(
        &self,
        proofs: &[SuperNovaProof<F>],
        initial_input: Vec<F>,
        final_outputs: &[RelaxedR1CSInstance<F>],
    ) -> bool {
        // é‡æ”¾æ‰€æœ‰æŠ˜å æ­¥éª¤
        let mut running: Vec<RelaxedR1CSInstance<F>> =
            (0..self.circuits.len())
                .map(|_| RelaxedR1CSInstance::trivial())
                .collect();

        for proof in proofs {
            let idx = proof.circuit_index;
            // é‡æ–°è®¡ç®—æŒ‘æˆ˜
            let r = hash_to_field(&[
                &running[idx].commitment(),
                &proof.new_instance_commitment,
                &proof.cross_term_commitment,
            ]);

            // æ›´æ–°è¿è¡Œå®ä¾‹
            running[idx] = running[idx].fold_commitment(
                &proof.new_instance_commitment,
                &proof.cross_term_commitment,
                r,
            );
        }

        // éªŒè¯æœ€ç»ˆçŠ¶æ€
        for (i, final_inst) in final_outputs.iter().enumerate() {
            if running[i].commitment() != final_inst.commitment() {
                return false;
            }
        }

        // å¯¹æ¯ä¸ªéå¹³å‡¡çš„ç´¯ç§¯å®ä¾‹æ‰§è¡Œ SNARK éªŒè¯
        for (i, inst) in final_outputs.iter().enumerate() {
            if !inst.is_trivial() {
                if !self.verify_snark(&self.circuits[i], inst) {
                    return false;
                }
            }
        }

        true
    }
}
```

### 11.6 Nova åœ¨ zkVM ä¸­çš„åº”ç”¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nova-based zkVM æ¶æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      VM æ‰§è¡Œ                                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æŒ‡ä»¤åºåˆ—: [ADD, MUL, LOAD, STORE, JUMP, ...]                â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æ¯æ¡æŒ‡ä»¤æ˜¯ä¸€ä¸ª"æ­¥éª¤",ä½¿ç”¨ Nova æŠ˜å                          â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    å•æ­¥ç”µè·¯                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  çŠ¶æ€ S = (PC, Registers, Memory Root)                       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  F(S, instr) = S'                                            â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ç”µè·¯éªŒè¯:                                                    â”‚ â”‚
â”‚  â”‚  1. æŒ‡ä»¤è§£ç æ­£ç¡®                                             â”‚ â”‚
â”‚  â”‚  2. æ“ä½œæ•°è·å–æ­£ç¡®                                           â”‚ â”‚
â”‚  â”‚  3. è¿ç®—ç»“æœæ­£ç¡®                                             â”‚ â”‚
â”‚  â”‚  4. çŠ¶æ€æ›´æ–°æ­£ç¡®                                             â”‚ â”‚
â”‚  â”‚  5. Memory Root æ›´æ–°æ­£ç¡® (Merkle è¯æ˜)                       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Nova æŠ˜å                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  (Uâ‚€, Wâ‚€) â†’ æ‰§è¡ŒæŒ‡ä»¤ 1 â†’ Fold â†’ (Uâ‚, Wâ‚)                    â”‚ â”‚
â”‚  â”‚           â†’ æ‰§è¡ŒæŒ‡ä»¤ 2 â†’ Fold â†’ (Uâ‚‚, Wâ‚‚)                    â”‚ â”‚
â”‚  â”‚           â†’ ...                                              â”‚ â”‚
â”‚  â”‚           â†’ æ‰§è¡ŒæŒ‡ä»¤ N â†’ Fold â†’ (Uâ‚™, Wâ‚™)                    â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  æ¯æ­¥åªéœ€ ~10ms,æ¯”ä¼ ç»Ÿ SNARK å¿« 100x                        â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    æœ€ç»ˆå‹ç¼©                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  ä½¿ç”¨ Spartan æˆ– Groth16 å‹ç¼©æœ€ç»ˆç´¯ç§¯å®ä¾‹                    â”‚ â”‚
â”‚  â”‚  ç”Ÿæˆå¯åœ¨é“¾ä¸ŠéªŒè¯çš„ç®€æ´è¯æ˜                                  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½æ•°æ® (å•çº¿ç¨‹):                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ æ¯æ­¥æŠ˜å æ—¶é—´: ~5-15ms                                    â”‚   â”‚
â”‚  â”‚  â€¢ 1000 æ­¥æ€»æ—¶é—´: ~10 ç§’                                    â”‚   â”‚
â”‚  â”‚  â€¢ æœ€ç»ˆå‹ç¼©æ—¶é—´: ~1 ç§’                                      â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜å¤§å°: ~10KB (å‹ç¼©å‰) / ~200B (å‹ç¼©å)                â”‚   â”‚
â”‚  â”‚  â€¢ éªŒè¯æ—¶é—´: ~5ms                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.7 HyperNova: é«˜åº¦ä¼˜åŒ–çš„æŠ˜å 

```rust
// HyperNova: ä½¿ç”¨ CCS (Customizable Constraint System)
// æ¯” R1CS æ›´é€šç”¨,æ”¯æŒæ›´é«˜æ•ˆçš„çº¦æŸè¡¨ç¤º

/// CCS ç»“æ„ (æ›¿ä»£ R1CS)
pub struct CCS<F: Field> {
    /// çŸ©é˜µæ•°é‡
    pub t: usize,

    /// çº¦æŸåº¦æ•°
    pub q: usize,

    /// ç¨€ç–çŸ©é˜µ
    pub matrices: Vec<SparseMatrix<F>>,

    /// å¤šçº¿æ€§æ‰©å±•ç³»æ•°
    pub coefficients: Vec<F>,

    /// çº¦æŸç»„åˆ
    pub selector: Vec<Vec<usize>>,
}

// CCS çº¦æŸ:
// âˆ‘â±¼ câ±¼ Â· âˆáµ¢âˆˆSâ±¼ (Máµ¢ Â· z) = 0
//
// å…¶ä¸­:
// - câ±¼: ç³»æ•°
// - Sâ±¼: é€‰æ‹©å™¨ (é€‰æ‹©å“ªäº›çŸ©é˜µç›¸ä¹˜)
// - Máµ¢: ç¨€ç–çŸ©é˜µ

// R1CS æ˜¯ CCS çš„ç‰¹ä¾‹:
// A Â· z âŠ™ B Â· z - C Â· z = 0
// ç­‰ä»·äº: câ‚(Mâ‚€Â·z âŠ™ Mâ‚Â·z) + câ‚‚(Mâ‚‚Â·z) = 0
// å…¶ä¸­ câ‚ = 1, câ‚‚ = -1, Sâ‚ = {0,1}, Sâ‚‚ = {2}

/// Linearized CCS (LCCCS) - æŠ˜å ç›®æ ‡
pub struct LCCCS<F: Field> {
    pub commitment: Commitment,
    pub x: Vec<F>,           // å…¬å…±è¾“å…¥
    pub u: F,                // æ”¾æ¾å› å­
    pub r: Vec<F>,           // éšæœºç‚¹
    pub v: Vec<F>,           // å¤šçº¿æ€§æ±‚å€¼
}

/// HyperNova æŠ˜å 
impl<F: Field> HyperNova<F> {
    pub fn fold(
        cccs: &CCCS<F>,    // æ–°å®ä¾‹
        lcccs: &LCCCS<F>,  // è¿è¡Œå®ä¾‹
    ) -> (LCCCS<F>, F) {
        // ä½¿ç”¨ sumcheck åè®®è¿›è¡ŒæŠ˜å 
        // æ¯” Nova æ›´é«˜æ•ˆ,æ”¯æŒæ›´é«˜åº¦çš„çº¦æŸ

        // Step 1: éšæœºçº¿æ€§ç»„åˆ
        let rho = random_field_element();

        // Step 2: è¿è¡Œ sumcheck
        let (claim, rx, ry) = sumcheck(cccs, lcccs, rho);

        // Step 3: æŠ˜å æ‰¿è¯º
        let new_commitment = lcccs.commitment + cccs.commitment * rho;

        // Step 4: æ›´æ–°å¤šçº¿æ€§æ±‚å€¼
        let new_v = fold_mle_evals(&lcccs.v, &cccs.v, rho);

        (
            LCCCS {
                commitment: new_commitment,
                x: fold_vec(&lcccs.x, &cccs.x, rho),
                u: lcccs.u + cccs.u * rho,
                r: rx,
                v: new_v,
            },
            claim,
        )
    }
}

// HyperNova ä¼˜åŠ¿:
// 1. æ”¯æŒé«˜åº¦çº¦æŸ (d > 2)
// 2. æ›´å¥½çš„å¹¶è¡Œæ€§
// 3. æ›´å°çš„è¯æ˜å¼€é”€
// 4. ä¸ Lookup Arguments æ›´å¥½çš„é›†æˆ
```

### 11.8 æŠ˜å æ–¹æ¡ˆå¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æŠ˜å æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ç‰¹æ€§        â”‚ Nova       â”‚ SuperNova  â”‚ HyperNova  â”‚ Protostarâ”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ çº¦æŸç³»ç»Ÿ    â”‚ R1CS       â”‚ R1CS       â”‚ CCS        â”‚ Plonkish â”‚ â”‚
â”‚  â”‚ å¤šç”µè·¯æ”¯æŒ  â”‚ å•ä¸€       â”‚ å¤šä¸ª       â”‚ å¤šä¸ª       â”‚ å¤šä¸ª     â”‚ â”‚
â”‚  â”‚ çº¦æŸåº¦æ•°    â”‚ 2          â”‚ 2          â”‚ ä»»æ„       â”‚ ä»»æ„     â”‚ â”‚
â”‚  â”‚ Lookup      â”‚ éœ€æ‰©å±•     â”‚ éœ€æ‰©å±•     â”‚ åŸç”Ÿæ”¯æŒ   â”‚ åŸç”Ÿæ”¯æŒ â”‚ â”‚
â”‚  â”‚ æ¯æ­¥å¼€é”€    â”‚ O(n)       â”‚ O(n)       â”‚ O(n)       â”‚ O(n)     â”‚ â”‚
â”‚  â”‚ éªŒè¯å™¨å¼€é”€  â”‚ O(1)       â”‚ O(k)       â”‚ O(1)       â”‚ O(1)     â”‚ â”‚
â”‚  â”‚ å®ç°æˆç†Ÿåº¦  â”‚ é«˜         â”‚ ä¸­         â”‚ ä¸­         â”‚ ä½       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  å¼€æºå®ç°:                                                          â”‚
â”‚  â€¢ Nova/SuperNova: https://github.com/microsoft/Nova               â”‚
â”‚  â€¢ HyperNova: https://github.com/privacy-scaling-explorations      â”‚
â”‚  â€¢ Arecibo (Nova fork): https://github.com/lurk-lab/arecibo        â”‚
â”‚  â€¢ Sonobe (å¤šåç«¯): https://github.com/privacy-scaling-explorations â”‚
â”‚                                                                     â”‚
â”‚  ä½¿ç”¨å»ºè®®:                                                          â”‚
â”‚  â€¢ ç®€å• IVC: Nova                                                   â”‚
â”‚  â€¢ zkVM: SuperNova æˆ– HyperNova                                    â”‚
â”‚  â€¢ Plonk å…¼å®¹: Protostar (å®éªŒæ€§)                                  â”‚
â”‚  â€¢ ç”Ÿäº§ç¯å¢ƒ: Nova + Spartan                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 12: Cairo è¯­è¨€

### 12.1 Cairo æ¦‚è¿°

Cairo æ˜¯ StarkWare å¼€å‘çš„ä¸“ä¸º STARK è¯æ˜ç³»ç»Ÿè®¾è®¡çš„å›¾çµå®Œå¤‡è¯­è¨€ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Cairo è¯­è¨€ç‰¹æ€§                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ä¸“ä¸º ZK è®¾è®¡   â”‚    â”‚   Rust é£æ ¼    â”‚    â”‚   é«˜æ•ˆè¯æ˜      â”‚ â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚ â”‚
â”‚  â”‚ åŸç”Ÿæ”¯æŒ felt  â”‚    â”‚ ç±»å‹å®‰å…¨       â”‚    â”‚ ä¼˜åŒ–çš„ AIR     â”‚ â”‚
â”‚  â”‚ ä¸å¯å˜å†…å­˜     â”‚    â”‚ æ‰€æœ‰æƒç³»ç»Ÿ     â”‚    â”‚ è‡ªåŠ¨ trace     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  Cairo 1.0 vs Cairo 0.x:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  Cairo 0.x          â†’    Cairo 1.0 (Sierra â†’ CASM)         â”‚   â”‚
â”‚  â”‚  â€¢ ä½çº§è¯­è¨€              â€¢ é«˜çº§è¯­è¨€ (ç±»ä¼¼ Rust)            â”‚   â”‚
â”‚  â”‚  â€¢ æ‰‹åŠ¨å†…å­˜ç®¡ç†          â€¢ è‡ªåŠ¨å†…å­˜ç®¡ç†                    â”‚   â”‚
â”‚  â”‚  â€¢ å®¹æ˜“å†™é”™              â€¢ ç±»å‹å®‰å…¨,ç¼–è¯‘æ—¶æ£€æŸ¥            â”‚   â”‚
â”‚  â”‚  â€¢ ç›´æ¥ç”Ÿæˆ CASM        â€¢ Sierra ä¸­é—´å±‚ä¿è¯å®‰å…¨           â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ç¼–è¯‘æµç¨‹:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  Cairo 1.0  â†’  Sierra  â†’  CASM  â†’  AIR  â†’  STARK è¯æ˜       â”‚ â”‚
â”‚  â”‚   (é«˜çº§)      (å®‰å…¨IR)   (Cairo ASM)  (ä»£æ•°ä¸­é—´è¡¨ç¤º)         â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2 Cairo åŸºç¡€è¯­æ³•

```cairo
// Cairo 1.0 åŸºç¡€è¯­æ³•ç¤ºä¾‹

// 1. å˜é‡å’Œç±»å‹
fn basics() {
    // felt252 æ˜¯ Cairo çš„åŸç”ŸåŸŸå…ƒç´ ç±»å‹
    let x: felt252 = 100;
    let y: u256 = 1000_u256;

    // ä¸å¯å˜ç»‘å®š (é»˜è®¤)
    let a = 10;
    // å¯å˜ç»‘å®š
    let mut b = 20;
    b = 30;

    // å…ƒç»„
    let point: (felt252, felt252) = (10, 20);
    let (px, py) = point;

    // æ•°ç»„ (Cairo ä¸­æ•°ç»„æ˜¯ä¸å¯å˜çš„)
    let arr = array![1, 2, 3, 4, 5];

    // Option å’Œ Result
    let opt: Option<u32> = Option::Some(42);
    let res: Result<u32, felt252> = Result::Ok(42);
}

// 2. å‡½æ•°
fn add(a: felt252, b: felt252) -> felt252 {
    a + b  // æœ€åä¸€ä¸ªè¡¨è¾¾å¼æ˜¯è¿”å›å€¼
}

fn fibonacci(n: felt252) -> felt252 {
    if n == 0 {
        return 0;
    }
    if n == 1 {
        return 1;
    }
    fibonacci(n - 1) + fibonacci(n - 2)
}

// 3. ç»“æ„ä½“
#[derive(Drop, Copy)]
struct Point {
    x: felt252,
    y: felt252,
}

impl PointImpl of PointTrait {
    fn new(x: felt252, y: felt252) -> Point {
        Point { x, y }
    }

    fn distance_squared(self: @Point, other: @Point) -> felt252 {
        let dx = *self.x - *other.x;
        let dy = *self.y - *other.y;
        dx * dx + dy * dy
    }
}

// 4. æšä¸¾
#[derive(Drop)]
enum Message {
    Quit,
    Move: (i32, i32),
    Write: ByteArray,
    ChangeColor: (u8, u8, u8),
}

fn process_message(msg: Message) {
    match msg {
        Message::Quit => { /* å¤„ç†é€€å‡º */ },
        Message::Move((x, y)) => { /* ç§»åŠ¨åˆ° (x, y) */ },
        Message::Write(text) => { /* å†™å…¥æ–‡æœ¬ */ },
        Message::ChangeColor((r, g, b)) => { /* æ”¹å˜é¢œè‰² */ },
    }
}

// 5. æ³›å‹
fn swap<T, +Drop<T>, +Copy<T>>(a: T, b: T) -> (T, T) {
    (b, a)
}

// 6. Trait
trait Calculable<T> {
    fn calculate(self: @T) -> felt252;
}

impl PointCalculable of Calculable<Point> {
    fn calculate(self: @Point) -> felt252 {
        *self.x + *self.y
    }
}
```

### 12.3 Cairo æ™ºèƒ½åˆçº¦

```cairo
// StarkNet åˆçº¦ç¤ºä¾‹

#[starknet::interface]
trait ICounter<TContractState> {
    fn get_count(self: @TContractState) -> u256;
    fn increment(ref self: TContractState);
    fn decrement(ref self: TContractState);
    fn increment_by(ref self: TContractState, amount: u256);
}

#[starknet::contract]
mod Counter {
    use starknet::ContractAddress;
    use starknet::get_caller_address;

    // å­˜å‚¨å˜é‡
    #[storage]
    struct Storage {
        count: u256,
        owner: ContractAddress,
    }

    // äº‹ä»¶
    #[event]
    #[derive(Drop, starknet::Event)]
    enum Event {
        CountChanged: CountChanged,
    }

    #[derive(Drop, starknet::Event)]
    struct CountChanged {
        #[key]
        caller: ContractAddress,
        old_value: u256,
        new_value: u256,
    }

    // æ„é€ å‡½æ•°
    #[constructor]
    fn constructor(ref self: ContractState, initial_count: u256) {
        self.count.write(initial_count);
        self.owner.write(get_caller_address());
    }

    // å®ç°æ¥å£
    #[abi(embed_v0)]
    impl CounterImpl of super::ICounter<ContractState> {
        fn get_count(self: @ContractState) -> u256 {
            self.count.read()
        }

        fn increment(ref self: ContractState) {
            let old_value = self.count.read();
            let new_value = old_value + 1;
            self.count.write(new_value);

            self.emit(CountChanged {
                caller: get_caller_address(),
                old_value,
                new_value,
            });
        }

        fn decrement(ref self: ContractState) {
            let old_value = self.count.read();
            assert(old_value > 0, 'Count cannot be negative');
            let new_value = old_value - 1;
            self.count.write(new_value);

            self.emit(CountChanged {
                caller: get_caller_address(),
                old_value,
                new_value,
            });
        }

        fn increment_by(ref self: ContractState, amount: u256) {
            let old_value = self.count.read();
            let new_value = old_value + amount;
            self.count.write(new_value);

            self.emit(CountChanged {
                caller: get_caller_address(),
                old_value,
                new_value,
            });
        }
    }

    // å†…éƒ¨å‡½æ•°
    #[generate_trait]
    impl InternalFunctions of InternalFunctionsTrait {
        fn only_owner(self: @ContractState) {
            let caller = get_caller_address();
            let owner = self.owner.read();
            assert(caller == owner, 'Only owner can call');
        }
    }
}
```

### 12.4 Cairo é«˜çº§ç‰¹æ€§

```cairo
// 1. å“ˆå¸Œè®¡ç®—
use core::hash::{HashStateTrait, HashStateExTrait};
use core::pedersen::PedersenTrait;
use core::poseidon::PoseidonTrait;

fn hash_examples() {
    // Pedersen å“ˆå¸Œ (StarkNet é»˜è®¤)
    let pedersen_hash = PedersenTrait::new(0)
        .update(100)
        .update(200)
        .finalize();

    // Poseidon å“ˆå¸Œ (æ›´é«˜æ•ˆ)
    let poseidon_hash = PoseidonTrait::new()
        .update(100)
        .update(200)
        .finalize();
}

// 2. ç­¾åéªŒè¯
use starknet::secp256k1::{Secp256k1Point, Signature};
use starknet::eth_signature::verify_eth_signature;

fn verify_signature(
    eth_address: EthAddress,
    msg_hash: u256,
    signature: Signature
) -> bool {
    verify_eth_signature(msg_hash, signature, eth_address)
}

// 3. é€’å½’å’Œå¾ªç¯ä¼˜åŒ–
// Cairo ä¸­å¾ªç¯è¢«å±•å¼€ä¸ºé€’å½’,éœ€è¦æ³¨æ„ gas æ¶ˆè€—

fn sum_array(arr: Span<felt252>) -> felt252 {
    let mut sum: felt252 = 0;
    let mut i: usize = 0;
    loop {
        if i >= arr.len() {
            break;
        }
        sum = sum + *arr.at(i);
        i += 1;
    };
    sum
}

// ä½¿ç”¨è¿­ä»£å™¨æ›´ä¼˜é›…
fn sum_array_iter(arr: Span<felt252>) -> felt252 {
    let mut sum: felt252 = 0;
    for elem in arr {
        sum = sum + *elem;
    };
    sum
}

// 4. å­—å…¸ (Felt252Dict)
use core::dict::Felt252Dict;

fn dict_example() {
    let mut dict: Felt252Dict<u64> = Default::default();

    // æ’å…¥
    dict.insert('key1', 100);
    dict.insert('key2', 200);

    // è¯»å–
    let value = dict.get('key1');  // è¿”å› 100

    // æ³¨æ„: Cairo å­—å…¸æ˜¯ä¸å¯å˜çš„
    // æ¯æ¬¡æ“ä½œè¿”å›æ–°çš„å­—å…¸
}

// 5. ç»„ä»¶ç³»ç»Ÿ (Cairo 1.0)
#[starknet::component]
mod ownable_component {
    use starknet::ContractAddress;
    use starknet::get_caller_address;

    #[storage]
    struct Storage {
        owner: ContractAddress,
    }

    #[event]
    #[derive(Drop, starknet::Event)]
    enum Event {
        OwnershipTransferred: OwnershipTransferred,
    }

    #[derive(Drop, starknet::Event)]
    struct OwnershipTransferred {
        previous_owner: ContractAddress,
        new_owner: ContractAddress,
    }

    #[generate_trait]
    impl InternalImpl<
        TContractState, +HasComponent<TContractState>
    > of InternalTrait<TContractState> {
        fn initializer(ref self: ComponentState<TContractState>, owner: ContractAddress) {
            self.owner.write(owner);
        }

        fn assert_only_owner(self: @ComponentState<TContractState>) {
            let caller = get_caller_address();
            let owner = self.owner.read();
            assert(caller == owner, 'Not owner');
        }

        fn transfer_ownership(
            ref self: ComponentState<TContractState>,
            new_owner: ContractAddress
        ) {
            self.assert_only_owner();
            let previous = self.owner.read();
            self.owner.write(new_owner);
            self.emit(OwnershipTransferred {
                previous_owner: previous,
                new_owner,
            });
        }
    }
}
```

### 12.5 Cairo åº•å±‚: AIR ä¸ Trace

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cairo VM ä¸ AIR                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Cairo VM æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è™šæ‹Ÿæœº,æ‰§è¡Œè¿‡ç¨‹ç”Ÿæˆä»£æ•°æ‰§è¡Œè½¨è¿¹ (Trace)      â”‚
â”‚                                                                     â”‚
â”‚  å¯„å­˜å™¨æ¨¡å‹:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  PC  - ç¨‹åºè®¡æ•°å™¨                                             â”‚ â”‚
â”‚  â”‚  AP  - åˆ†é…æŒ‡é’ˆ (Allocation Pointer)                          â”‚ â”‚
â”‚  â”‚  FP  - å¸§æŒ‡é’ˆ (Frame Pointer)                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  å†…å­˜æ¨¡å‹:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  â€¢ å†…å­˜æ˜¯åªå†™çš„ (Write-Once)                                  â”‚ â”‚
â”‚  â”‚  â€¢ ä¸€æ—¦å†™å…¥,å€¼ä¸å¯æ›´æ”¹                                       â”‚ â”‚
â”‚  â”‚  â€¢ è¿™ç®€åŒ–äº† ZK è¯æ˜ä¸­çš„å†…å­˜ä¸€è‡´æ€§æ£€æŸ¥                         â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  åœ°å€ç©ºé—´:                                                    â”‚ â”‚
â”‚  â”‚  [0, program_size) - ç¨‹åºä»£ç                                  â”‚ â”‚
â”‚  â”‚  [program_size, ...) - æ‰§è¡Œå†…å­˜                              â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  æ‰§è¡Œè½¨è¿¹ (Execution Trace):                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  æ­¥éª¤  â”‚  PC   â”‚  AP   â”‚  FP   â”‚  æŒ‡ä»¤  â”‚  æ“ä½œæ•° â”‚  ç»“æœ   â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚   0    â”‚   0   â”‚  100  â”‚  100  â”‚  ADD   â”‚  a, b  â”‚   c     â”‚ â”‚
â”‚  â”‚   1    â”‚   1   â”‚  101  â”‚  100  â”‚  MUL   â”‚  c, d  â”‚   e     â”‚ â”‚
â”‚  â”‚   2    â”‚   2   â”‚  102  â”‚  100  â”‚  JMP   â”‚  10    â”‚   -     â”‚ â”‚
â”‚  â”‚  ...   â”‚  ...  â”‚  ...  â”‚  ...  â”‚  ...   â”‚  ...   â”‚  ...    â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  è½¨è¿¹è¢«è½¬æ¢ä¸ºå¤šé¡¹å¼,ç„¶åä½¿ç”¨ FRI è¯æ˜                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  AIR çº¦æŸ (ä»¥ä¹˜æ³•ä¸ºä¾‹):                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  çº¦æŸ: op0 Ã— op1 = res                                       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  è½¬æ¢ä¸ºå¤šé¡¹å¼çº¦æŸ:                                            â”‚ â”‚
â”‚  â”‚  P(x) = T_op0(x) Ã— T_op1(x) - T_res(x) = 0 (åœ¨ trace åŸŸä¸Š)  â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  å…¶ä¸­ T_* æ˜¯è½¨è¿¹å¤šé¡¹å¼                                       â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.6 Cairo å®æˆ˜: ERC-20 ä»£å¸

```cairo
#[starknet::interface]
trait IERC20<TContractState> {
    fn name(self: @TContractState) -> ByteArray;
    fn symbol(self: @TContractState) -> ByteArray;
    fn decimals(self: @TContractState) -> u8;
    fn total_supply(self: @TContractState) -> u256;
    fn balance_of(self: @TContractState, account: ContractAddress) -> u256;
    fn allowance(self: @TContractState, owner: ContractAddress, spender: ContractAddress) -> u256;
    fn transfer(ref self: TContractState, recipient: ContractAddress, amount: u256) -> bool;
    fn transfer_from(
        ref self: TContractState,
        sender: ContractAddress,
        recipient: ContractAddress,
        amount: u256
    ) -> bool;
    fn approve(ref self: TContractState, spender: ContractAddress, amount: u256) -> bool;
}

#[starknet::contract]
mod ERC20 {
    use starknet::ContractAddress;
    use starknet::get_caller_address;
    use core::num::traits::Zero;

    #[storage]
    struct Storage {
        name: ByteArray,
        symbol: ByteArray,
        decimals: u8,
        total_supply: u256,
        balances: LegacyMap<ContractAddress, u256>,
        allowances: LegacyMap<(ContractAddress, ContractAddress), u256>,
    }

    #[event]
    #[derive(Drop, starknet::Event)]
    enum Event {
        Transfer: Transfer,
        Approval: Approval,
    }

    #[derive(Drop, starknet::Event)]
    struct Transfer {
        #[key]
        from: ContractAddress,
        #[key]
        to: ContractAddress,
        value: u256,
    }

    #[derive(Drop, starknet::Event)]
    struct Approval {
        #[key]
        owner: ContractAddress,
        #[key]
        spender: ContractAddress,
        value: u256,
    }

    #[constructor]
    fn constructor(
        ref self: ContractState,
        name: ByteArray,
        symbol: ByteArray,
        decimals: u8,
        initial_supply: u256,
        recipient: ContractAddress
    ) {
        self.name.write(name);
        self.symbol.write(symbol);
        self.decimals.write(decimals);
        self._mint(recipient, initial_supply);
    }

    #[abi(embed_v0)]
    impl ERC20Impl of super::IERC20<ContractState> {
        fn name(self: @ContractState) -> ByteArray {
            self.name.read()
        }

        fn symbol(self: @ContractState) -> ByteArray {
            self.symbol.read()
        }

        fn decimals(self: @ContractState) -> u8 {
            self.decimals.read()
        }

        fn total_supply(self: @ContractState) -> u256 {
            self.total_supply.read()
        }

        fn balance_of(self: @ContractState, account: ContractAddress) -> u256 {
            self.balances.read(account)
        }

        fn allowance(
            self: @ContractState,
            owner: ContractAddress,
            spender: ContractAddress
        ) -> u256 {
            self.allowances.read((owner, spender))
        }

        fn transfer(ref self: ContractState, recipient: ContractAddress, amount: u256) -> bool {
            let sender = get_caller_address();
            self._transfer(sender, recipient, amount);
            true
        }

        fn transfer_from(
            ref self: ContractState,
            sender: ContractAddress,
            recipient: ContractAddress,
            amount: u256
        ) -> bool {
            let caller = get_caller_address();
            let current_allowance = self.allowances.read((sender, caller));
            assert(current_allowance >= amount, 'Insufficient allowance');

            self.allowances.write((sender, caller), current_allowance - amount);
            self._transfer(sender, recipient, amount);
            true
        }

        fn approve(ref self: ContractState, spender: ContractAddress, amount: u256) -> bool {
            let owner = get_caller_address();
            self.allowances.write((owner, spender), amount);
            self.emit(Approval { owner, spender, value: amount });
            true
        }
    }

    #[generate_trait]
    impl InternalImpl of InternalTrait {
        fn _transfer(
            ref self: ContractState,
            sender: ContractAddress,
            recipient: ContractAddress,
            amount: u256
        ) {
            assert(!sender.is_zero(), 'Transfer from zero address');
            assert(!recipient.is_zero(), 'Transfer to zero address');

            let sender_balance = self.balances.read(sender);
            assert(sender_balance >= amount, 'Insufficient balance');

            self.balances.write(sender, sender_balance - amount);
            self.balances.write(recipient, self.balances.read(recipient) + amount);

            self.emit(Transfer { from: sender, to: recipient, value: amount });
        }

        fn _mint(ref self: ContractState, recipient: ContractAddress, amount: u256) {
            assert(!recipient.is_zero(), 'Mint to zero address');

            self.total_supply.write(self.total_supply.read() + amount);
            self.balances.write(recipient, self.balances.read(recipient) + amount);

            self.emit(Transfer {
                from: Zero::zero(),
                to: recipient,
                value: amount,
            });
        }
    }
}
```

### 12.7 Cairo å¼€å‘å·¥å…·é“¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cairo å¼€å‘å·¥å…·                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ç¼–è¯‘å™¨ä¸å·¥å…·:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ scarb: Cairo åŒ…ç®¡ç†å™¨ (ç±»ä¼¼ Cargo)                       â”‚   â”‚
â”‚  â”‚  â€¢ cairo-lang: å®˜æ–¹ç¼–è¯‘å™¨                                   â”‚   â”‚
â”‚  â”‚  â€¢ starkli: StarkNet CLI å·¥å…·                               â”‚   â”‚
â”‚  â”‚  â€¢ katana: æœ¬åœ°å¼€å‘ç½‘ç»œ                                     â”‚   â”‚
â”‚  â”‚  â€¢ protostar/foundry-starknet: æµ‹è¯•æ¡†æ¶                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  é¡¹ç›®ç»“æ„:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  my_project/                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Scarb.toml          # é¡¹ç›®é…ç½®                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ src/                                                   â”‚   â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ lib.cairo       # åº“å…¥å£                           â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ contracts/      # åˆçº¦ç›®å½•                         â”‚   â”‚
â”‚  â”‚  â”‚       â””â”€â”€ counter.cairo                                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ tests/              # æµ‹è¯•ç›®å½•                         â”‚   â”‚
â”‚  â”‚      â””â”€â”€ test_counter.cairo                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  Scarb.toml é…ç½®:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [package]                                                  â”‚   â”‚
â”‚  â”‚  name = "my_project"                                        â”‚   â”‚
â”‚  â”‚  version = "0.1.0"                                          â”‚   â”‚
â”‚  â”‚  cairo-version = "2.4.0"                                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  [dependencies]                                             â”‚   â”‚
â”‚  â”‚  starknet = "2.4.0"                                         â”‚   â”‚
â”‚  â”‚  openzeppelin = { git = "..." }                             â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  [[target.starknet-contract]]                               â”‚   â”‚
â”‚  â”‚  sierra = true                                              â”‚   â”‚
â”‚  â”‚  casm = true                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  å¸¸ç”¨å‘½ä»¤:                                                          â”‚
â”‚  â€¢ scarb build         # ç¼–è¯‘é¡¹ç›®                                  â”‚
â”‚  â€¢ scarb test          # è¿è¡Œæµ‹è¯•                                  â”‚
â”‚  â€¢ scarb fmt           # æ ¼å¼åŒ–ä»£ç                                 â”‚
â”‚  â€¢ starkli declare     # å£°æ˜åˆçº¦ç±»                                â”‚
â”‚  â€¢ starkli deploy      # éƒ¨ç½²åˆçº¦                                  â”‚
â”‚  â€¢ starkli invoke      # è°ƒç”¨åˆçº¦                                  â”‚
â”‚  â€¢ starkli call        # æŸ¥è¯¢åˆçº¦                                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 13: ç¡¬ä»¶åŠ é€Ÿ

### 13.1 ZK è¯æ˜ç¡¬ä»¶åŠ é€Ÿæ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK è¯æ˜è®¡ç®—ç“¶é¢ˆ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ZK è¯æ˜çš„ä¸»è¦è®¡ç®—å¯†é›†å‹æ“ä½œ:                                       â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. å¤šæ ‡é‡ä¹˜æ³• (MSM)                         ~60-70%        â”‚   â”‚
â”‚  â”‚     âˆ‘áµ¢ sáµ¢ Â· Gáµ¢  (æ ‡é‡ä¸æ¤­åœ†æ›²çº¿ç‚¹çš„ä¹˜æ³•)                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  2. å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ (NTT/FFT)                 ~20-30%        â”‚   â”‚
â”‚  â”‚     å¤šé¡¹å¼åœ¨ç³»æ•°å½¢å¼å’Œæ±‚å€¼å½¢å¼ä¹‹é—´çš„è½¬æ¢                    â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  3. å“ˆå¸Œè®¡ç®—                                  ~5-10%        â”‚   â”‚
â”‚  â”‚     Poseidon, Pedersen, Keccak ç­‰                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  åŠ é€Ÿæ–¹æ¡ˆå¯¹æ¯”:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  æ–¹æ¡ˆ          â”‚ åŠ é€Ÿæ¯”  â”‚ æˆæœ¬      â”‚ çµæ´»æ€§   â”‚ åŠŸè€—     â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  CPU å¤šæ ¸      â”‚ 4-16x   â”‚ $100-1K   â”‚ é«˜       â”‚ 65-300W  â”‚   â”‚
â”‚  â”‚  GPU           â”‚ 10-50x  â”‚ $1K-10K   â”‚ ä¸­       â”‚ 300-450W â”‚   â”‚
â”‚  â”‚  FPGA          â”‚ 20-100x â”‚ $5K-50K   â”‚ ä¸­       â”‚ 50-200W  â”‚   â”‚
â”‚  â”‚  ASIC          â”‚ 100+x   â”‚ $1M+      â”‚ ä½       â”‚ 50-500W  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.2 GPU åŠ é€Ÿ

```cuda
// CUDA MSM å®ç°æ¡†æ¶
#include <cuda_runtime.h>

// æ¤­åœ†æ›²çº¿ç‚¹ç»“æ„ (BN254)
struct ECPoint {
    uint64_t x[4];  // 256-bit
    uint64_t y[4];
    uint64_t z[4];  // æŠ•å½±åæ ‡
};

// æ ‡é‡ç»“æ„
struct Scalar {
    uint64_t limbs[4];  // 256-bit
};

// Pippenger MSM ç®—æ³• (GPU ç‰ˆæœ¬)
__global__ void msm_bucket_accumulation(
    ECPoint* points,
    Scalar* scalars,
    ECPoint* buckets,
    int n,
    int window_size,
    int window_idx
) {
    int tid = blockIdx.x * blockDim.x + threadIdx.x;
    if (tid >= n) return;

    // æå–çª—å£å†…çš„æ ‡é‡ä½
    int bucket_idx = extract_window(scalars[tid], window_idx, window_size);
    if (bucket_idx == 0) return;

    // åŸå­åŠ åˆ°å¯¹åº”æ¡¶
    // ä½¿ç”¨æŠ•å½±åæ ‡é¿å…é™¤æ³•
    atomic_point_add(&buckets[bucket_idx - 1], &points[tid]);
}

__global__ void msm_bucket_reduction(
    ECPoint* buckets,
    ECPoint* result,
    int num_buckets
) {
    // å¹¶è¡Œæ¡¶å½’çº¦
    // sum = B[1] + 2*B[2] + 3*B[3] + ... + (2^w - 1)*B[2^w - 1]
    // ä½¿ç”¨å‰ç¼€å’Œä¼˜åŒ–

    __shared__ ECPoint shared_buckets[256];

    // å¤åˆ¶åˆ°å…±äº«å†…å­˜
    int tid = threadIdx.x;
    if (tid < num_buckets) {
        shared_buckets[tid] = buckets[tid];
    }
    __syncthreads();

    // ä»åå‘å‰ç´¯åŠ 
    ECPoint running_sum = point_identity();
    ECPoint total = point_identity();

    for (int i = num_buckets - 1; i >= 0; i--) {
        running_sum = point_add(running_sum, shared_buckets[i]);
        total = point_add(total, running_sum);
    }

    if (tid == 0) {
        *result = total;
    }
}

// NTT (Number Theoretic Transform) GPU å®ç°
__global__ void ntt_butterfly(
    uint64_t* data,
    uint64_t* twiddles,
    int n,
    int stage
) {
    int tid = blockIdx.x * blockDim.x + threadIdx.x;
    int half_n = n >> 1;
    if (tid >= half_n) return;

    int step = 1 << stage;
    int group = tid / step;
    int pos = tid % step;

    int i = 2 * group * step + pos;
    int j = i + step;

    // Cooley-Tukey è¶å½¢è¿ç®—
    uint64_t twiddle = twiddles[group * step];
    uint64_t a = data[i];
    uint64_t b = mul_mod(data[j], twiddle);

    data[i] = add_mod(a, b);
    data[j] = sub_mod(a, b);
}

// ä¸»æœºç«¯ MSM è°ƒç”¨
void msm_gpu(
    ECPoint* h_points,
    Scalar* h_scalars,
    int n,
    ECPoint* result
) {
    const int WINDOW_SIZE = 16;
    const int NUM_WINDOWS = 256 / WINDOW_SIZE;
    const int NUM_BUCKETS = (1 << WINDOW_SIZE) - 1;

    // åˆ†é…è®¾å¤‡å†…å­˜
    ECPoint *d_points, *d_buckets;
    Scalar *d_scalars;

    cudaMalloc(&d_points, n * sizeof(ECPoint));
    cudaMalloc(&d_scalars, n * sizeof(Scalar));
    cudaMalloc(&d_buckets, NUM_BUCKETS * sizeof(ECPoint));

    // å¤åˆ¶æ•°æ®åˆ° GPU
    cudaMemcpy(d_points, h_points, n * sizeof(ECPoint), cudaMemcpyHostToDevice);
    cudaMemcpy(d_scalars, h_scalars, n * sizeof(Scalar), cudaMemcpyHostToDevice);

    ECPoint window_results[NUM_WINDOWS];

    for (int w = 0; w < NUM_WINDOWS; w++) {
        // åˆå§‹åŒ–æ¡¶
        cudaMemset(d_buckets, 0, NUM_BUCKETS * sizeof(ECPoint));

        // æ¡¶ç´¯ç§¯
        int threads = 256;
        int blocks = (n + threads - 1) / threads;
        msm_bucket_accumulation<<<blocks, threads>>>(
            d_points, d_scalars, d_buckets, n, WINDOW_SIZE, w
        );

        // æ¡¶å½’çº¦
        ECPoint* d_window_result;
        cudaMalloc(&d_window_result, sizeof(ECPoint));
        msm_bucket_reduction<<<1, 256>>>(d_buckets, d_window_result, NUM_BUCKETS);

        cudaMemcpy(&window_results[w], d_window_result, sizeof(ECPoint),
                   cudaMemcpyDeviceToHost);
        cudaFree(d_window_result);
    }

    // ç»„åˆçª—å£ç»“æœ (åœ¨ CPU ä¸Š)
    *result = window_results[NUM_WINDOWS - 1];
    for (int w = NUM_WINDOWS - 2; w >= 0; w--) {
        for (int i = 0; i < WINDOW_SIZE; i++) {
            *result = point_double(*result);
        }
        *result = point_add(*result, window_results[w]);
    }

    cudaFree(d_points);
    cudaFree(d_scalars);
    cudaFree(d_buckets);
}
```

### 13.3 GPU ZK è¯æ˜åº“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸»æµ GPU åŠ é€Ÿåº“                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. ICICLE (Ingonyama)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: CUDA + Rust/Go ç»‘å®š                                â”‚   â”‚
â”‚  â”‚  â€¢ æ”¯æŒ: MSM, NTT, Poseidon, Pedersen                       â”‚   â”‚
â”‚  â”‚  â€¢ æ›²çº¿: BN254, BLS12-377, BLS12-381, Grumpkin              â”‚   â”‚
â”‚  â”‚  â€¢ å¼€æº: https://github.com/ingonyama-zk/icicle             â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  ä½¿ç”¨ç¤ºä¾‹:                                                   â”‚   â”‚
â”‚  â”‚  ```rust                                                    â”‚   â”‚
â”‚  â”‚  use icicle_cuda_runtime::memory::HostOrDeviceSlice;        â”‚   â”‚
â”‚  â”‚  use icicle_bn254::curve::{G1Projective, ScalarField};      â”‚   â”‚
â”‚  â”‚  use icicle_bn254::msm;                                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  let result = msm::msm(                                     â”‚   â”‚
â”‚  â”‚      &scalars,                                              â”‚   â”‚
â”‚  â”‚      &points,                                               â”‚   â”‚
â”‚  â”‚      &msm::MSMConfig::default(),                            â”‚   â”‚
â”‚  â”‚  )?;                                                        â”‚   â”‚
â”‚  â”‚  ```                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  2. ec-gpu (Filecoin)                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: OpenCL + Rust                                      â”‚   â”‚
â”‚  â”‚  â€¢ æ”¯æŒ: MSM, FFT                                           â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: è·¨å¹³å° (NVIDIA/AMD)                                â”‚   â”‚
â”‚  â”‚  â€¢ å¼€æº: https://github.com/filecoin-project/ec-gpu         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  3. Blitzar (Space and Time)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ è¯­è¨€: CUDA + C++                                         â”‚   â”‚
â”‚  â”‚  â€¢ æ”¯æŒ: å†…ç§¯è¯æ˜, MSM                                      â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: é«˜åº¦ä¼˜åŒ–çš„æ‰¹å¤„ç†                                   â”‚   â”‚
â”‚  â”‚  â€¢ å¼€æº: https://github.com/spaceandtimelabs/blitzar        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½å¯¹æ¯” (2^20 MSM, RTX 4090):                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  åº“        â”‚ BN254    â”‚ BLS12-381 â”‚ å†…å­˜ä½¿ç”¨                â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  ICICLE    â”‚ 120ms    â”‚ 180ms     â”‚ 3.2 GB                  â”‚   â”‚
â”‚  â”‚  ec-gpu    â”‚ 180ms    â”‚ 250ms     â”‚ 4.0 GB                  â”‚   â”‚
â”‚  â”‚  Blitzar   â”‚ 150ms    â”‚ 220ms     â”‚ 3.5 GB                  â”‚   â”‚
â”‚  â”‚  CPU (å•æ ¸)â”‚ 8000ms   â”‚ 12000ms   â”‚ 0.5 GB                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.4 FPGA åŠ é€Ÿ

```verilog
// FPGA MSM æ¨¡å— (Verilog ä¼ªä»£ç )
module msm_engine #(
    parameter CURVE_BITS = 256,
    parameter WINDOW_SIZE = 16,
    parameter NUM_CORES = 16
) (
    input  wire                     clk,
    input  wire                     rst_n,

    // è¾“å…¥æ¥å£
    input  wire [CURVE_BITS-1:0]    scalar_in,
    input  wire [2*CURVE_BITS-1:0]  point_in,
    input  wire                     valid_in,
    output wire                     ready_out,

    // è¾“å‡ºæ¥å£
    output reg  [2*CURVE_BITS-1:0]  result_out,
    output reg                      valid_out
);

    // æ¡¶å­˜å‚¨ (BRAM)
    reg [2*CURVE_BITS-1:0] buckets [0:(1<<WINDOW_SIZE)-2];

    // ç‚¹åŠ æ³•æ ¸å¿ƒ
    wire [2*CURVE_BITS-1:0] point_add_result [0:NUM_CORES-1];
    wire [NUM_CORES-1:0] point_add_valid;

    genvar i;
    generate
        for (i = 0; i < NUM_CORES; i = i + 1) begin : point_add_cores
            point_add_module #(
                .CURVE_BITS(CURVE_BITS)
            ) point_adder (
                .clk(clk),
                .rst_n(rst_n),
                .point_a(point_a[i]),
                .point_b(point_b[i]),
                .result(point_add_result[i]),
                .valid(point_add_valid[i])
            );
        end
    endgenerate

    // æ¨¡æ•°ä¹˜æ³•å™¨ (è’™å“¥é©¬åˆ©ä¹˜æ³•)
    montgomery_mult #(
        .BITS(CURVE_BITS)
    ) mont_mult (
        .clk(clk),
        .a(mult_a),
        .b(mult_b),
        .n(curve_modulus),
        .result(mult_result)
    );

    // FSM çŠ¶æ€æœº
    localparam IDLE = 0, ACCUMULATE = 1, REDUCE = 2, OUTPUT = 3;
    reg [1:0] state;

    always @(posedge clk or negedge rst_n) begin
        if (!rst_n) begin
            state <= IDLE;
            valid_out <= 0;
        end else begin
            case (state)
                IDLE: begin
                    if (valid_in) begin
                        state <= ACCUMULATE;
                    end
                end

                ACCUMULATE: begin
                    // æå–çª—å£å€¼,ç´¯åŠ åˆ°å¯¹åº”æ¡¶
                    // ...
                end

                REDUCE: begin
                    // æ¡¶å½’çº¦
                    // ...
                end

                OUTPUT: begin
                    result_out <= final_result;
                    valid_out <= 1;
                    state <= IDLE;
                end
            endcase
        end
    end

endmodule

// è’™å“¥é©¬åˆ©æ¨¡æ•°ä¹˜æ³•
module montgomery_mult #(
    parameter BITS = 256
) (
    input  wire             clk,
    input  wire [BITS-1:0]  a,
    input  wire [BITS-1:0]  b,
    input  wire [BITS-1:0]  n,
    output reg  [BITS-1:0]  result
);
    // å®ç°è’™å“¥é©¬åˆ©ä¹˜æ³•ç®—æ³•
    // T = a * b
    // m = (T mod R) * N' mod R
    // U = (T + m * N) / R
    // if U >= N then U - N else U

    reg [2*BITS-1:0] product;
    reg [BITS-1:0] m;
    reg [BITS:0] u;

    always @(posedge clk) begin
        product <= a * b;
        m <= (product[BITS-1:0] * n_prime) & ((1 << BITS) - 1);
        u <= (product + m * n) >> BITS;
        result <= (u >= n) ? (u - n) : u[BITS-1:0];
    end

endmodule
```

### 13.5 ZK ä¸“ç”¨ç¡¬ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK ä¸“ç”¨ç¡¬ä»¶æ–¹æ¡ˆ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. Cysic                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç±»å‹: ASIC èŠ¯ç‰‡                                          â”‚   â”‚
â”‚  â”‚  â€¢ ç›®æ ‡: é€šç”¨ ZK åŠ é€Ÿ                                       â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: ä¸“ç”¨ MSM/NTT å•å…ƒ                                  â”‚   â”‚
â”‚  â”‚  â€¢ çŠ¶æ€: å¼€å‘ä¸­                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  2. Ingonyama                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç±»å‹: FPGA + GPU æ··åˆæ–¹æ¡ˆ                                â”‚   â”‚
â”‚  â”‚  â€¢ äº§å“: ICICLE (GPU), FPGA IP æ ¸                           â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: çµæ´»çš„è¯æ˜ç³»ç»Ÿæ”¯æŒ                                 â”‚   â”‚
â”‚  â”‚  â€¢ çŠ¶æ€: ç”Ÿäº§å¯ç”¨                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  3. Ulvetanna                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç±»å‹: FPGA åŠ é€Ÿå™¨                                        â”‚   â”‚
â”‚  â”‚  â€¢ ç›®æ ‡: MSM ä¼˜åŒ–                                           â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: é«˜å¸¦å®½å†…å­˜æ¥å£                                     â”‚   â”‚
â”‚  â”‚  â€¢ çŠ¶æ€: ç”Ÿäº§å¯ç”¨                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  4. Supranational                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç±»å‹: GPU/FPGA è½¯ä»¶åº“                                    â”‚   â”‚
â”‚  â”‚  â€¢ äº§å“: blst (BLS ç­¾å), sppark (GPU åŠ é€Ÿ)                 â”‚   â”‚
â”‚  â”‚  â€¢ ç‰¹ç‚¹: é«˜åº¦ä¼˜åŒ–çš„å¯†ç å­¦åŸè¯­                               â”‚   â”‚
â”‚  â”‚  â€¢ å¼€æº: https://github.com/supranational                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ç¡¬ä»¶é€‰å‹æŒ‡å—:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  åœºæ™¯                â”‚ æ¨èæ–¹æ¡ˆ                             â”‚   â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  å¼€å‘/æµ‹è¯•           â”‚ CPU + å• GPU                         â”‚   â”‚
â”‚  â”‚  ä¸­ç­‰ååé‡          â”‚ å¤š GPU (4-8 å¡)                      â”‚   â”‚
â”‚  â”‚  é«˜ååé‡            â”‚ GPU é›†ç¾¤ æˆ– FPGA                     â”‚   â”‚
â”‚  â”‚  è¶…é«˜ååé‡          â”‚ å®šåˆ¶ ASIC                            â”‚   â”‚
â”‚  â”‚  ä½å»¶è¿Ÿ              â”‚ FPGA                                 â”‚   â”‚
â”‚  â”‚  æˆæœ¬æ•æ„Ÿ            â”‚ GPU (æ€§ä»·æ¯”æœ€ä¼˜)                     â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.6 è¯æ˜ç”Ÿæˆé›†ç¾¤æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åˆ†å¸ƒå¼è¯æ˜ç”Ÿæˆæ¶æ„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      ä»»åŠ¡è°ƒåº¦å±‚                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚ â”‚
â”‚  â”‚  â”‚ Sequencer â”‚  â”‚  Prover   â”‚  â”‚ Aggregatorâ”‚                 â”‚ â”‚
â”‚  â”‚  â”‚           â”‚â”€â”€â”‚ Scheduler â”‚â”€â”€â”‚           â”‚                 â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      è®¡ç®—å±‚                                   â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚  â”‚ Worker  â”‚ â”‚ Worker  â”‚ â”‚ Worker  â”‚ â”‚ Worker  â”‚            â”‚ â”‚
â”‚  â”‚  â”‚ (GPUÃ—8) â”‚ â”‚ (GPUÃ—8) â”‚ â”‚ (GPUÃ—8) â”‚ â”‚ (GPUÃ—8) â”‚            â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  Worker å†…éƒ¨æ¶æ„:                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ GPU 0 â”‚ â”‚ GPU 1 â”‚ â”‚ GPU 2 â”‚ â”‚ GPU 3 â”‚              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  MSM  â”‚ â”‚  MSM  â”‚ â”‚  NTT  â”‚ â”‚  NTT  â”‚              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚           â†“           â†“           â†“           â†“        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚           é«˜é€Ÿ NVLink äº’è”                        â”‚â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ GPU 4 â”‚ â”‚ GPU 5 â”‚ â”‚ GPU 6 â”‚ â”‚ GPU 7 â”‚              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Hash  â”‚ â”‚ Hash  â”‚ â”‚ Verifyâ”‚ â”‚ Verifyâ”‚              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      å­˜å‚¨å±‚                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚ çŠ¶æ€æ•°æ®åº“    â”‚  â”‚ è¯æ˜å­˜å‚¨      â”‚  â”‚ ä¸­é—´æ•°æ®ç¼“å­˜  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚ (PostgreSQL)  â”‚  â”‚ (S3/MinIO)    â”‚  â”‚ (Redis)       â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.7 ä¼˜åŒ–ç­–ç•¥æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ZK è¯æ˜ä¼˜åŒ–ç­–ç•¥                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ç®—æ³•å±‚é¢:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ MSM: Pippenger ç®—æ³•, çª—å£å¤§å°ä¼˜åŒ–                        â”‚   â”‚
â”‚  â”‚  â€¢ NTT: 4-step FFT, æ··åˆåŸºç®—æ³•                              â”‚   â”‚
â”‚  â”‚  â€¢ å¤šé¡¹å¼: Lagrange åŸºç›´æ¥æ±‚å€¼                              â”‚   â”‚
â”‚  â”‚  â€¢ æ‰¹å¤„ç†: å¤šè¯æ˜å¹¶è¡Œç”Ÿæˆ                                   â”‚   â”‚
â”‚  â”‚  â€¢ é¢„è®¡ç®—: SRS ç‚¹é¢„å¤„ç†, æŸ¥æ‰¾è¡¨                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ç¡¬ä»¶å±‚é¢:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ GPU: æœ€å¤§åŒ– SM åˆ©ç”¨ç‡, å‡å°‘å†…å­˜ä¼ è¾“                      â”‚   â”‚
â”‚  â”‚  â€¢ FPGA: æµæ°´çº¿è®¾è®¡, ä¸“ç”¨è’™å“¥é©¬åˆ©ä¹˜æ³•å™¨                     â”‚   â”‚
â”‚  â”‚  â€¢ å†…å­˜: ä½¿ç”¨é«˜å¸¦å®½å†…å­˜ (HBM), æ•°æ®å¯¹é½                     â”‚   â”‚
â”‚  â”‚  â€¢ äº’è”: NVLink/InfiniBand å‡å°‘é€šä¿¡å»¶è¿Ÿ                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ç³»ç»Ÿå±‚é¢:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ å¹¶è¡ŒåŒ–: ä»»åŠ¡çº§, æ•°æ®çº§, æŒ‡ä»¤çº§                           â”‚   â”‚
â”‚  â”‚  â€¢ æµæ°´çº¿: é‡å è®¡ç®—å’Œ I/O                                   â”‚   â”‚
â”‚  â”‚  â€¢ ç¼“å­˜: å‡å°‘é‡å¤è®¡ç®—, é¢„å–æ•°æ®                             â”‚   â”‚
â”‚  â”‚  â€¢ è°ƒåº¦: è´Ÿè½½å‡è¡¡, æ•…éšœæ¢å¤                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  æ€§èƒ½æŒ‡æ ‡å‚è€ƒ (2024):                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  ç›®æ ‡: 2^24 çº¦æŸ PLONK è¯æ˜                                 â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â€¢ å• CPU:   ~30 åˆ†é’Ÿ                                       â”‚   â”‚
â”‚  â”‚  â€¢ å• GPU:   ~30 ç§’                                         â”‚   â”‚
â”‚  â”‚  â€¢ 8 GPU:    ~5 ç§’                                          â”‚   â”‚
â”‚  â”‚  â€¢ FPGA:     ~10 ç§’                                         â”‚   â”‚
â”‚  â”‚  â€¢ å®šåˆ¶ASIC: ~1 ç§’ (ç†è®º)                                   â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  zkRollup å®é™…éœ€æ±‚:                                         â”‚   â”‚
â”‚  â”‚  â€¢ æ‰¹æ¬¡å¤§å°: 1000-5000 ç¬”äº¤æ˜“                               â”‚   â”‚
â”‚  â”‚  â€¢ è¯æ˜æ—¶é—´: < 5 åˆ†é’Ÿ (ä¿æŒå‡ºå—èŠ‚å¥)                        â”‚   â”‚
â”‚  â”‚  â€¢ æˆæœ¬: < $0.01/äº¤æ˜“                                       â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ€»ç»“

æœ¬æ–‡æ¡£æ¶µç›–äº†é›¶çŸ¥è¯†è¯æ˜åœ¨åŒºå—é“¾ä¸­çš„å®Œæ•´çŸ¥è¯†ä½“ç³»:

1. **åŸºç¡€ç†è®º**: ZK ä¸‰å¤§æ€§è´¨ã€SNARKs vs STARKsã€æ•°å­¦åŸºç¡€
2. **æ ¸å¿ƒåè®®**: PLONKã€FRIã€Lookup Arguments
3. **å®ç°æ¡†æ¶**: Circomã€gnarkã€Halo2
4. **é«˜çº§æŠ€æœ¯**: é€’å½’è¯æ˜ã€æŠ˜å æ–¹æ¡ˆ (Nova/HyperNova)
5. **åº”ç”¨åœºæ™¯**: zkRollupã€zkEVMã€éšç§äº¤æ˜“
6. **å¼€å‘å®è·µ**: Cairo è¯­è¨€ã€ç”µè·¯è®¾è®¡
7. **æ€§èƒ½ä¼˜åŒ–**: GPU/FPGA ç¡¬ä»¶åŠ é€Ÿ

æŒç»­å­¦ä¹ å»ºè®®:

- ç†è®º: å­¦ä¹ æ¤­åœ†æ›²çº¿å¯†ç å­¦ã€å¤šé¡¹å¼æ‰¿è¯ºï¼ˆè§é™„å½• Aï¼‰
- å®è·µ: ä» Circom å…¥é—¨,é€æ­¥æ·±å…¥ Halo2ï¼ˆè§é™„å½• Bï¼‰
- å‰æ²¿: å…³æ³¨ Novaã€æŠ˜å æ–¹æ¡ˆã€zkVM å‘å±•

---

## é™„å½• A: æ¤­åœ†æ›²çº¿å¯†ç å­¦ä¸å¤šé¡¹å¼æ‰¿è¯º

### A.1 æ¤­åœ†æ›²çº¿åŸºç¡€

#### A.1.1 æ¤­åœ†æ›²çº¿å®šä¹‰

```
æ¤­åœ†æ›²çº¿ (Weierstrass å½¢å¼):

    yÂ² = xÂ³ + ax + b  (mod p)

å…¶ä¸­ 4aÂ³ + 27bÂ² â‰  0 (ç¡®ä¿æ›²çº¿éå¥‡å¼‚)

ç‚¹åŠ æ³•å‡ ä½•æ„ä¹‰:
- è¿‡ä¸¤ç‚¹ P, Q ä½œç›´çº¿
- ä¸æ›²çº¿äº¤äºç¬¬ä¸‰ç‚¹
- å–å…¶å…³äº x è½´å¯¹ç§°ç‚¹å³ä¸º P + Q
```

#### A.1.2 ZK å¸¸ç”¨æ›²çº¿

| æ›²çº¿        | ç‰¹ç‚¹               | ç”¨é€”                  |
|-----------|------------------|---------------------|
| secp256k1 | yÂ²=xÂ³+7          | Bitcoin/Ethereum ç­¾å |
| BN254     | é…å¯¹å‹å¥½             | ä»¥å¤ªåŠé¢„ç¼–è¯‘              |
| BLS12-381 | 128-bit å®‰å…¨       | Zcash/ETH2          |
| Pasta     | Pallas+Vesta å¾ªç¯å¯¹ | Halo2               |
| Grumpkin  | BN254 åµŒå…¥æ›²çº¿       | é€’å½’è¯æ˜                |

#### A.1.3 Go å®ç°æ¤­åœ†æ›²çº¿ç‚¹è¿ç®—

```go
package ecc

import "math/big"

// æœ‰é™åŸŸå…ƒç´ 
type FieldElement struct {
	Value *big.Int
	Prime *big.Int
}

func NewFieldElement(v, p *big.Int) *FieldElement {
	return &FieldElement{Value: new(big.Int).Mod(v, p), Prime: p}
}

func (fe *FieldElement) Add(other *FieldElement) *FieldElement {
	r := new(big.Int).Add(fe.Value, other.Value)
	return NewFieldElement(r, fe.Prime)
}

func (fe *FieldElement) Mul(other *FieldElement) *FieldElement {
	r := new(big.Int).Mul(fe.Value, other.Value)
	return NewFieldElement(r, fe.Prime)
}

// è´¹é©¬å°å®šç†æ±‚é€†: a^(-1) = a^(p-2) mod p
func (fe *FieldElement) Inverse() *FieldElement {
	exp := new(big.Int).Sub(fe.Prime, big.NewInt(2))
	r := new(big.Int).Exp(fe.Value, exp, fe.Prime)
	return &FieldElement{Value: r, Prime: fe.Prime}
}

// æ¤­åœ†æ›²çº¿ç‚¹
type Point struct {
	X, Y     *FieldElement
	Curve    *Curve
	Infinity bool
}

// æ›²çº¿ yÂ² = xÂ³ + ax + b
type Curve struct {
	A, B  *FieldElement
	Prime *big.Int
	Order *big.Int
}

// ç‚¹åŠ æ³•
func (p *Point) Add(q *Point) *Point {
	if p.Infinity {
		return q
	}
	if q.Infinity {
		return p
	}

	// P + (-P) = O
	if p.X.Value.Cmp(q.X.Value) == 0 {
		sum := new(big.Int).Add(p.Y.Value, q.Y.Value)
		if sum.Mod(sum, p.Curve.Prime).Sign() == 0 {
			return &Point{Infinity: true, Curve: p.Curve}
		}
	}

	var slope *FieldElement
	if p.X.Value.Cmp(q.X.Value) == 0 {
		// ç‚¹å€ä¹˜: Î» = (3xÂ² + a) / (2y)
		three := NewFieldElement(big.NewInt(3), p.Curve.Prime)
		two := NewFieldElement(big.NewInt(2), p.Curve.Prime)
		num := three.Mul(p.X.Mul(p.X)).Add(p.Curve.A)
		slope = num.Mul(two.Mul(p.Y).Inverse())
	} else {
		// ç‚¹åŠ æ³•: Î» = (yâ‚‚-yâ‚)/(xâ‚‚-xâ‚)
		dy := NewFieldElement(new(big.Int).Sub(q.Y.Value, p.Y.Value), p.Curve.Prime)
		dx := NewFieldElement(new(big.Int).Sub(q.X.Value, p.X.Value), p.Curve.Prime)
		slope = dy.Mul(dx.Inverse())
	}

	// xâ‚ƒ = Î»Â² - xâ‚ - xâ‚‚
	x3 := slope.Mul(slope)
	x3 = NewFieldElement(new(big.Int).Sub(x3.Value, p.X.Value), p.Curve.Prime)
	x3 = NewFieldElement(new(big.Int).Sub(x3.Value, q.X.Value), p.Curve.Prime)

	// yâ‚ƒ = Î»(xâ‚-xâ‚ƒ) - yâ‚
	y3 := slope.Mul(NewFieldElement(new(big.Int).Sub(p.X.Value, x3.Value), p.Curve.Prime))
	y3 = NewFieldElement(new(big.Int).Sub(y3.Value, p.Y.Value), p.Curve.Prime)

	return &Point{X: x3, Y: y3, Curve: p.Curve}
}

// æ ‡é‡ä¹˜æ³• (Double-and-Add)
func (p *Point) ScalarMul(k *big.Int) *Point {
	result := &Point{Infinity: true, Curve: p.Curve}
	addend := p
	scalar := new(big.Int).Set(k)

	for scalar.Sign() > 0 {
		if scalar.Bit(0) == 1 {
			result = result.Add(addend)
		}
		addend = addend.Add(addend)
		scalar.Rsh(scalar, 1)
	}
	return result
}
```

### A.2 åŒçº¿æ€§é…å¯¹

#### A.2.1 é…å¯¹åŸºç¡€

```
åŒçº¿æ€§é…å¯¹ e: Gâ‚ Ã— Gâ‚‚ â†’ Gâ‚œ

æ€§è´¨:
1. åŒçº¿æ€§: e(aP, bQ) = e(P, Q)^(ab)
2. éé€€åŒ–: e(Gâ‚, Gâ‚‚) â‰  1
3. å¯è®¡ç®—: å­˜åœ¨é«˜æ•ˆç®—æ³•

åº”ç”¨:
- KZG å¤šé¡¹å¼æ‰¿è¯ºéªŒè¯
- BLS ç­¾åèšåˆ
- Groth16 è¯æ˜éªŒè¯
```

#### A.2.2 é…å¯¹ç±»å‹

| ç±»å‹       | è¯´æ˜            | æ›²çº¿ç¤ºä¾‹             |
|----------|---------------|------------------|
| Type I   | Gâ‚ = Gâ‚‚       | è¶…å¥‡å¼‚æ›²çº¿            |
| Type II  | Gâ‚ â‰  Gâ‚‚, å­˜åœ¨åŒæ€ | MNT æ›²çº¿           |
| Type III | Gâ‚ â‰  Gâ‚‚, æ— åŒæ€  | BN254, BLS12-381 |

### A.3 å¤šé¡¹å¼æ‰¿è¯º

#### A.3.1 KZG æ‰¿è¯ºæ–¹æ¡ˆ

```
KZG å¤šé¡¹å¼æ‰¿è¯ºæµç¨‹:

1. Setup (å¯ä¿¡è®¾ç½®):
   - é€‰æ‹©ç§˜å¯† Ï„
   - ç”Ÿæˆ SRS: [G, Ï„G, Ï„Â²G, ..., Ï„â¿G]

2. Commit (æ‰¿è¯º):
   - å¤šé¡¹å¼ f(x) = Î£ cáµ¢xâ±
   - æ‰¿è¯º C = f(Ï„)Â·G = Î£ cáµ¢Â·(Ï„â±G)

3. Open (æ‰“å¼€):
   - åœ¨ç‚¹ z å¤„æ±‚å€¼ y = f(z)
   - è®¡ç®—å•†å¤šé¡¹å¼ q(x) = (f(x)-y)/(x-z)
   - è¯æ˜ Ï€ = q(Ï„)Â·G

4. Verify (éªŒè¯):
   - æ£€æŸ¥ e(C - yG, G) = e(Ï€, Ï„G - zG)
   - å³ e(C - yG, G) = e(Ï€, (Ï„-z)G)
```

#### A.3.2 Go å®ç° KZG

```go
package kzg

import (
	"math/big"
	bn254 "github.com/consensys/gnark-crypto/ecc/bn254"
)

type SRS struct {
	G1Powers []bn254.G1Affine // [G, Ï„G, Ï„Â²G, ...]
	G2Gen    bn254.G2Affine   // Gâ‚‚
	G2Tau    bn254.G2Affine   // Ï„Gâ‚‚
}

type Commitment struct {
	Point bn254.G1Affine
}

type Proof struct {
	Point bn254.G1Affine
}

// æ‰¿è¯ºå¤šé¡¹å¼
func Commit(srs *SRS, coeffs []*big.Int) *Commitment {
	var commitment bn254.G1Affine
	commitment.MultiExp(srs.G1Powers[:len(coeffs)], coeffs, nil)
	return &Commitment{Point: commitment}
}

// ç”Ÿæˆè¯æ˜
func CreateProof(srs *SRS, coeffs []*big.Int, z *big.Int) (*Proof, *big.Int) {
	// è®¡ç®— y = f(z)
	y := evaluatePoly(coeffs, z)

	// è®¡ç®—å•†å¤šé¡¹å¼ q(x) = (f(x) - y) / (x - z)
	quotient := divideByLinear(coeffs, z, y)

	// Ï€ = q(Ï„)Â·G
	var proof bn254.G1Affine
	proof.MultiExp(srs.G1Powers[:len(quotient)], quotient, nil)

	return &Proof{Point: proof}, y
}

// éªŒè¯è¯æ˜
func Verify(srs *SRS, c *Commitment, proof *Proof, z, y *big.Int) bool {
	// e(C - yG, Gâ‚‚) = e(Ï€, Ï„Gâ‚‚ - zGâ‚‚)
	var yG, cMinusY bn254.G1Affine
	yG.ScalarMultiplication(&srs.G1Powers[0], y)
	cMinusY.Sub(&c.Point, &yG)

	var zG2, tauMinusZ bn254.G2Affine
	zG2.ScalarMultiplication(&srs.G2Gen, z)
	tauMinusZ.Sub(&srs.G2Tau, &zG2)

	// é…å¯¹æ£€æŸ¥
	left, _ := bn254.Pair([]bn254.G1Affine{cMinusY}, []bn254.G2Affine{srs.G2Gen})
	right, _ := bn254.Pair([]bn254.G1Affine{proof.Point}, []bn254.G2Affine{tauMinusZ})

	return left.Equal(&right)
}

func evaluatePoly(coeffs []*big.Int, x *big.Int) *big.Int {
	result := big.NewInt(0)
	xPow := big.NewInt(1)
	for _, c := range coeffs {
		term := new(big.Int).Mul(c, xPow)
		result.Add(result, term)
		xPow.Mul(xPow, x)
	}
	return result
}
```

#### A.3.3 æ‰¿è¯ºæ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ           | è¯æ˜å¤§å°     | éªŒè¯æ—¶é—´     | å¯ä¿¡è®¾ç½® | é€‚ç”¨åœºæ™¯       |
|--------------|----------|----------|------|------------|
| KZG          | O(1)     | O(1) é…å¯¹  | éœ€è¦   | PLONK, ä»¥å¤ªåŠ |
| FRI          | O(logÂ²n) | O(logÂ²n) | æ—     | STARKs     |
| IPA          | O(log n) | O(n)     | æ—     | Halo2      |
| Bulletproofs | O(log n) | O(n)     | æ—     | éšç§äº¤æ˜“       |

---

## é™„å½• B: ä» Circom åˆ° Halo2 å­¦ä¹ è·¯å¾„

### B.1 å­¦ä¹ è·¯çº¿å›¾

```
é˜¶æ®µä¸€: Circom å…¥é—¨ (2-4å‘¨)
â”œâ”€â”€ åŸºæœ¬è¯­æ³•ä¸ä¿¡å·
â”œâ”€â”€ æ¨¡æ¿ä¸ç»„ä»¶
â”œâ”€â”€ snarkjs å·¥å…·é“¾
â””â”€â”€ ç®€å•åº”ç”¨ (å“ˆå¸Œ, Merkle)

é˜¶æ®µäºŒ: gnark è¿›é˜¶ (2-4å‘¨)
â”œâ”€â”€ Go è¯­è¨€ç”µè·¯
â”œâ”€â”€ çº¦æŸç³»ç»Ÿç†è§£
â”œâ”€â”€ æµ‹è¯•ä¸è°ƒè¯•
â””â”€â”€ å®é™…åº”ç”¨å¼€å‘

é˜¶æ®µä¸‰: Halo2 æ·±å…¥ (4-8å‘¨)
â”œâ”€â”€ Plonkish ç®—æœ¯åŒ–
â”œâ”€â”€ è‡ªå®šä¹‰é—¨è®¾è®¡
â”œâ”€â”€ Lookup è¡¨ä½¿ç”¨
â””â”€â”€ é€’å½’è¯æ˜

é˜¶æ®µå››: ä¸“ä¸šæ–¹å‘
â”œâ”€â”€ zkEVM ç”µè·¯
â”œâ”€â”€ zkVM å¼€å‘
â””â”€â”€ åè®®ç ”ç©¶
```

### B.2 Circom å¿«é€Ÿå…¥é—¨

#### B.2.1 åŸºæœ¬è¯­æ³•

```circom
// ä¿¡å·å£°æ˜
pragma circom 2.0.0;

template Multiplier() {
    // è¾“å…¥ä¿¡å· (ç§æœ‰)
    signal input a;
    signal input b;

    // è¾“å‡ºä¿¡å· (å…¬å¼€)
    signal output c;

    // çº¦æŸ: c = a * b
    c <== a * b;
}

// ä¸»ç»„ä»¶
component main = Multiplier();
```

#### B.2.2 èŒƒå›´è¯æ˜

```circom
// è¯æ˜ n ä½èŒƒå›´å†…
template RangeProof(n) {
    signal input value;
    signal bits[n];

    var sum = 0;
    for (var i = 0; i < n; i++) {
        bits[i] <-- (value >> i) & 1;
        bits[i] * (1 - bits[i]) === 0;  // 0 æˆ– 1
        sum += bits[i] * (1 << i);
    }

    sum === value;  // é‡æ„æ£€æŸ¥
}
```

#### B.2.3 Merkle è¯æ˜

```circom
include "circomlib/poseidon.circom";

template MerkleProof(levels) {
    signal input leaf;
    signal input root;
    signal input pathElements[levels];
    signal input pathIndices[levels];

    signal hashes[levels + 1];
    hashes[0] <== leaf;

    component hashers[levels];

    for (var i = 0; i < levels; i++) {
        hashers[i] = Poseidon(2);

        // æ ¹æ® pathIndex å†³å®šå·¦å³
        var left = (1 - pathIndices[i]) * hashes[i]
                 + pathIndices[i] * pathElements[i];
        var right = pathIndices[i] * hashes[i]
                  + (1 - pathIndices[i]) * pathElements[i];

        hashers[i].inputs[0] <== left;
        hashers[i].inputs[1] <== right;
        hashes[i + 1] <== hashers[i].out;
    }

    root === hashes[levels];
}
```

### B.3 gnark è¿›é˜¶æ•™ç¨‹

#### B.3.1 åŸºæœ¬ç”µè·¯

```go
package main

import (
	"github.com/consensys/gnark/frontend"
	"github.com/consensys/gnark/backend/groth16"
	"github.com/consensys/gnark-crypto/ecc"
)

// ç”µè·¯å®šä¹‰
type MulCircuit struct {
	A frontend.Variable `gnark:"a"`
	B frontend.Variable `gnark:"b"`
	C frontend.Variable `gnark:",public"`
}

func (c *MulCircuit) Define(api frontend.API) error {
	result := api.Mul(c.A, c.B)
	api.AssertIsEqual(result, c.C)
	return nil
}

func main() {
	var circuit MulCircuit

	// ç¼–è¯‘
	cs, _ := frontend.Compile(ecc.BN254.ScalarField(), r1cs.NewBuilder, &circuit)

	// Setup
	pk, vk, _ := groth16.Setup(cs)

	// è¯æ˜
	assignment := &MulCircuit{A: 3, B: 5, C: 15}
	witness, _ := frontend.NewWitness(assignment, ecc.BN254.ScalarField())
	proof, _ := groth16.Prove(cs, pk, witness)

	// éªŒè¯
	publicWitness, _ := witness.Public()
	groth16.Verify(proof, vk, publicWitness)
}
```

#### B.3.2 æ¡ä»¶é€‰æ‹©

```go
func (c *Circuit) Define(api frontend.API) error {
// æ¡ä»¶é€‰æ‹©: if cond then a else b
result := api.Select(c.Cond, c.A, c.B)
api.AssertIsEqual(result, c.Expected)
return nil
}
```

#### B.3.3 ä½åˆ†è§£

```go
func (c *Circuit) Define(api frontend.API) error {
// åˆ†è§£ä¸º 8 ä½
bits := api.ToBinary(c.Value, 8)

// éªŒè¯æ¯ä¸€ä½
for _, bit := range bits {
api.AssertIsBoolean(bit)
}

// é‡æ„
reconstructed := api.FromBinary(bits...)
api.AssertIsEqual(reconstructed, c.Value)
return nil
}
```

### B.4 Halo2 é«˜çº§æ•™ç¨‹

#### B.4.1 Plonkish æ ¸å¿ƒæ¦‚å¿µ

```
Halo2 ç”µè·¯ç»“æ„:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Region (åŒºåŸŸ)                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚ a    â”‚ b    â”‚ c    â”‚ selectorâ”‚ fixed   â”‚              â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚ â”‚ x    â”‚ y    â”‚ z    â”‚   1    â”‚   0     â”‚  <- Row 0    â”‚
â”‚ â”‚ a    â”‚ b    â”‚ c    â”‚   0    â”‚   1     â”‚  <- Row 1    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                         â”‚
â”‚ é—¨çº¦æŸ: s_mul Â· (a Â· b - c) = 0                        â”‚
â”‚ å¤åˆ¶çº¦æŸ: è¿æ¥ä¸åŒå•å…ƒæ ¼                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### B.4.2 Rust ç®€å•ç”µè·¯

```rust
use halo2_proofs::{
    circuit::{Layouter, SimpleFloorPlanner, Value},
    plonk::{Circuit, ConstraintSystem, Error, Column, Advice, Selector},
    poly::Rotation,
};

#[derive(Clone)]
struct MulConfig {
    a: Column<Advice>,
    b: Column<Advice>,
    c: Column<Advice>,
    s_mul: Selector,
}

struct MulCircuit {
    a: Value<F>,
    b: Value<F>,
}

impl<F: Field> Circuit<F> for MulCircuit {
    type Config = MulConfig;
    type FloorPlanner = SimpleFloorPlanner;

    fn configure(meta: &mut ConstraintSystem<F>) -> Self::Config {
        let a = meta.advice_column();
        let b = meta.advice_column();
        let c = meta.advice_column();
        let s_mul = meta.selector();

        meta.create_gate("mul", |meta| {
            let a = meta.query_advice(a, Rotation::cur());
            let b = meta.query_advice(b, Rotation::cur());
            let c = meta.query_advice(c, Rotation::cur());
            let s = meta.query_selector(s_mul);

            vec![s * (a * b - c)]
        });

        MulConfig { a, b, c, s_mul }
    }

    fn synthesize(&self, config: Self::Config, mut layouter: impl Layouter<F>) -> Result<(), Error> {
        layouter.assign_region(
            || "mul",
            |mut region| {
                config.s_mul.enable(&mut region, 0)?;

                let a = region.assign_advice(|| "a", config.a, 0, || self.a)?;
                let b = region.assign_advice(|| "b", config.b, 0, || self.b)?;
                let c_val = self.a.and_then(|a| self.b.map(|b| a * b));
                region.assign_advice(|| "c", config.c, 0, || c_val)?;

                Ok(())
            },
        )
    }
}
```

### B.5 å­¦ä¹ èµ„æº

```
å®˜æ–¹æ–‡æ¡£:
- Circom: https://docs.circom.io
- gnark: https://docs.gnark.consensys.io
- Halo2: https://zcash.github.io/halo2

æ•™ç¨‹:
- 0xPARC: ZK Learning Group
- RareSkills: ZK Book
- ZK Podcast

å¼€æºé¡¹ç›®:
- circomlib: æ ‡å‡†ç”µè·¯åº“
- gnark-crypto: å¯†ç å­¦åŸè¯­
- halo2-examples: ç¤ºä¾‹åˆé›†
```
